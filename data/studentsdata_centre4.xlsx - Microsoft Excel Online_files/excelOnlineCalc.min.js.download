var excelOnlineCalc=function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=12)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(2);r.utils=n;var a=t(3);r.ULS=a.ULS,r.TraceLevel=a.TraceLevel,r.LogCategory=a.LogCategory,r.NulLogger=a.NulLogger,r.ConsoleLogger=a.ConsoleLogger;var o=t(4);r.browserSupport=o;var i=t(5);r.perfWatch=i;var u=t(6);r.initEwaUtils=u.initEwaUtils,r.ewaUtils=u.ewaUtils;var c=t(7);r.initStopwatchFactory=c.initStopwatchFactory;var s=t(8);r.getNewGuid=s.getNewGuid},function(e,r,t){"use strict";t.r(r),t.d(r,"__extends",(function(){return a})),t.d(r,"__assign",(function(){return o})),t.d(r,"__rest",(function(){return i})),t.d(r,"__decorate",(function(){return u})),t.d(r,"__param",(function(){return c})),t.d(r,"__metadata",(function(){return s})),t.d(r,"__awaiter",(function(){return l})),t.d(r,"__generator",(function(){return f})),t.d(r,"__exportStar",(function(){return d})),t.d(r,"__values",(function(){return h})),t.d(r,"__read",(function(){return p})),t.d(r,"__spread",(function(){return v})),t.d(r,"__spreadArrays",(function(){return g})),t.d(r,"__await",(function(){return m})),t.d(r,"__asyncGenerator",(function(){return E})),t.d(r,"__asyncDelegator",(function(){return S})),t.d(r,"__asyncValues",(function(){return T})),t.d(r,"__makeTemplateObject",(function(){return C})),t.d(r,"__importStar",(function(){return R})),t.d(r,"__importDefault",(function(){return I}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function a(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var o=function(){return(o=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var a in r=arguments[t])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};function i(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]])}return t}function u(e,r,t,n){var a,o=arguments.length,i=o<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(i=(o<3?a(i):o>3?a(r,t,i):a(r,t))||i);return o>3&&i&&Object.defineProperty(r,t,i),i}function c(e,r){return function(t,n){r(t,n,e)}}function s(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)}function l(e,r,t,n){return new(t||(t=Promise))((function(a,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new t((function(r){r(e.value)})).then(i,u)}c((n=n.apply(e,r||[])).next())}))}function f(e,r){var t,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],n=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function d(e,r){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}function h(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}function p(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,o=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(a)throw a.error}}return i}function v(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(p(arguments[r]));return e}function g(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),a=0;for(r=0;r<t;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function E(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=t.apply(e,r||[]),o=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){a[e]&&(n[e]=function(r){return new Promise((function(t,n){o.push([e,r,t,n])>1||u(e,r)}))})}function u(e,r){try{(t=a[e](r)).value instanceof m?Promise.resolve(t.value.v).then(c,s):l(o[0][2],t)}catch(e){l(o[0][3],e)}var t}function c(e){u("next",e)}function s(e){u("throw",e)}function l(e,r){e(r),o.shift(),o.length&&u(o[0][0],o[0][1])}}function S(e){var r,t;return r={},n("next"),n("throw",(function(e){throw e})),n("return"),r[Symbol.iterator]=function(){return this},r;function n(n,a){r[n]=e[n]?function(r){return(t=!t)?{value:m(e[n](r)),done:"return"===n}:a?a(r):r}:a}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,t=e[Symbol.asyncIterator];return t?t.call(e):(e=h(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(t){r[t]=e[t]&&function(r){return new Promise((function(n,a){(function(e,r,t,n){Promise.resolve(n).then((function(r){e({value:r,done:t})}),r)})(n,a,(r=e[t](r)).done,r.value)}))}}}function C(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}function R(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function I(e){return e&&e.__esModule?e:{default:e}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,t){return e.reduce((function(e,n){return e.then((function(){return t&&t.stop?Promise.resolve(void 0):r(n,t)}))}),Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,t){void 0===t&&(t=0);if(t<0||t>n)return r;if(null==r||"object"!=typeof r)return r;var a={};Object.getOwnPropertyNames(r).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=r[e])}));var o=Object.getPrototypeOf(r);o&&"object"==typeof o&&Object.keys(o).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=r[e])}));var i={};Object.keys(a).forEach((function(r){i[r]=e(a[r],t+1)}));return i}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var n=5;var a="_",o=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(o,a).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===a&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===a&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var t=Promise.reject(void 0),n=function(r){t=t.catch((function(t){return e(r,t)}))},a=1;a<=r;a+=1)n(a);return t},r.chainFallbackPromises=function(e,r){if(!e||0===e.length)return Promise.resolve();for(var t=r(e[0]),n=function(n){var a=e[n];t=t.catch((function(){return r(a)}))},a=1;a<e.length;a+=1)n(a);return t},r.getQueryParameterByName=function(e,r){var t=new RegExp("[?&]"+r+"(=([^&#]*)|&|#|$)").exec(e);if(t)return t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):""},r.calcHashCode=function(e){if(!e)return 0;for(var r=5381,t=r,n=e.length,a=0;a<n&&(r=4294967295&((r<<5)+r^e.charCodeAt(a)),a!==n-1);a+=2)t=4294967295&((t<<5)+t^e.charCodeAt(a+1));var o=r+35685*t+(23896*t<<16)&4294967295;return o<0&&(o+=4294967296),o},r.getCharIndexInTextFromPoint=function(e,r){var t=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,r))&&(t=a.offset,n=null!=a.offsetNode&&null!=a.offsetNode.parentElement&&"SPAN"===a.offsetNode.parentElement.nodeName?a.offsetNode.parentElement:a.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,r))&&(t=a.startOffset,n=null!=a.startContainer&&null!=a.startContainer.parentElement&&"SPAN"===a.startContainer.parentElement.nodeName?a.startContainer.parentElement:a.startContainer)}else try{var a;n=document.elementFromPoint(e,r),(a=document.body.createTextRange()).moveToPoint(e,r);var o=document.body.createTextRange();o.moveToElementText(n),o.setEndPoint("EndToStart",a),t=o.text.length}catch(e){return t}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(t+=n.textContent.length);return t},r.getBoundingRectForText=function(e,r,t){function n(e,r,t){if(!e||!e.textContent)return r;if(r<0||r>e.textContent.length)return r-e.textContent.length;if(!e.hasChildNodes())return t(e,r),r-e.textContent.length;for(var a=e.childNodes,o=0;o<a.length&&r>=0;o+=1)r=n(a[o],r,t);return r}var a=document.createRange();return n(e,r,(function(e,r){return a.setStart(e,r)})),n(e,t,(function(e,r){return a.setEnd(e,r)})),a.getBoundingClientRect()}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,t,n){return r.traceTag(0,e,t,n)},traceTag:function(e,t,n,a){return r.traceTag(e,t,n,a)},debugTrace:function(e,t,n){return r.debugTraceTag(0,e,t,n)},debugTraceTag:function(e,t,n,a){return r.debugTraceTag(e,t,n,a)},assert:function(e,t,n){return r.assertTag(0,e,t,n)},assertTag:function(e,t,n,a){return r.assertTag(e,t,n,a)},shipAssert:function(e,t,n){return r.shipAssertTag(0,e,t,n)},shipAssertTag:function(e,t,n,a){return r.shipAssertTag(e,t,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,t,n){console.assert(t,"shipAssertTag:",e,r,n)},e.prototype.assertTag=function(e,r,t,n){console.assert(t,"assertTag",e,r,n)},e.prototype.traceTag=function(e,r,t,n){console.log("traceTag",e,n,r,t)},e.prototype.debugTraceTag=function(e,r,t,n){console.log("debugTraceTag",e,n,r,t)},e}();r.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={},a="promises";r.promises=function(){return void 0===n[a]&&(n[a]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n[a]}},function(e,r,t){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,r,t){e[r]=n()-t}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=n(),t=e,o=r,i={},u=function(e,r,n){return function(e,r,t,n,o,i){a(e,"end",t);var u={sessionName:r,result:n?"success":"failure",message:i,marks:e},c=JSON.stringify(u);o(c)}(i,t,o,e,r,n)};return i.start=0,{mark:function(e){return function(e){return a(i,e,o)}(e)},end:function(e){return u(!0,e)},success:function(e,r){return u(!0,e,r)},failure:function(e,r){return u(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,t){void 0!==e&&e.success(r,t)},r.failure=function(e,r,t){void 0!==e&&e.failure(r,t)},r.timeStamp=n},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return n},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(t){var a=n(),o=t;return{reset:function(e){null!=e&&(o=e),a=n()},stop:function(){var t=n()-a,i=JSON.stringify({Target:o,Duration:t.toFixed(r)});e(i)}}}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getNewGuid=function(){var e=new Uint8Array(31),r=function(e){var r={crypto:!1,perfNow:!1,exceptions:[]},t=window.crypto||window.msCrypto;if(t){r.crypto=!0;try{return t.getRandomValues(e),r}catch(e){r.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=window.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){r.exceptions.push("perfNow: "+JSON.stringify(e))}for(var o=0;o<e.length;o+=1){try{if(n){r.perfNow=!0;var i=Math.floor(100*a.now())%10;(i<0||i>9)&&(i=0);for(var u=0;u<i;u+=1)Math.random()}}catch(e){r.exceptions.push("Math.random: "+JSON.stringify(e))}e[o]=Math.floor(16*Math.random())}return r}(e),t=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var n=15&e[t];return t+=1,("x"===r?n:3&n|8).toString(16)})),r]}},function(e,r,t){"use strict";t.r(r),function(e,n){t.d(r,"testEmitter",(function(){return a})),t.d(r,"allWorkersDestroyed",(function(){return u}));var a=void 0,o=0,i=void 0;function u(){return 0===o?Promise.resolve():new Promise((function(e){return i.addListener("noworkers",e)}))}function c(e){return"undefined"!=typeof MessageEvent?new MessageEvent("message",{data:e}):{type:"message",data:e}}e:if("undefined"==typeof Worker){var s=void 0!==e&&null!=Object({NODE_ENV:"production"})&&null!=Object({NODE_ENV:"production"}).JEST_WORKER_ID,l=void 0!==n&&n.global===n;if(s||l){var f,d;try{f=require}catch(e){console.log("require is not defined (is this in a script executed by vm.runInThisContext?)");break e}try{d=f("worker_threads")}catch(e){console.log("error importing worker_threads (was node run without --experimental-worker?): "+e.stack);break e}var h=f("events");if(a=new h.EventEmitter,i=new h.EventEmitter,n.Worker=function(){function e(e){var r=this;this._onmessage=null,this._onerror=null,this.onmessageerror=null,this._messageHandler=function(e){null!=r._onmessage&&r._onmessage.call(r,c(e))},this._errorHandler=function(e){null!=r._onerror&&r._onerror.call(r,function(e,r){return"undefined"!=typeof ErrorEvent?new ErrorEvent("error",{message:e,error:r}):{type:"error",message:e,error:r,preventDefault:function(){}}}(e.message,e))},this._worker=new d.Worker(e),this._worker.on("exit",(function(e){a.emit("workerdestroyed",r),0==(o-=1)&&i.emit("noworkers")})),o+=1,a.emit("workercreated",this)}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?this._worker.removeListener("message",this._messageHandler):null==this._onmessage&&this._worker.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this._onerror},set:function(e){null==e?this._worker.removeListener("error",this._errorHandler):null==this._onerror&&this._worker.on("error",this._errorHandler),this._onerror=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._worker.postMessage(e)},e.prototype.terminate=function(){this._worker.terminate()},e.prototype.addEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.addEventListener")},e.prototype.removeEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.removeEventListener")},e.prototype.dispatchEvent=function(e){throw new Error("unimplemented: WorkerPolyfill.dispatchEvent")},e}(),!d.isMainThread&&"undefined"==typeof DedicatedWorkerGlobalScope){var p=function(){function r(){var e=this;this._onmessage=null,this.onmessageerror=null,this.onunhandledrejection=null,this._messageHandler=function(r){null!=e._onmessage&&e._onmessage.call(e,c(r))}}return Object.defineProperty(r.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?d.parentPort.removeListener("message",this._messageHandler):null==this._onmessage&&d.parentPort.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),r.prototype.postMessage=function(e,r){d.parentPort.postMessage(e)},r.prototype.close=function(){e.exit()},r}();n.DedicatedWorkerGlobalScope=p,n.self=new p,n.importScripts=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=f("vm"),n=f("fs");e.forEach((function(e){var r=n.readFileSync(e,"utf-8");t.runInThisContext(r)}))}}}}}.call(this,t(10),t(11))},function(e,r){var t,n,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&h())}function h(){if(!l){var e=u(d);l=!0;for(var r=s.length;r;){for(c=s,s=[];++f<r;)c&&c[f].run();f=-1,r=s.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(r){return n.call(this,e)}}}(e)}}function p(e,r){this.fun=e,this.array=r}function v(){}a.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];s.push(new p(e,r)),1!==s.length||l||u(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=v,a.addListener=v,a.once=v,a.off=v,a.removeListener=v,a.removeAllListeners=v,a.emit=v,a.prependListener=v,a.prependOnceListener=v,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,r,t){"use strict";t.r(r);var n={};t.r(n),t.d(n,"createParseGlobals",(function(){return Dn})),t.d(n,"ReasonKind",(function(){return _n})),t.d(n,"notImplemented",(function(){return Ln})),t.d(n,"notFormulaString",(function(){return Fn})),t.d(n,"createParser",(function(){return Qu})),t.d(n,"parseResultHelper",(function(){return ac}));var a={};t.r(a),t.d(a,"createAnalyzeGlobals",(function(){return dc})),t.d(a,"createAnalyzer",(function(){return qs}));var o={};t.r(o),t.d(o,"fastMathpack",(function(){return ol})),t.d(o,"createCompiler",(function(){return Ff})),t.d(o,"createEvaluator",(function(){return Ip})),t.d(o,"createFormulaInspector",(function(){return Fp})),t.d(o,"ReasonKind",(function(){return Pl})),t.d(o,"CellKind",(function(){return wl})),t.d(o,"Interrupt",(function(){return Ul})),t.d(o,"notImplemented",(function(){return Ml})),t.d(o,"finalValue",(function(){return Bl})),t.d(o,"pendingValue",(function(){return Vl})),t.d(o,"cellFormula",(function(){return Wl})),t.d(o,"unavailable",(function(){return bl})),t.d(o,"unevaluated",(function(){return Kl})),t.d(o,"stopped",(function(){return Hl})),t.d(o,"nameCycle",(function(){return Jl})),t.d(o,"cellCycle",(function(){return ql})),t.d(o,"paused",(function(){return Ql})),t.d(o,"previousFailure",(function(){return Yl})),t.d(o,"javaScriptError",(function(){return Xl})),t.d(o,"evalGlobals",(function(){return jl})),t.d(o,"getEvalFailureReason",(function(){return zl})),t.d(o,"illFormedFormula",(function(){return xl})),t.d(o,"createCompileGlobals",(function(){return Gl})),t.d(o,"extractResultValue",(function(){return lf})),t.d(o,"evalToCellValue",(function(){return ff})),t.d(o,"getBasicFirstOrderFunc",(function(){return Hv})),t.d(o,"extension",(function(){return Bv}));var i={};t.r(i),t.d(i,"WorkerKind",(function(){return em})),t.d(i,"ErrorKind",(function(){return rm})),t.d(i,"isWorkerSupported",(function(){return Vm})),t.d(i,"createWorker",(function(){return Hm})),t.d(i,"tryCreateWorker",(function(){return Km})),t.d(i,"dedicatedWorkerInsideInit",(function(){return Jm})),t.d(i,"runSmokeTest",(function(){return eE})),t.d(i,"cancelSmokeTest",(function(){return Zm})),t.d(i,"smokeTestInsideDef",(function(){return qm}));var u={};t.r(u),t.d(u,"getBasicFirstOrderFunc",(function(){return Hv})),t.d(u,"makeGetFirstOrderFunc",(function(){return Kv}));var c={};t.r(c),t.d(c,"recalcMapper",(function(){return Sg})),t.d(c,"mapperContext",(function(){return Tg})),t.d(c,"formulaCacheGlobals",(function(){return Dg})),t.d(c,"formulaCache",(function(){return _g})),t.d(c,"createFormatInfo",(function(){return Lg})),t.d(c,"worksheetFunctionName",(function(){return wg})),t.d(c,"localeData",(function(){return Pg})),t.d(c,"numberFormat",(function(){return Gg})),t.d(c,"sheetName",(function(){return xg})),t.d(c,"blankValue",(function(){return Bg})),t.d(c,"errorValue",(function(){return Vg})),t.d(c,"richValue",(function(){return Wg})),t.d(c,"cellLocation",(function(){return Hg})),t.d(c,"rangeLocation",(function(){return Kg})),t.d(c,"sheetRangeLocation",(function(){return jg})),t.d(c,"cellData",(function(){return Jg})),t.d(c,"rangeUpdate",(function(){return qg})),t.d(c,"rangeWrite",(function(){return Yg})),t.d(c,"rangePromote",(function(){return Xg})),t.d(c,"arrayData",(function(){return Qg})),t.d(c,"arrayUpdate",(function(){return zg})),t.d(c,"arrayWrite",(function(){return Zg})),t.d(c,"arrayPromote",(function(){return $g})),t.d(c,"rangeFormulaEdit",(function(){return am})),t.d(c,"arrayFormulaEdit",(function(){return om})),t.d(c,"inferredFormat",(function(){return im})),t.d(c,"cellDataDelta",(function(){return um})),t.d(c,"rangeDelta",(function(){return cm})),t.d(c,"arrayDelta",(function(){return sm})),t.d(c,"rangeFailure",(function(){return lm})),t.d(c,"recalcResults",(function(){return fm})),t.d(c,"updateRequest",(function(){return dm})),t.d(c,"createRecalcService",(function(){return qT})),t.d(c,"RecalcServiceCreateMode",(function(){return KT})),t.d(c,"recalcServiceInsideDef",(function(){return JT}));var s={};t.r(s),t.d(s,"Workbook",(function(){return pC})),t.d(s,"DataCell",(function(){return YT})),t.d(s,"FormulaCell",(function(){return QT})),t.d(s,"FailedCell",(function(){return zT})),t.d(s,"emptyCell",(function(){return XT})),t.d(s,"Worksheet",(function(){return $T}));var l=t(0);function f(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function d(e,r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.apply(void 0,[e].concat(t))}}function h(e){return e}function p(e){if("object"!=typeof e)return"<unexpected>";var r={};for(var t in e)e.hasOwnProperty(t)&&(r[t]=v(e[t],t));return r}function v(e,r){if("string"==typeof r&&null!=E[r])return e;var t=function(e){var r=typeof e;if("object"===r){if(null===e)return"null";if(e instanceof Array)return"Array";var t=e.kind;if("string"==typeof t)return t}return r}(e),n=S[t];return null!=n?n(e,r):"object"==typeof e?p(e):"<unexpected>"}function g(e){try{var r=function(e){if("object"==typeof e&&null!=e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&("Literal"===(r=e.kind)||"Array"===r||"App"===r||"Paren"===r||"Name"===r||"CellRef"===r||"Bad"===r||"Operator"===r))return"FormulaNode"}var r}(e);if(void 0!==r){var t=T[r](e);return void 0!==t?t:JSON.stringify(v(e,void 0))}return JSON.stringify(v(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var m,E={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},S={boolean:h,symbol:h,undefined:h,null:h,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var r=e.name;return"string"==typeof r&&r.length>0?"<function "+r+">":"<function>"},object:p,Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(v):"<unexpected>"}},T={},C={ULS:new l.NulLogger};function R(e){C.ULS=e}function I(e,r){var t=e+": code should be unreachable because a value has type 'never'; given "+g(r);return C.ULS.assertTag(595980872,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}function y(e){return C.ULS.assertTag(595980873,l.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,r){(!f(r)||r<0)&&y(e+": expected natural number; given "+g(r))}function N(e,r){(!f(r)||r<=0)&&y(e+": expected positive integer; given "+g(r))}function O(e,r,t){(!f(r)||r<0||r>=t)&&y(e+": expected natural number less than "+g(t)+"; given "+g(r))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(m||(m={}));var k=L(void 0,"");function L(e,r){return{path:e,name:r}}function D(e,r,t){return{document:e,index:r,length:t}}function _(e,r,t){return A("calc.lang.sheetRange",r),N("calc.lang.sheetRange",t),D(e,r,t)}function F(e,r){return A("calc.lang.sheetIndex",r),D(e,r,1)}function M(e,r,t,n){return{row:e,col:r,rows:t,cols:n}}function b(e,r,t,n){return A("calc.lang.gridRange",e),A("calc.lang.gridRange",r),N("calc.lang.gridRange",t),N("calc.lang.gridRange",n),M(e,r,t,n)}function w(e,r){return A("calc.lang.gridCell",e),A("calc.lang.gridCell",r),M(e,r,1,1)}function U(e,r){return{sheet:e,range:r}}var P,G,x,B,V,W,H=U,K=U,j=U;function J(e){return{document:e,index:void 0}}function q(e,r){return{scope:e,name:r}}function Y(e,r,t,n,a,o){(A("calc.lang.functionType",e),0===t.length&&r.length<e)&&y("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(r));return{minArgs:e,headTypes:r,restTypes:t,returnType:n,staticPrecs:a,flags:o}}function X(e,r,t,n){return{cells:e,names:r,special:t,isExact:n}}function Q(e){return{kind:P.Error,type:e}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(P||(P={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(G||(G={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.All=4095]="All"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(B||(B={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=9]="FIELD"}(V||(V={})),function(e){e[e.First=1]="First",e[e.Last=9]="Last"}(W||(W={}));var z=Q(V.NULL),Z=Q(V.DIV0),$=Q(V.VALUE),ee=Q(V.REF),re=Q(V.NAME),te=Q(V.NUM),ne=Q(V.NA),ae=Q(V.GETTING_DATA),oe=Q(V.FIELD);function ie(e,r,t){return A("calc.lang.arrayOper",e),A("calc.lang.arrayOper",r),t.length!==e?y("calc.lang.arrayOper: Inconsistent row number"):{kind:P.Array,rows:e,cols:r,opers:t}}function ue(e,r){return N("calc.lang.rangeSeqOper",r.length),{kind:P.Range,sheets:e,ranges:r}}function ce(e,r){return{kind:P.Range,sheets:e,ranges:[r]}}var se,le,fe,de,he,pe,ve={kind:P.Missing},ge={kind:P.Blank};function me(e){return void 0===e&&(e=0),{kind:le.Error,isQuoted:!1,label:e}}function Ee(e){return void 0===e&&(e=0),{kind:le.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(se||(se={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(le||(le={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(fe||(fe={})),function(e){e.Abs="Abs",e.Rel="Rel"}(de||(de={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(he||(he={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(pe||(pe={}));var Se=me(),Te=Ee();function Ce(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),{kind:le.Document,isQuoted:t,label:n,document:e,path:r}}function Re(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),{kind:le.Sheet,isQuoted:t,label:n,sheet:e,document:r}}function Ie(e,r,t){return void 0===r&&(r=!1),void 0===t&&(t=0),{kind:le.Ident,isQuoted:r,label:t,name:e}}function ye(e,r,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),{kind:le.SheetRange,isQuoted:t,label:n,sheet1:e,sheet2:r}}function Ae(e,r){return{kind:e,index:r}}function Ne(e){return void 0===e&&(e=0),{kind:fe.Error,label:e}}var Oe,ke=Ne();function Le(e,r,t){return void 0===t&&(t=0),{kind:fe.Single,label:t,row:e,col:r}}function De(e,r,t){return void 0===t&&(t=0),{kind:fe.Range,label:t,ref1:e,ref2:r}}function _e(e,r,t){return void 0===t&&(t=0),{kind:fe.Row,label:t,row1:e,row2:r}}function Fe(e,r,t){return void 0===t&&(t=0),{kind:fe.Col,label:t,col1:e,col2:r}}function Me(e,r){return{node:e,spans:r}}function be(e,r,t,n){var a,o;return A("calc.lang.formulaSpan",e),a="calc.lang.formulaSpan",f(o=r)||y(a+": expected integer; given "+g(o)),r<e&&y("calc.lang.formulaSpan: expected end >= "+e+"; given "+r),{start:e,end:r,pre:t,post:n}}function we(e,r,t){return void 0===r&&(r=!0),void 0===t&&(t=0),{kind:he.Literal,label:t,oper:e,isClosed:r}}function Ue(e,r,t){return void 0===r&&(r=!0),void 0===t&&(t=0),{kind:he.Array,label:t,nodes:e,isClosed:r}}function Pe(e,r,t,n){return void 0===t&&(t=!0),void 0===n&&(n=0),{kind:he.App,label:n,head:e,args:r,isClosed:t}}function Ge(e,r){return void 0===r&&(r=0),{kind:he.Operator,label:r,id:e}}function xe(e,r,t){return void 0===r&&(r=!0),void 0===t&&(t=0),{kind:he.Paren,label:t,node:e,isClosed:r}}function Be(e,r,t){return void 0===t&&(t=0),{kind:he.Name,label:t,whole:e,qualifier:r}}function Ve(e,r,t){return void 0===t&&(t=0),{kind:he.CellRef,label:t,ref:e,qualifier:r}}function We(e,r,t){return void 0===t&&(t=0),{kind:he.Bad,label:t,type:e,contents:r}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.RECORDTEST=614]="RECORDTEST",e[e.GRF=615]="GRF",e[e.UNIT=616]="UNIT",e[e.RICHERROR=617]="RICHERROR",e[e.FILTER=618]="FILTER",e[e.FUN=619]="FUN",e[e.LET=620]="LET",e[e.ARRAYMAKE=621]="ARRAYMAKE",e[e.APPLY=622]="APPLY",e[e.ISFUN=623]="ISFUN",e[e.ARITY=624]="ARITY",e[e.RECURSE=625]="RECURSE",e[e.FIELDVALUE=626]="FIELDVALUE"}(Oe||(Oe={}));var He=[];He[Oe.COUNT]=Y(1,[],[57],1,0,0),He[Oe.IF]=Y(1,[36,575,575],[],567,0,0),He[Oe.ISNA]=Y(1,[15],[],4,0,0),He[Oe.ISERROR]=Y(1,[15],[],4,0,0),He[Oe.SUM]=Y(1,[],[49],1,0,0),He[Oe.AVERAGE]=Y(1,[],[49],1,0,0),He[Oe.MIN]=Y(1,[],[49],1,0,0),He[Oe.MAX]=Y(1,[],[49],1,0,0),He[Oe.ROW]=Y(0,[16],[],33,0,0),He[Oe.COLUMN]=Y(0,[16],[],33,0,0),He[Oe.NA]=Y(0,[],[],3,0,0),He[Oe.NPV]=Y(2,[1],[49],1,0,0),He[Oe.STDEV]=Y(1,[],[49],1,0,0),He[Oe.DOLLAR]=Y(1,[1,1],[],2,0,0),He[Oe.FIXED]=Y(1,[1,65,4],[],2,0,0),He[Oe.SIN]=Y(1,[1],[],1,0,0),He[Oe.COS]=Y(1,[1],[],1,0,0),He[Oe.TAN]=Y(1,[1],[],1,0,0),He[Oe.ATAN]=Y(1,[1],[],1,0,0),He[Oe.PI]=Y(0,[],[],1,0,0),He[Oe.SQRT]=Y(1,[1],[],1,0,0),He[Oe.EXP]=Y(1,[1],[],1,0,0),He[Oe.LN]=Y(1,[1],[],1,0,0),He[Oe.LOG10]=Y(1,[1],[],1,0,0),He[Oe.ABS]=Y(1,[1],[],1,0,0),He[Oe.INT]=Y(1,[1],[],1,0,0),He[Oe.SIGN]=Y(1,[1],[],1,0,0),He[Oe.ROUND]=Y(2,[1,1],[],1,0,0),He[Oe.LOOKUP]=Y(2,[7,48,48],[],7,0,0),He[Oe.INDEX]=Y(2,[48,1,1,1],[],55,0,0),He[Oe.REPT]=Y(2,[2,1],[],2,0,0),He[Oe.MID]=Y(3,[2,1,1],[],2,0,0),He[Oe.LEN]=Y(1,[2],[],1,0,0),He[Oe.VALUE]=Y(1,[7],[],1,0,0),He[Oe.TRUE]=Y(0,[],[],4,0,0),He[Oe.FALSE]=Y(0,[],[],4,0,0),He[Oe.AND]=Y(1,[],[52],4,0,0),He[Oe.OR]=Y(1,[],[52],4,0,0),He[Oe.NOT]=Y(1,[4],[],4,0,0),He[Oe.MOD]=Y(2,[1,1],[],1,0,0),He[Oe.DCOUNT]=Y(3,[16,83,18],[],1,0,0),He[Oe.DSUM]=Y(3,[16,19,18],[],1,0,0),He[Oe.DAVERAGE]=Y(3,[16,19,18],[],1,0,0),He[Oe.DMIN]=Y(3,[16,19,18],[],1,0,0),He[Oe.DMAX]=Y(3,[16,19,18],[],1,0,0),He[Oe.DSTDEV]=Y(3,[16,19,18],[],1,0,0),He[Oe.VAR]=Y(1,[],[49],1,0,0),He[Oe.DVAR]=Y(3,[16,19,18],[],1,0,0),He[Oe.TEXT]=Y(2,[7,2],[],2,0,0),He[Oe.LINEST]=Y(1,[48,112,84,84],[],32,0,0),He[Oe.TREND]=Y(1,[48,112,112,84],[],32,0,0),He[Oe.LOGEST]=Y(1,[48,112,84,84],[],32,0,0),He[Oe.GROWTH]=Y(1,[48,112,112,84],[],32,0,0),He[Oe.GOTO]=Y(1,[16],[],512,0,2),He[Oe.HALT]=Y(0,[4],[],512,0,2),He[Oe.RETURN]=Y(0,[575],[],512,0,2),He[Oe.PV]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.FV]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.NPER]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.PMT]=Y(3,[1,1,1,1,1],[],1,0,0),He[Oe.RATE]=Y(3,[1,1,1,1,1,1],[],1,0,0),He[Oe.MIRR]=Y(3,[48,1,1],[],1,0,0),He[Oe.IRR]=Y(1,[48,1],[],1,0,0),He[Oe.RAND]=Y(0,[],[],1,4095,0),He[Oe.MATCH]=Y(2,[7,49,17],[],1,0,0),He[Oe.DATE]=Y(3,[1,1,1],[],1,0,0),He[Oe.TIME]=Y(3,[1,1,1],[],1,0,0),He[Oe.DAY]=Y(1,[1],[],1,0,0),He[Oe.MONTH]=Y(1,[1],[],1,0,0),He[Oe.YEAR]=Y(1,[1],[],1,0,0),He[Oe.WEEKDAY]=Y(1,[1,1],[],1,0,0),He[Oe.HOUR]=Y(1,[1],[],1,0,0),He[Oe.MINUTE]=Y(1,[1],[],1,0,0),He[Oe.SECOND]=Y(1,[1],[],1,0,0),He[Oe.NOW]=Y(0,[],[],1,4095,0),He[Oe.AREAS]=Y(1,[16],[],1,0,0),He[Oe.ROWS]=Y(1,[48],[],1,0,0),He[Oe.COLUMNS]=Y(1,[48],[],1,0,0),He[Oe.OFFSET]=Y(3,[16,65,65,65,65],[],16,4095,0),He[Oe.ABSREF]=Y(2,[2,16],[],16,0,2),He[Oe.RELREF]=Y(2,[16,16],[],2,0,2),He[Oe.ARGUMENT]=Y(0,[66,81,16],[],4,0,2),He[Oe.SEARCH]=Y(2,[2,2,1],[],1,0,0),He[Oe.TRANSPOSE]=Y(1,[39],[],32,0,0),He[Oe.ERROR]=Y(0,[1,24],[],4,0,2),He[Oe.STEP]=Y(0,[],[],4,0,2),He[Oe.TYPE]=Y(1,[47],[],1,0,0),He[Oe.ECHO]=Y(0,[4],[],4,0,2),He[Oe.SET_NAME]=Y(1,[2,63],[],4,0,2),He[Oe.CALLER]=Y(0,[],[],50,0,2),He[Oe.DEREF]=Y(1,[16],[],47,0,2),He[Oe.WINDOWS]=Y(0,[65,66],[],32,0,2),He[Oe.SERIES]=Y(4,[87,117,117,1,117],[],4,0,0),He[Oe.DOCUMENTS]=Y(0,[1,66],[],32,0,2),He[Oe.ACTIVE_CELL]=Y(0,[],[],16,0,2),He[Oe.SELECTION]=Y(0,[],[],16,0,2),He[Oe.RESULT]=Y(0,[1],[],4,0,2),He[Oe.ATAN2]=Y(2,[1,1],[],1,0,0),He[Oe.ASIN]=Y(1,[1],[],1,0,0),He[Oe.ACOS]=Y(1,[1],[],1,0,0),He[Oe.CHOOSE]=Y(2,[33],[575],567,0,0),He[Oe.HLOOKUP]=Y(3,[7,49,49,4],[],39,0,0),He[Oe.VLOOKUP]=Y(3,[7,49,49,4],[],39,0,0),He[Oe.LINKS]=Y(0,[66,65],[],32,0,2),He[Oe.INPUT]=Y(1,[2,65,66,67,65,65,2],[],575,0,2),He[Oe.ISREF]=Y(1,[63],[],4,0,0),He[Oe.GET_FORMULA]=Y(1,[18],[],2,0,2),He[Oe.GET_NAME]=Y(1,[2,4],[],6,0,2),He[Oe.SET_VALUE]=Y(2,[16,47],[],4,0,2),He[Oe.LOG]=Y(1,[1,1],[],1,0,0),He[Oe.EXEC]=Y(1,[2,1,4,4],[],7,0,2),He[Oe.CHAR]=Y(1,[1],[],2,0,0),He[Oe.LOWER]=Y(1,[2],[],2,0,0),He[Oe.UPPER]=Y(1,[2],[],2,0,0),He[Oe.PROPER]=Y(1,[2],[],2,0,0),He[Oe.LEFT]=Y(1,[2,9],[],2,0,0),He[Oe.RIGHT]=Y(1,[2,9],[],2,0,0),He[Oe.EXACT]=Y(2,[2,2],[],4,0,0),He[Oe.TRIM]=Y(1,[2],[],2,0,0),He[Oe.REPLACE]=Y(4,[2,1,1,2],[],2,0,0),He[Oe.SUBSTITUTE]=Y(3,[2,2,2,2],[],2,0,0),He[Oe.CODE]=Y(1,[2],[],1,0,0),He[Oe.NAMES]=Y(0,[66,65,66],[],32,0,2),He[Oe.DIRECTORY]=Y(0,[2],[],2,0,2),He[Oe.FIND]=Y(2,[2,2,1],[],1,0,0),He[Oe.CELL]=Y(1,[2,16],[],47,4095,0),He[Oe.ISERR]=Y(1,[15],[],4,0,0),He[Oe.ISTEXT]=Y(1,[143],[],4,0,0),He[Oe.ISNUMBER]=Y(1,[143],[],4,0,0),He[Oe.ISBLANK]=Y(1,[143],[],4,0,0),He[Oe.T]=Y(1,[23],[],2,0,0),He[Oe.N]=Y(1,[23],[],1,0,0),He[Oe.FOPEN]=Y(1,[2,1],[],1,0,2),He[Oe.FCLOSE]=Y(1,[1],[],1,0,2),He[Oe.FSIZE]=Y(1,[1],[],1,0,2),He[Oe.FREADLN]=Y(1,[1],[],2,0,2),He[Oe.FREAD]=Y(2,[1,1],[],2,0,2),He[Oe.FWRITELN]=Y(2,[1,2],[],1,0,2),He[Oe.FWRITE]=Y(2,[1,2],[],1,0,2),He[Oe.FPOS]=Y(1,[1,1],[],1,0,2),He[Oe.DATEVALUE]=Y(1,[3],[],1,0,0),He[Oe.TIMEVALUE]=Y(1,[3],[],1,0,0),He[Oe.SLN]=Y(3,[1,1,1],[],1,0,0),He[Oe.SYD]=Y(4,[1,1,1,1],[],1,0,0),He[Oe.DDB]=Y(4,[1,1,1,1,1],[],1,0,0),He[Oe.GET_DEF]=Y(1,[2,66,65],[],2,0,2),He[Oe.REFTEXT]=Y(1,[16,4],[],2,0,2),He[Oe.TEXTREF]=Y(1,[2,4],[],16,0,2),He[Oe.INDIRECT]=Y(1,[2,4],[],16,4095,0),He[Oe.REGISTER]=Y(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),He[Oe.CALL]=Y(1,[3],[127],575,0,2),He[Oe.ADD_BAR]=Y(0,[3],[],1,0,2),He[Oe.ADD_MENU]=Y(2,[3,115,83,3],[],1,0,2),He[Oe.ADD_COMMAND]=Y(3,[3,83,115,83,3],[],1,0,2),He[Oe.ENABLE_COMMAND]=Y(4,[3,3,3,4,3],[],4,0,2),He[Oe.CHECK_COMMAND]=Y(4,[3,3,3,4,3],[],4,0,2),He[Oe.RENAME_COMMAND]=Y(4,[3,3,3,3,3],[],4,0,2),He[Oe.SHOW_BAR]=Y(0,[3],[],4,0,2),He[Oe.DELETE_MENU]=Y(2,[3,3,3],[],4,0,2),He[Oe.DELETE_COMMAND]=Y(3,[3,3,3,3],[],4,0,2),He[Oe.GET_CHART_ITEM]=Y(1,[1,67,66],[],1,0,2),He[Oe.DIALOG_BOX]=Y(1,[52],[],36,0,2),He[Oe.CLEAN]=Y(1,[2],[],2,0,0),He[Oe.MDETERM]=Y(1,[32],[],1,0,0),He[Oe.MINVERSE]=Y(1,[32],[],32,0,0),He[Oe.MMULT]=Y(2,[32,32],[],32,0,0),He[Oe.FILES]=Y(0,[2,2],[],32,0,2),He[Oe.IPMT]=Y(4,[1,1,1,1,1,1],[],1,0,0),He[Oe.PPMT]=Y(4,[1,1,1,1,1,1],[],1,0,0),He[Oe.COUNTA]=Y(1,[],[121],1,0,0),He[Oe.CANCEL_KEY]=Y(0,[1,16],[],4,0,2),He[Oe.FOR]=Y(3,[2,1,1,1],[],512,0,2),He[Oe.WHILE]=Y(1,[4],[],512,0,2),He[Oe.BREAK]=Y(0,[],[],512,0,2),He[Oe.NEXT]=Y(0,[],[],512,0,2),He[Oe.INITIATE]=Y(2,[2,2],[],1,0,2),He[Oe.REQUEST]=Y(2,[1,2],[],32,0,2),He[Oe.POKE]=Y(3,[1,18,18],[],4,0,2),He[Oe.EXECUTE]=Y(2,[1,2],[],4,0,2),He[Oe.TERMINATE]=Y(1,[1],[],4,0,2),He[Oe.RESTART]=Y(0,[1],[],512,0,2),He[Oe.HELP]=Y(0,[2],[],4,0,2),He[Oe.GET_BAR]=Y(0,[3,3,3,3],[],3,0,2),He[Oe.PRODUCT]=Y(1,[],[113],1,0,0),He[Oe.FACT]=Y(1,[1],[],1,0,0),He[Oe.GET_CELL]=Y(1,[1,16],[],47,0,2),He[Oe.GET_WORKSPACE]=Y(1,[1],[],47,0,2),He[Oe.GET_WINDOW]=Y(1,[1,2],[],47,0,2),He[Oe.GET_DOCUMENT]=Y(1,[1,2],[],63,0,2),He[Oe.DPRODUCT]=Y(3,[16,19,18],[],1,0,0),He[Oe.ISNONTEXT]=Y(1,[143],[],4,0,0),He[Oe.GET_NOTE]=Y(0,[82,65,65],[],2,0,2),He[Oe.NOTE]=Y(0,[66,82,17,17],[],1,0,2),He[Oe.STDEVP]=Y(1,[],[49],1,0,0),He[Oe.VARP]=Y(1,[],[49],1,0,0),He[Oe.DSTDEVP]=Y(3,[16,19,18],[],1,0,0),He[Oe.DVARP]=Y(3,[16,19,18],[],1,0,0),He[Oe.TRUNC]=Y(1,[1,1],[],1,0,0),He[Oe.ISLOGICAL]=Y(1,[143],[],4,0,0),He[Oe.DCOUNTA]=Y(3,[16,83,18],[],1,0,0),He[Oe.DELETE_BAR]=Y(1,[3],[],4,0,2),He[Oe.UNREGISTER]=Y(1,[3],[],4,0,2),He[Oe.USDOLLAR]=Y(1,[1,1],[],2,0,0),He[Oe.FINDB]=Y(2,[2,2,1],[],1,0,0),He[Oe.SEARCHB]=Y(2,[2,2,1],[],1,0,0),He[Oe.REPLACEB]=Y(4,[2,1,1,2],[],2,0,0),He[Oe.LEFTB]=Y(1,[2,9],[],2,0,0),He[Oe.RIGHTB]=Y(1,[2,9],[],2,0,0),He[Oe.MIDB]=Y(3,[2,1,1],[],2,0,0),He[Oe.LENB]=Y(1,[2],[],1,0,0),He[Oe.ROUNDUP]=Y(2,[1,1],[],1,0,0),He[Oe.ROUNDDOWN]=Y(2,[1,1],[],1,0,0),He[Oe.ASC]=Y(1,[2],[],2,0,0),He[Oe.DBCS]=Y(1,[2],[],2,0,0),He[Oe.RANK]=Y(2,[1,16,4],[],1,0,0),He[Oe.ADDRESS]=Y(2,[1,65,65,68,66],[],2,0,0),He[Oe.DAYS360]=Y(2,[1,1,4],[],1,0,0),He[Oe.TODAY]=Y(0,[],[],1,4095,0),He[Oe.VDB]=Y(5,[1,1,1,1,1,1,4],[],1,0,0),He[Oe.ELSE]=Y(0,[],[],512,0,2),He[Oe.ELSE_IF]=Y(1,[12],[],512,0,2),He[Oe.END_IF]=Y(0,[],[],512,0,2),He[Oe.FOR_CELL]=Y(1,[2,82,84],[],512,0,2),He[Oe.MEDIAN]=Y(1,[],[49],1,0,0),He[Oe.SUMPRODUCT]=Y(1,[],[32],1,0,0),He[Oe.SINH]=Y(1,[1],[],1,0,0),He[Oe.COSH]=Y(1,[1],[],1,0,0),He[Oe.TANH]=Y(1,[1],[],1,0,0),He[Oe.ASINH]=Y(1,[1],[],1,0,0),He[Oe.ACOSH]=Y(1,[1],[],1,0,0),He[Oe.ATANH]=Y(1,[1],[],1,0,0),He[Oe.DGET]=Y(3,[16,19,18],[],7,0,0),He[Oe.CREATE_OBJECT]=Y(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),He[Oe.VOLATILE]=Y(0,[4],[],4,0,2),He[Oe.LAST_ERROR]=Y(0,[],[],16,0,2),He[Oe.CUSTOM_UNDO]=Y(0,[2,2],[],4,0,2),He[Oe.CUSTOM_REPEAT]=Y(0,[2,2,2],[],4,0,2),He[Oe.FORMULA_CONVERT]=Y(2,[2,23,23,23,23],[],2,0,2),He[Oe.GET_LINK_INFO]=Y(2,[2,1,1,2],[],1,0,2),He[Oe.TEXT_BOX]=Y(1,[2,66,65,65],[],1,0,2),He[Oe.INFO]=Y(1,[2],[],3,4095,0),He[Oe.GROUP]=Y(0,[],[],2,0,2),He[Oe.GET_OBJECT]=Y(1,[1,2,1,1,1],[],47,0,2),He[Oe.DB]=Y(4,[1,1,1,1,1],[],1,0,0),He[Oe.PAUSE]=Y(0,[4],[],512,0,2),He[Oe.ERROR_CODE]=Y(0,[],[],2,0,2),He[Oe.ALLOC_COUNT]=Y(0,[],[],1,0,2),He[Oe.RESUME]=Y(0,[1],[],512,0,2),He[Oe.FREQUENCY]=Y(2,[48,48],[],32,0,0),He[Oe.ADD_TOOLBAR]=Y(0,[66,96],[],2,0,2),He[Oe.DELETE_TOOLBAR]=Y(1,[2],[],4,0,2),He[Oe._UDF]=Y(1,[17],[127],575,0,0),He[Oe.RESET_TOOLBAR]=Y(1,[3],[],4,0,2),He[Oe.EVALUATE]=Y(1,[2],[],63,0,2),He[Oe.GET_TOOLBAR]=Y(1,[1,3],[],47,0,2),He[Oe.GET_TOOL]=Y(1,[1,3,1],[],47,0,2),He[Oe.SPELLING_CHECK]=Y(1,[2,66,4],[],4,0,2),He[Oe.ERROR_TYPE]=Y(1,[15],[],1,0,0),He[Oe.APP_TITLE]=Y(0,[2],[],4,0,2),He[Oe.WINDOW_TITLE]=Y(0,[2],[],4,0,2),He[Oe.SAVE_TOOLBAR]=Y(0,[99,66],[],4,0,2),He[Oe.ENABLE_TOOL]=Y(3,[3,1,4],[],4,0,2),He[Oe.PRESS_TOOL]=Y(3,[3,1,4],[],4,0,2),He[Oe.REGISTER_ID]=Y(2,[2,3,66],[],1,0,2),He[Oe.GET_PROJECT]=Y(1,[1,2],[],35,0,2),He[Oe.AVEDEV]=Y(1,[],[49],1,0,0),He[Oe.BETADIST]=Y(3,[1,1,1,65,65],[],1,0,0),He[Oe.GAMMALN]=Y(1,[1],[],1,0,0),He[Oe.BETAINV]=Y(3,[1,1,1,65,65],[],1,0,0),He[Oe.BINOMDIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.CHIDIST]=Y(2,[1,1],[],1,0,0),He[Oe.CHIINV]=Y(2,[1,1],[],1,0,0),He[Oe.COMBIN]=Y(2,[1,1],[],1,0,0),He[Oe.CONFIDENCE]=Y(3,[1,1,1],[],1,0,0),He[Oe.CRITBINOM]=Y(3,[1,1,1],[],1,0,0),He[Oe.EVEN]=Y(1,[1],[],1,0,0),He[Oe.EXPONDIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.FDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.FINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.FISHER]=Y(1,[1],[],1,0,0),He[Oe.FISHERINV]=Y(1,[1],[],1,0,0),He[Oe.FLOOR]=Y(2,[1,1],[],1,0,0),He[Oe.GAMMADIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.GAMMAINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.CEILING]=Y(2,[1,1],[],1,0,0),He[Oe.HYPGEOMDIST]=Y(4,[1,1,1,1],[],1,0,0),He[Oe.LOGNORMDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.LOGINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.NEGBINOMDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.NORMDIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NORMSDIST]=Y(1,[1],[],1,0,0),He[Oe.NORMINV]=Y(3,[1,1,1],[],1,0,0),He[Oe.NORMSINV]=Y(1,[1],[],1,0,0),He[Oe.STANDARDIZE]=Y(3,[1,1,1],[],1,0,0),He[Oe.ODD]=Y(1,[1],[],1,0,0),He[Oe.PERMUT]=Y(2,[1,1],[],1,0,0),He[Oe.POISSON]=Y(3,[1,1,4],[],1,0,0),He[Oe.TDIST]=Y(3,[1,1,1],[],1,0,0),He[Oe.WEIBULL]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.SUMXMY2]=Y(2,[32,32],[],1,0,0),He[Oe.SUMX2MY2]=Y(2,[32,32],[],1,0,0),He[Oe.SUMX2PY2]=Y(2,[32,32],[],1,0,0),He[Oe.CHITEST]=Y(2,[32,32],[],1,0,0),He[Oe.CORREL]=Y(2,[32,32],[],1,0,0),He[Oe.COVAR]=Y(2,[32,32],[],1,0,0),He[Oe.FORECAST]=Y(3,[1,32,32],[],1,0,0),He[Oe.FTEST]=Y(2,[32,32],[],1,0,0),He[Oe.INTERCEPT]=Y(2,[32,32],[],1,0,0),He[Oe.PEARSON]=Y(2,[32,32],[],1,0,0),He[Oe.RSQ]=Y(2,[32,32],[],1,0,0),He[Oe.STEYX]=Y(2,[32,32],[],1,0,0),He[Oe.SLOPE]=Y(2,[32,32],[],1,0,0),He[Oe.TTEST]=Y(4,[32,32,1,1],[],1,0,0),He[Oe.PROB]=Y(3,[32,32,1,65],[],1,0,0),He[Oe.DEVSQ]=Y(1,[],[49],1,0,0),He[Oe.GEOMEAN]=Y(1,[],[49],1,0,0),He[Oe.HARMEAN]=Y(1,[],[49],1,0,0),He[Oe.SUMSQ]=Y(1,[],[49],1,0,0),He[Oe.KURT]=Y(1,[],[49],1,0,0),He[Oe.SKEW]=Y(1,[],[49],1,0,0),He[Oe.ZTEST]=Y(2,[49,1,1],[],1,0,0),He[Oe.LARGE]=Y(2,[49,1],[],1,0,0),He[Oe.SMALL]=Y(2,[49,1],[],1,0,0),He[Oe.QUARTILE]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTILE]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTRANK]=Y(2,[49,1,65],[],1,0,0),He[Oe.MODE]=Y(1,[],[32],1,0,0),He[Oe.TRIMMEAN]=Y(2,[49,1],[],1,0,0),He[Oe.TINV]=Y(2,[1,1],[],1,0,0),He[Oe.MOVIE_COMMAND]=Y(3,[2,1,1,1],[],1,0,2),He[Oe.GET_MOVIE]=Y(2,[2,1,1],[],1,0,2),He[Oe.CONCATENATE]=Y(1,[],[2],2,0,0),He[Oe.POWER]=Y(2,[1,1],[],1,0,0),He[Oe.SPREADBASE_DATA_FIELD]=Y(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),He[Oe.GET_VIEW]=Y(1,[1,2],[],35,0,2),He[Oe.GET_FIELD]=Y(1,[1,66,2],[],35,0,2),He[Oe.GET_ITEM]=Y(1,[1,66,66,2],[],7,0,2),He[Oe.RADIANS]=Y(1,[1],[],1,0,0),He[Oe.DEGREES]=Y(1,[1],[],1,0,0),He[Oe.SUBTOTAL]=Y(2,[1],[16],1,0,0),He[Oe.SUMIF]=Y(2,[16,15,16],[],1,0,0),He[Oe.COUNTIF]=Y(2,[16,15],[],1,0,0),He[Oe.COUNTBLANK]=Y(1,[16],[],1,0,0),He[Oe.SCENARIO_GET]=Y(1,[1,2],[],19,0,2),He[Oe.OPTIONS_LISTS]=Y(1,[33],[],33,0,2),He[Oe.ISPMT]=Y(4,[1,1,1,1],[],1,0,0),He[Oe.DATEDIF]=Y(3,[1,1,2],[],1,0,0),He[Oe.DATESTRING]=Y(1,[1],[],2,0,0),He[Oe.NUMBERSTRING]=Y(2,[1,1],[],2,0,0),He[Oe.ROMAN]=Y(1,[1,5],[],2,0,0),He[Oe.OPENDIALOG]=Y(0,[66,66,66,65],[],6,0,2),He[Oe.SAVEDIALOG]=Y(0,[66,66,66,66,65],[],6,0,2),He[Oe.VIEW_GET]=Y(1,[1,2],[],19,0,2),He[Oe.GETPIVOTDATA]=Y(2,[18,18],[2,79],15,0,0),He[Oe.HYPERLINK]=Y(1,[2,39],[],39,0,0),He[Oe.FURIGANA]=Y(1,[16],[],2,0,0),He[Oe.AVERAGEA]=Y(1,[],[49],1,0,0),He[Oe.MAXA]=Y(1,[],[49],1,0,0),He[Oe.MINA]=Y(1,[],[49],1,0,0),He[Oe.STDEVPA]=Y(1,[],[49],1,0,0),He[Oe.VARPA]=Y(1,[],[49],1,0,0),He[Oe.STDEVA]=Y(1,[],[49],1,0,0),He[Oe.VARA]=Y(1,[],[49],1,0,0),He[Oe.BAHTTEXT]=Y(1,[1],[],2,0,0),He[Oe.THAIDOW]=Y(1,[1],[],2,0,0),He[Oe.THAIDIGIT]=Y(1,[3],[],2,0,0),He[Oe.THAIMOY]=Y(1,[1],[],2,0,0),He[Oe.THAINUMSOUND]=Y(1,[1],[],2,0,0),He[Oe.THAINUMSTRING]=Y(1,[1],[],2,0,0),He[Oe.THAISTRINGLENGTH]=Y(1,[2],[],1,0,0),He[Oe.ISTHAIDIGIT]=Y(1,[2],[],4,0,0),He[Oe.ROUNDBAHTDOWN]=Y(1,[1],[],1,0,0),He[Oe.ROUNDBAHTUP]=Y(1,[1],[],1,0,0),He[Oe.THAIYEAR]=Y(1,[1],[],1,0,0),He[Oe.RTD]=Y(3,[],[2],2,0,0),He[Oe.CUBEVALUE]=Y(1,[2],[50],15,0,0),He[Oe.CUBEMEMBER]=Y(2,[2,50,2],[],10,0,0),He[Oe.CUBEMEMBERPROPERTY]=Y(3,[2,2,2],[],15,0,0),He[Oe.CUBERANKEDMEMBER]=Y(3,[2,2,1,2],[],10,0,0),He[Oe.HEX2BIN]=Y(1,[95,95],[],9,0,0),He[Oe.HEX2DEC]=Y(1,[95],[],9,0,0),He[Oe.HEX2OCT]=Y(1,[95,95],[],9,0,0),He[Oe.DEC2BIN]=Y(1,[95,95],[],9,0,0),He[Oe.DEC2HEX]=Y(1,[95,95],[],9,0,0),He[Oe.DEC2OCT]=Y(1,[95,95],[],9,0,0),He[Oe.OCT2BIN]=Y(1,[95,95],[],9,0,0),He[Oe.OCT2HEX]=Y(1,[95,95],[],9,0,0),He[Oe.OCT2DEC]=Y(1,[95],[],9,0,0),He[Oe.BIN2DEC]=Y(1,[95],[],9,0,0),He[Oe.BIN2OCT]=Y(1,[95,95],[],9,0,0),He[Oe.BIN2HEX]=Y(1,[95,95],[],9,0,0),He[Oe.IMSUB]=Y(2,[95,95],[],9,0,0),He[Oe.IMDIV]=Y(2,[95,95],[],9,0,0),He[Oe.IMPOWER]=Y(2,[95,95],[],9,0,0),He[Oe.IMABS]=Y(1,[95],[],9,0,0),He[Oe.IMSQRT]=Y(1,[95],[],9,0,0),He[Oe.IMLN]=Y(1,[95],[],9,0,0),He[Oe.IMLOG2]=Y(1,[95],[],9,0,0),He[Oe.IMLOG10]=Y(1,[95],[],9,0,0),He[Oe.IMSIN]=Y(1,[95],[],9,0,0),He[Oe.IMCOS]=Y(1,[95],[],9,0,0),He[Oe.IMEXP]=Y(1,[95],[],9,0,0),He[Oe.IMARGUMENT]=Y(1,[95],[],9,0,0),He[Oe.IMCONJUGATE]=Y(1,[95],[],9,0,0),He[Oe.IMAGINARY]=Y(1,[95],[],9,0,0),He[Oe.IMREAL]=Y(1,[95],[],9,0,0),He[Oe.COMPLEX]=Y(2,[95,95,95],[],9,0,0),He[Oe.IMSUM]=Y(1,[],[127],9,0,0),He[Oe.IMPRODUCT]=Y(1,[],[127],9,0,0),He[Oe.SERIESSUM]=Y(4,[95,95,95,127],[],9,0,0),He[Oe.FACTDOUBLE]=Y(1,[95],[],9,0,0),He[Oe.SQRTPI]=Y(1,[95],[],9,0,0),He[Oe.QUOTIENT]=Y(2,[95,95],[],9,0,0),He[Oe.DELTA]=Y(1,[95,95],[],9,0,0),He[Oe.GESTEP]=Y(1,[95,95],[],9,0,0),He[Oe.ISEVEN]=Y(1,[95],[],9,0,0),He[Oe.ISODD]=Y(1,[95],[],9,0,0),He[Oe.MROUND]=Y(2,[95,95],[],9,0,0),He[Oe.ERF]=Y(1,[95,95],[],9,0,0),He[Oe.ERFC]=Y(1,[95],[],9,0,0),He[Oe.BESSELJ]=Y(2,[95,95],[],9,0,0),He[Oe.BESSELK]=Y(2,[95,95],[],9,0,0),He[Oe.BESSELY]=Y(2,[95,95],[],9,0,0),He[Oe.BESSELI]=Y(2,[95,95],[],9,0,0),He[Oe.XIRR]=Y(2,[127,127,95],[],9,0,0),He[Oe.XNPV]=Y(3,[95,127,127],[],9,0,0),He[Oe.PRICEMAT]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.YIELDMAT]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.INTRATE]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.RECEIVED]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.DISC]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.PRICEDISC]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.YIELDDISC]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.TBILLEQ]=Y(3,[95,95,95],[],9,0,0),He[Oe.TBILLPRICE]=Y(3,[95,95,95],[],9,0,0),He[Oe.TBILLYIELD]=Y(3,[95,95,95],[],9,0,0),He[Oe.PRICE]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.YIELD]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.DOLLARDE]=Y(2,[95,95],[],9,0,0),He[Oe.DOLLARFR]=Y(2,[95,95],[],9,0,0),He[Oe.NOMINAL]=Y(2,[95,95],[],9,0,0),He[Oe.EFFECT]=Y(2,[95,95],[],9,0,0),He[Oe.CUMPRINC]=Y(6,[95,95,95,95,95,95],[],9,0,0),He[Oe.CUMIPMT]=Y(6,[95,95,95,95,95,95],[],9,0,0),He[Oe.EDATE]=Y(2,[95,95],[],9,0,0),He[Oe.EOMONTH]=Y(2,[95,95],[],9,0,0),He[Oe.YEARFRAC]=Y(2,[95,95,95],[],9,0,0),He[Oe.COUPDAYBS]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPDAYS]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPDAYSNC]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPNCD]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPNUM]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.COUPPCD]=Y(3,[95,95,95,95],[],9,0,0),He[Oe.DURATION]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.MDURATION]=Y(5,[95,95,95,95,95,95],[],9,0,0),He[Oe.ODDLPRICE]=Y(7,[95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ODDLYIELD]=Y(7,[95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ODDFPRICE]=Y(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ODDFYIELD]=Y(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.RANDBETWEEN]=Y(2,[95,95],[],9,4095,0),He[Oe.WEEKNUM]=Y(1,[95,95],[],9,0,0),He[Oe.AMORDEGRC]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.AMORLINC]=Y(6,[95,95,95,95,95,95,95],[],9,0,0),He[Oe.CONVERT]=Y(3,[95,95,95],[],9,0,0),He[Oe.ACCRINT]=Y(6,[95,95,95,95,95,95,95,95],[],9,0,0),He[Oe.ACCRINTM]=Y(4,[95,95,95,95,95],[],9,0,0),He[Oe.WORKDAY]=Y(2,[95,95,127],[],9,0,0),He[Oe.NETWORKDAYS]=Y(2,[95,95,127],[],9,0,0),He[Oe.GCD]=Y(1,[],[127],9,0,0),He[Oe.MULTINOMIAL]=Y(1,[],[127],9,0,0),He[Oe.LCM]=Y(1,[],[127],9,0,0),He[Oe.FVSCHEDULE]=Y(2,[95,127],[],9,0,0),He[Oe.CUBEKPIMEMBER]=Y(3,[2,2,1,2],[],10,0,0),He[Oe.CUBESET]=Y(2,[2,50,2,1,2],[],10,0,0),He[Oe.CUBESETCOUNT]=Y(1,[2],[],9,0,0),He[Oe.IFERROR]=Y(2,[47,575],[],47,0,0),He[Oe.COUNTIFS]=Y(2,[],[16,15],1,0,0),He[Oe.SUMIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.AVERAGEIF]=Y(2,[16,15,16],[],1,0,0),He[Oe.AVERAGEIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.AGGREGATE]=Y(3,[1,1,48,17],[16],1,0,0),He[Oe.BINOM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.BINOM_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.CONFIDENCE_NORM]=Y(3,[1,1,1],[],1,0,0),He[Oe.CONFIDENCE_T]=Y(3,[1,1,1],[],1,0,0),He[Oe.CHISQ_TEST]=Y(2,[32,32],[],1,0,0),He[Oe.F_TEST]=Y(2,[32,32],[],1,0,0),He[Oe.COVARIANCE_P]=Y(2,[32,32],[],1,0,0),He[Oe.COVARIANCE_S]=Y(2,[32,32],[],1,0,0),He[Oe.EXPON_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.GAMMA_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.GAMMA_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.MODE_MULT]=Y(1,[],[32],32,0,0),He[Oe.MODE_SNGL]=Y(1,[],[32],1,0,0),He[Oe.NORM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NORM_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.PERCENTILE_EXC]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTILE_INC]=Y(2,[49,1],[],1,0,0),He[Oe.PERCENTRANK_EXC]=Y(2,[49,1,65],[],1,0,0),He[Oe.PERCENTRANK_INC]=Y(2,[49,1,65],[],1,0,0),He[Oe.POISSON_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.QUARTILE_EXC]=Y(2,[49,1],[],1,0,0),He[Oe.QUARTILE_INC]=Y(2,[49,1],[],1,0,0),He[Oe.RANK_AVG]=Y(2,[1,16,4],[],1,0,0),He[Oe.RANK_EQ]=Y(2,[1,16,4],[],1,0,0),He[Oe.STDEV_S]=Y(1,[],[49],1,0,0),He[Oe.STDEV_P]=Y(1,[],[49],1,0,0),He[Oe.T_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.T_DIST_2T]=Y(2,[1,1],[],1,0,0),He[Oe.T_DIST_RT]=Y(2,[1,1],[],1,0,0),He[Oe.T_INV]=Y(2,[1,1],[],1,0,0),He[Oe.T_INV_2T]=Y(2,[1,1],[],1,0,0),He[Oe.VAR_S]=Y(1,[],[49],1,0,0),He[Oe.VAR_P]=Y(1,[],[49],1,0,0),He[Oe.WEIBULL_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NETWORKDAYS_INTL]=Y(2,[95,95,75,127],[],9,0,0),He[Oe.WORKDAY_INTL]=Y(2,[95,95,75,127],[],9,0,0),He[Oe.ECMA_CEILING]=Y(2,[1,1],[],1,0,0),He[Oe.ISO_CEILING]=Y(1,[1,65],[],1,0,0),He[Oe.DEBUG]=Y(1,[2],[1151],1087,0,0),He[Oe.BETA_DIST]=Y(4,[1,1,1,4,65,65],[],1,0,0),He[Oe.BETA_INV]=Y(3,[1,1,1,65,65],[],1,0,0),He[Oe.CHISQ_DIST]=Y(3,[1,1,4],[],1,0,0),He[Oe.CHISQ_DIST_RT]=Y(2,[1,1],[],1,0,0),He[Oe.CHISQ_INV]=Y(2,[1,1],[],1,0,0),He[Oe.CHISQ_INV_RT]=Y(2,[1,1],[],1,0,0),He[Oe.F_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.F_DIST_RT]=Y(3,[1,1,1],[],1,0,0),He[Oe.F_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.F_INV_RT]=Y(3,[1,1,1],[],1,0,0),He[Oe.HYPGEOM_DIST]=Y(5,[1,1,1,1,4],[],1,0,0),He[Oe.LOGNORM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.LOGNORM_INV]=Y(3,[1,1,1],[],1,0,0),He[Oe.NEGBINOM_DIST]=Y(4,[1,1,1,4],[],1,0,0),He[Oe.NORM_S_DIST]=Y(2,[1,4],[],1,0,0),He[Oe.NORM_S_INV]=Y(1,[1],[],1,0,0),He[Oe.T_TEST]=Y(4,[32,32,1,1],[],1,0,0),He[Oe.Z_TEST]=Y(2,[49,1,1],[],1,0,0),He[Oe.ERF_PRECISE]=Y(1,[95],[],9,0,0),He[Oe.ERFC_PRECISE]=Y(1,[95],[],9,0,0),He[Oe.GAMMALN_PRECISE]=Y(1,[1],[],1,0,0),He[Oe.CEILING_PRECISE]=Y(1,[1,65],[],1,0,0),He[Oe.FLOOR_PRECISE]=Y(1,[1,65],[],1,0,0),He[Oe.ACOT]=Y(1,[1],[],1,0,0),He[Oe.ACOTH]=Y(1,[1],[],1,0,0),He[Oe.COT]=Y(1,[1],[],1,0,0),He[Oe.COTH]=Y(1,[1],[],1,0,0),He[Oe.CSC]=Y(1,[1],[],1,0,0),He[Oe.CSCH]=Y(1,[1],[],1,0,0),He[Oe.SEC]=Y(1,[1],[],1,0,0),He[Oe.SECH]=Y(1,[1],[],1,0,0),He[Oe.IMTAN]=Y(1,[95],[],9,0,0),He[Oe.IMCOT]=Y(1,[95],[],9,0,0),He[Oe.IMCSC]=Y(1,[95],[],9,0,0),He[Oe.IMCSCH]=Y(1,[95],[],9,0,0),He[Oe.IMSEC]=Y(1,[95],[],9,0,0),He[Oe.IMSECH]=Y(1,[95],[],9,0,0),He[Oe.BITAND]=Y(2,[1,1],[],1,0,0),He[Oe.BITOR]=Y(2,[1,1],[],1,0,0),He[Oe.BITXOR]=Y(2,[1,1],[],1,0,0),He[Oe.BITLSHIFT]=Y(2,[1,1],[],1,0,0),He[Oe.BITRSHIFT]=Y(2,[1,1],[],1,0,0),He[Oe.PERMUTATIONA]=Y(2,[1,1],[],1,0,0),He[Oe.COMBINA]=Y(2,[1,1],[],1,0,0),He[Oe.XOR]=Y(1,[],[52],4,0,0),He[Oe.PDURATION]=Y(3,[1,1,1],[],1,0,0),He[Oe.BASE]=Y(2,[1,1,65],[],2,0,0),He[Oe.DECIMAL]=Y(2,[2,1],[],1,0,0),He[Oe.DAYS]=Y(2,[3,3],[],1,0,0),He[Oe.BINOM_DIST_RANGE]=Y(3,[1,1,1,65],[],1,0,0),He[Oe.GAMMA]=Y(1,[1],[],1,0,0),He[Oe.SKEW_P]=Y(1,[],[49],1,0,0),He[Oe.GAUSS]=Y(1,[1],[],1,0,0),He[Oe.PHI]=Y(1,[1],[],1,0,0),He[Oe.RRI]=Y(3,[1,1,1],[],1,0,0),He[Oe.UNICHAR]=Y(1,[1],[],2,0,0),He[Oe.UNICODE]=Y(1,[2],[],1,0,0),He[Oe.MUNIT]=Y(1,[1],[],32,0,0),He[Oe.ARABIC]=Y(1,[2],[],1,0,0),He[Oe.ISOWEEKNUM]=Y(1,[1],[],1,0,0),He[Oe.NUMBERVALUE]=Y(1,[2,66,66],[],1,0,0),He[Oe.SHEET]=Y(0,[50],[],1,4095,0),He[Oe.SHEETS]=Y(0,[48],[],1,4095,0),He[Oe.FORMULATEXT]=Y(1,[16],[],2,4095,0),He[Oe.ISFORMULA]=Y(1,[16],[],4,0,0),He[Oe.IFNA]=Y(2,[47,575],[],47,0,0),He[Oe.CEILING_MATH]=Y(1,[1,65,65],[],1,0,0),He[Oe.FLOOR_MATH]=Y(1,[1,65,65],[],1,0,0),He[Oe.IMSINH]=Y(1,[95],[],9,0,0),He[Oe.IMCOSH]=Y(1,[95],[],9,0,0),He[Oe.FILTERXML]=Y(2,[2,2],[],47,0,0),He[Oe.WEBSERVICE]=Y(1,[2],[],10,0,0),He[Oe.ENCODEURL]=Y(1,[2],[],10,0,0),He[Oe.FORECAST_ETS]=Y(3,[1,48,48,65,65,65],[],1,0,0),He[Oe.FORECAST_ETS_CONFINT]=Y(3,[1,48,48,65,65,65,65],[],1,0,0),He[Oe.FORECAST_ETS_SEASONALITY]=Y(2,[48,48,65,65],[],1,0,0),He[Oe.FORECAST_LINEAR]=Y(3,[1,32,32],[],1,0,0),He[Oe.FORECAST_ETS_STAT]=Y(3,[48,48,1,65,65,65],[],1,0,0),He[Oe.MAXIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.MINIFS]=Y(3,[16],[16,15],1,0,0),He[Oe.TEXTJOIN]=Y(3,[114,68],[114],2,0,0),He[Oe.CONCAT]=Y(1,[],[114],2,0,0),He[Oe.IFS]=Y(2,[],[44,575],575,0,0),He[Oe.SWITCH]=Y(3,[47,575],[575,575],575,0,0),He[Oe.SINGLE]=Y(1,[1079,4],[],1055,0,1),He[Oe.AVERAGE_WEIGHTED]=Y(2,[],[113,113],1,0,1),He[Oe.ANCHORARRAY]=Y(1,[16],[],48,0,1),He[Oe.IMAGE]=Y(1,[2],[],2,0,1),He[Oe.RECORD]=Y(2,[],[2,303],256,0,1),He[Oe.RECORDTEST]=Y(3,[15],[2,47],256,0,1),He[Oe.GRF]=Y(1,[15,2],[],15,0,1),He[Oe.UNIT]=Y(2,[15,2],[],15,0,1),He[Oe.RICHERROR]=Y(1,[1],[],10,0,1),He[Oe.FILTER]=Y(2,[48,48],[],32,0,1),He[Oe.FUN]=Y(1,[],[63],63,0,1),He[Oe.LET]=Y(3,[63,63,63],[],63,0,1),He[Oe.ARRAYMAKE]=Y(3,[1,1,63],[],32,0,1),He[Oe.APPLY]=Y(1,[],[63],63,0,1),He[Oe.ISFUN]=Y(1,[63],[],4,0,1),He[Oe.ARITY]=Y(1,[63],[],9,0,1),He[Oe.RECURSE]=Y(0,[],[],63,0,1),He[Oe.FIELDVALUE]=Y(2,[263,2],[],295,0,1);var Ke,je=Y(0,[],[G.All],G.All,x.All,B.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot",e[e.At=25]="At",e[e.Pound=26]="Pound"}(Ke||(Ke={}));var Je=P.Number|P.String|P.Boolean,qe=P.Number|P.String|P.Boolean|P.Blank,Ye=Y(2,[P.Number,P.Number],[],P.Number,x.None,B.None),Xe=Y(1,[P.Number],[],P.Number,x.None,B.None),Qe=Y(1,[Je],[],Je,x.None,B.None),ze=Y(2,[P.String,P.String],[],P.String,x.None,B.None),Ze=Y(2,[qe,qe],[],P.Boolean,x.None,B.None),$e=Y(2,[P.Range,P.Range],[],P.Range,x.AllCells,B.None),er=Y(2,[P.Range,P.Range],[],P.Range,x.None,B.None),rr=Y(2,[P.Boolean,P.Boolean],[],P.Boolean,x.None,B.None),tr=[];function nr(e){var r=tr[e];return null!=r?r:je}function ar(e){var r=He[e];return null!=r?r:je}function or(e,r){var t=He[e];null!=t&&(t.staticPrecs=r)}function ir(e,r){return{wrap:e,unwrap:r}}function ur(e){return e}function cr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function sr(e){var r=cr();for(var t in e)r[t]=e[t];return r}function lr(e){return null!=e}function fr(e){return null==e}function dr(e,r){return lr(e)?e:r}function hr(e,r){return[e,r]}function pr(e,r){return e<r?e:r}function vr(e,r){return e<r?r:e}function gr(e){return e<0?-e:e}function mr(e,r){return e===r?0:e.toLocaleUpperCase().localeCompare(r.toLocaleUpperCase())}function Er(e,r){return 0===mr(e,r)}tr[Ke.Add]=Ye,tr[Ke.Sub]=Ye,tr[Ke.Mul]=Ye,tr[Ke.Div]=Ye,tr[Ke.Pow]=Ye,tr[Ke.Percent]=Xe,tr[Ke.Neg]=Xe,tr[Ke.At]=Xe,tr[Ke.Pound]=Xe,tr[Ke.Pos]=Qe,tr[Ke.Concat]=ze,tr[Ke.Eq]=Ze,tr[Ke.Ne]=Ze,tr[Ke.Lt]=Ze,tr[Ke.Le]=Ze,tr[Ke.Gt]=Ze,tr[Ke.Ge]=Ze,tr[Ke.Range]=$e,tr[Ke.Isect]=er,tr[Ke.Union]=er,tr[Ke.And]=rr,tr[Ke.Or]=rr,tr[Ke.Xor]=rr,tr[Ke.Min]=Ye,tr[Ke.Max]=Ye,or(Oe.ROW,x.OwnRow),or(Oe.COLUMN,x.OwnCol),or(Oe.SHEET,x.OwnDocSheets),or(Oe.SHEETS,x.OwnDocSheets),or(Oe.OFFSET,x.AllCells),or(Oe.INDIRECT,x.AllCells),or(Oe.SUMIF,x.AllCells),or(Oe.NOW,x.Time),or(Oe.TODAY,x.Time),or(Oe.RAND,x.Calc),or(Oe.RANDBETWEEN,x.Calc),or(Oe.SUBTOTAL,x.CellProps),or(Oe.CELL,x.CellProps|x.AllCells),or(Oe.INFO,x.Calc),or(Oe.FORMULATEXT,x.None);var Sr="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};function Tr(e){return 1===e.length}function Cr(e){return e.isWellFormed}function Rr(e){return 1===e.rows&&1===e.cols}function Ir(e){return Tr(e.sheet)}function yr(e){return Rr(e.range)}function Ar(e,r){if(Rr(e))return r(e,0,0);for(var t=e.row,n=e.rows,a=e.col,o=e.cols,i=0;i<n;i+=1)for(var u=0;u<o;u+=1)if(!r(w(t+i,a+u),i,u))return!1;return!0}function Nr(e,r){return e===r||Er(e.name,r.name)&&(null==e.path&&null==r.path||null!=e.path&&null!=r.path&&Er(e.path,r.path))}function Or(e,r){return Nr(e.document,r.document)&&e.index===r.index}function kr(e,r){return e.row===r.row&&e.col===r.col}function Lr(e,r){return Or(e.sheet,r.sheet)&&kr(e.range,r.range)}function Dr(e){return Rr(e)?e:M(e.row,e.col,1,1)}function _r(e){return yr(e)?e:j(e.sheet,Dr(e.range))}function Fr(e,r){var t=e.row,n=e.col,a=r.row,o=r.col;return M(Math.min(t,a),Math.min(n,o),Math.abs(a-t)+1,Math.abs(o-n)+1)}function Mr(e,r){function t(t){var n=e.spans[t.label];return void 0!==n&&n.start<=r&&r<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case he.Array:for(var o=n.nodes,i=o.length-1;!a&&i>=0;i-=1)for(var u=o[i],c=u.length-1;!a&&c>=0;c-=1){t(l=u[c])&&(n=l,a=!0)}break;case he.App:var s=n.args;for(c=s.length-1;!a&&c>=0;c-=1){t(l=s[c])&&(n=l,a=!0)}break;case he.Paren:var l;t(l=n.node)&&(n=l,a=!0);break;case he.Bad:case he.Name:case he.CellRef:case he.Literal:break;default:I("getSubExpressionFromPosition",n)}return n}function br(e,r){var t=-1,n=document.elementFromPoint(e,r);if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,r))&&(t=a.offset);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,r))&&(t=a.startOffset)}else try{var a;(a=document.body.createTextRange()).moveToPoint(e,r);var o=document.body.createTextRange();o.moveToElementText(n),o.setEndPoint("EndToStart",a),t=o.text.length}catch(e){return t}for(;null!=n&&"SPAN"===n.nodeName;)null!=(n=n.previousSibling)&&null!=n.textContent&&(t+=n.textContent.length);return t}var wr,Ur,Pr=[];function Gr(e){return 0===function(e){if(1===e.args.length){var r=e.args[0];if(r.kind===he.Literal&&Vr(r.oper)===P.Missing)return 0}return e.args.length}(e)?Pr:e.args}function xr(e,r){A("calc.runtime.getArgType",r);var t=e.headTypes,n=t.length;if(r<n)return t[r];var a=e.restTypes,o=a.length;return o>0?a[(r-n)%o]:G.None}function Br(e,r){return!(r<e.minArgs)&&(r<=e.headTypes.length||e.restTypes.length>0)}function Vr(e){switch(typeof e){case"number":return P.Number;case"string":return P.String;case"boolean":return P.Boolean;default:return e.kind}}function Wr(e){return"number"==typeof e&&isFinite(e)}function Hr(e){return{kind:wr.Success,value:e}}function Kr(e){return{kind:wr.Failure,reason:e}}function jr(e){return null!=e&&e.kind===wr.Success}function Jr(e){return{kind:Ur.NotImplemented,features:e}}function qr(e){return 0===e.length&&y("calc.lang.unavailable: expected nonempty array"),{kind:Ur.Unavailable,objects:e}}!function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(wr||(wr={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(Ur||(Ur={}));var Yr=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function Xr(e){if(null!=e){var r=e.path,t=e.name;return null!=r&&"string"!=typeof r?(C.ULS.traceTag(595969803,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Illegal document path: type is "+typeof r),k):"string"!=typeof t?(C.ULS.traceTag(595969804,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Illegal document name: type is "+typeof t),k):e}}(Yr.prototype=Object.create(Error.prototype)).constructor=Yr;var Qr=65;function zr(e){for(var r=e+1,t="";r>0;){var n=(r-1)%26;t=String.fromCharCode(Qr+n)+t,r=Math.floor((r-n)/26)}return t}function Zr(e,r,t){var n=t.kind,a=t.index;return n===de.Abs?r+e.formatNumber(a+1):0===a?r:r+e.leftBracket+e.formatNumber(a)+e.rightBracket}function $r(e,r,t,n){if(r===se.A1){if(null==t){return C.ULS.assertTag(595935437,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(e,r,t){var n=t.kind===de.Abs,a=e.formatNumber(t.index+(n?0:r)+1);return n?"$"+a:a}(e,t,n)}return Zr(e,e.rowLetter,n)}function et(e,r,t,n){if(r===se.A1){if(null==t){return C.ULS.assertTag(595935438,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(e,r){var t=r.kind===de.Abs,n=zr(r.index+(t?0:e));return t?"$"+n:n}(t,n)}return Zr(e,e.columnLetter,n)}function rt(e){return function(r,t,n,a,o){var i=e(r,t,n,a);return t===se.R1C1&&a.kind===o.kind&&a.index===o.index?i:i+":"+e(r,t,n,o)}}var tt=rt($r),nt=rt(et);function at(e,r,t,n,a){var o=$r(e,r,null!=t?t.row:void 0,n),i=et(e,r,null!=t?t.col:void 0,a);return r===se.A1?i+o:o+i}var ot,it=t(1),ut={ULS:new l.NulLogger},ct=Object(l.initStopwatchFactory)((function(e){return ut.ULS.traceTag(595948114,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,e)}));function st(e,r){return it.__awaiter(this,void 0,void 0,(function(){var t;return it.__generator(this,(function(n){switch(n.label){case 0:t=ct(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r()];case 2:return[2,n.sent()];case 3:return t.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcHashSet="CalcHashSet",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch",e.CalcDynamicArrayOperators="CalcDynamicArrayOperators"}(ot||(ot={}));var lt=function(e){return!1},ft={};function dt(e){return void 0===ft[e]&&(ft[e]=lt(e)),ft[e]}var ht=100;function pt(e,r,t){return void 0===t&&(t=ht),r.maxDepth=t,r.level=0,vt(e,r)}function vt(e,r){if(r.level===r.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+r.level;var t;switch(r.level+=1,e.kind){case he.Literal:t=function(e,r){if("boolean"==typeof e)return r.visitBoolean(e);if("number"==typeof e)return r.visitNumber(e);if("string"==typeof e)return r.visitString(e);if(e.kind===P.Missing)return r.visitMissing(e);if(e.kind===P.Error)switch(e.type){case V.NULL:return r.visitNullError(e);case V.DIV0:return r.visitDiv0Error(e);case V.VALUE:return r.visitValueError(e);case V.REF:return r.visitRefError(e);case V.NAME:return r.visitNameError(e);case V.NUM:return r.visitNumError(e);case V.NA:return r.visitNAError(e);case V.GETTING_DATA:return r.visitDataError(e);case V.FIELD:return r.visitFieldError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,r.operVisitor);break;case he.Array:t=r.visitArray(e);break;case he.App:t=r.visitApp(e);break;case he.Paren:t=r.visitParen(e);break;case he.Name:t=r.visitName(e);break;case he.CellRef:t=r.visitCellRef(e);break;case he.Bad:t=r.visitBad(e);break;case he.Operator:t=r.visitOperator(e);break;case fe.Error:t=r.visitRefError(e);break;case fe.Single:t=r.visitSingle(e);break;case fe.Range:t=r.visitRange(e);break;case fe.Row:t=r.visitRow(e);break;case fe.Col:t=r.visitCol(e);break;case le.Error:t=r.visitNameError(e);break;case le.Relative:t=r.visitRelative(e);break;case le.Document:t=r.visitDocument(e);break;case le.Sheet:t=r.visitSheet(e);break;case le.Ident:t=r.visitIdent(e);break;case le.SheetRange:t=r.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return r.level-=1,t}function gt(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e,visitFieldError:e}}function mt(e,r,t){return{level:0,operVisitor:e,visitArray:dr(t.vArray,r),visitApp:dr(t.vApp,r),visitParen:dr(t.vParen,r),visitName:dr(t.vName,r),visitCellRef:dr(t.vCellRef,r),visitBad:dr(t.vBad,r),visitOperator:dr(t.vOperator,r),visitRefError:dr(t.vRefError,r),visitSingle:dr(t.vSingle,r),visitRange:dr(t.vRange,r),visitRow:dr(t.vRow,r),visitCol:dr(t.vCol,r),visitNameError:dr(t.vNameError,r),visitRelative:dr(t.vRelative,r),visitDocument:dr(t.vDocument,r),visitSheet:dr(t.vSheet,r),visitIdent:dr(t.vIdent,r),visitSheetRange:dr(t.vSheetRange,r)}}var Et,St=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",",","","","","","","","@","#"],Tt={localeInfo:void 0,range:void 0,refStyle:se.A1,source:m.Cell,level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"},visitFieldError:function(e){return"#FIELD"}},visitArray:function(e){var r=[];return e.nodes.forEach((function(e){var t=[];e.forEach((function(e){t.push(vt(e,Tt))})),r.push(t.join(","))})),"{"+r.join(";")+"}"},visitApp:function(e){var r=[];e.args.forEach((function(e){r.push(vt(e,Tt))}));var t=vt(e.head,Tt);if(e.head.kind===he.Operator){if(e.head.id===Ke.Percent)return r[0]+"%";if(e.head.id===Ke.Pound)return r[0]+"#";if(1===r.length)return t+r[0];if(2===r.length)return r[0]+t+r[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return t+"("+r.join(",")+")"},visitParen:function(e){return"("+vt(e.node,Tt)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var r="";return void 0!==e.qualifier&&(r=vt(e.qualifier,this)+"!"),r+vt(e.ref,this)},visitBad:function(e){if(e.type===pe.Sequence){var r=[];return e.contents.forEach((function(e){r.push(vt(e,Tt))})),r.join("")}return e.contents},visitOperator:function(e){return St[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){var r=void 0===this.range?void 0:this.range.range;return at(this.localeInfo,this.refStyle,r,e.row,e.col)},visitRange:function(e){return vt(e.ref1,Tt)+":"+vt(e.ref2,Tt)},visitRow:function(e){var r=void 0===this.range?void 0:this.range.range.row;return $r(this.localeInfo,this.refStyle,r,e.row1)+":"+$r(this.localeInfo,this.refStyle,r,e.row2)},visitCol:function(e){var r=void 0===this.range?void 0:this.range.range.col;return et(this.localeInfo,this.refStyle,r,e.col1)+":"+et(this.localeInfo,this.refStyle,r,e.col2)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?vt(e.document,Tt):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function Ct(e){return{kind:Et.VisitorFailure,message:e}}function Rt(){return{kind:Et.NoLocaleInfo}}function It(e,r,t,n,a){void 0===n&&(n=se.A1),void 0===a&&(a=m.Cell);try{return void 0===t&&n===se.A1?Kr(Rt()):(Tt.localeInfo=r,Tt.range=t,Tt.refStyle=n,Tt.source=a,Hr("="+pt(e,Tt)))}catch(e){if(C.ULS.traceTag(595964180,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Format failed: "+e),Tt.level=0,"string"==typeof e)return Kr(Ct(e));throw e}}!function(e){e.NoLocaleInfo="NoLocaleInfo",e.VisitorFailure="VisitorFailure"}(Et||(Et={}));var yt,At=K(F(L(void 0,"Book1"),0),b(0,0,1,1));function Nt(e,r){var t=It(r,e,At);if(t.kind===wr.Success){return t.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp("[^[object Object][object Object][object Object]d]","g"),"w")}}function Ot(e,r){return Nt(e,r.node)}function kt(e){return T.FormulaNode=d(e,Nt),T.Formula=d(e,Ot),{localeInfo:e}}var Lt=!1,Dt=void 0;function _t(e,r,t){if(Lt){var n="calc.config.initCalc: Calc is already initialized";C.ULS.traceTag(595910878,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,n)}else{var a;if(R(e),function(e){ut.ULS=e}(e),"function"==typeof(a=r)&&(lt=a),null!=t&&!/(^https:\/\/)|(^http:\/\/)/.test(t)){n="calc.config.initCalc: calcAbsUrl is not absolute: "+t;C.ULS.traceTag(595910879,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,n)}Dt=t,Lt=!0}}function Ft(){return Lt}function Mt(){return Dt}function bt(e,r,t,n,a,o,i,u,c,s,l,f,d,h,p,v,g,m,E,S,T,C){return{parseNumber:e,formatNumber:r,getWorksheetFuncId:t,getWorksheetFuncName:n,isNumeral:a,getOrdinal:o,getNumeral:i,isLetter:u,stringCompareCI:c,errorNames:s,trueName:l,falseName:f,rowLetter:d,columnLetter:h,leftBrace:p,rightBrace:v,leftBracket:g,rightBracket:m,decimalSeparator:E,listSeparator:S,columnSeparator:T,rowSeparator:C}}function wt(e){return Number(e)}function Ut(e){return String(e)}function Pt(e){return e>="0"&&e<="9"}function Gt(e){return Pt(e)||y("calc.config.getOrdinal: expected numeral; given "+g(e)),e.charCodeAt(0)-"0".charCodeAt(0)}function xt(e){return O("calc.config.getNumeral",e,10),String(e)}function Bt(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}var Vt=[void 0,"#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#GETTING_DATA","#FIELD"],Wt=((yt={})[Oe.ARRAYMAKE]="ARRAY.MAKE",yt),Ht=void 0;function Kt(){if(null==Ht)for(var e in Ht=[],Oe){var r=Number(e);if(!isNaN(r)){var t=Wt[r],n=null!=t?t:Oe[e].replace("_",".");Ht[r]=n}}return Ht}function jt(e){var r=function(e){var r={};return e.forEach((function(e,t){null!=e&&(r[e.toLocaleUpperCase()]=t)})),r}(e);return{getWorksheetFuncId:function(e){return r[e.toLocaleUpperCase()]},getWorksheetFuncName:function(r){var t=e[r];return null==t?y("calc.config.getWorksheetFuncName: unknown function ID "+r):t}}}function Jt(){var e=jt(Kt());return bt(wt,Ut,e.getWorksheetFuncId,e.getWorksheetFuncName,Pt,Gt,xt,Bt,mr,Vt,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")}var qt,Yt,Xt,Qt,zt,Zt,$t,en,rn,tn,nn,an,on=fe,un=de,cn=le,sn=Ce,ln=w,fn=F,dn=_,hn=H,pn=J,vn=q,gn=Fr,mn=jr,En=Ur,Sn=Jr;function Tn(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case En.NotImplemented:case En.Unavailable:return!0}return!1}function Cn(e,r,t){return function(n,a){return void 0===a?r(n):Tn(a)?t(a,n):e(a)}}function Rn(e,r){return function(t){if(Array.isArray(t)){for(var n=void 0,a=0;a<t.length;a+=1){var o=t[a];if(void 0!==(n=e(o)))return[o,n]}return r}var i=e(t);return void 0===i?r:[t,i]}}function In(e,r){return r.kind===un.Abs?r.index:e+r.index}function yn(e,r){var t=In(e.row,r.row),n=In(e.col,r.col);return ln(t,n)}function An(e,r){switch(r.kind){case on.Error:return;case on.Single:var t=yn(e,r);return ln(t.row,t.col);case on.Range:var n=yn(e,r.ref1),a=yn(e,r.ref2);return gn(n,a);case on.Row:return Sn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case on.Col:return Sn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return I("calc.runtime.resolverService.resolveGridRef",r)}}function Nn(e){function r(r){var t=e.getDocumentLoc(r.path,r.document);return lr(t)?t:void 0}function t(t,n){var a=lr(n.document)?r(n.document):t;if(!fr(a)){var o=e.getSheetIndex(a,n.sheet);return mn(o)?lr(o.value)?fn(a,o.value):void 0:o.reason}}return{resolveName:function(n,a,o){if(fr(a)||a.kind===cn.Relative)return[vn(n.sheet,o),vn(pn(n.sheet.document),o)];var i=function(n,a){switch(a.kind){case cn.Document:var o=r(a);return lr(o)?pn(o):o;case cn.Sheet:return t(n.sheet.document,a);case cn.Ident:var i=n.sheet.document,u=e.getSheetIndex(i,a.name);if(mn(u)){if(lr(u.value))return fn(i,u.value);var c=r(sn(a.name));return lr(c)?pn(c):void 0}return u.reason;default:return I("calc.runtime.resolverService.resolveNameQualifier",a)}}(n,a);return Tn(i)?i:vn(i,o)},resolveGridRef:An,resolveCellRef:function(r,n,a){var o=An(r.range,a);if(Tn(o))return o;var i=fr(n)?r.sheet:function(r,n){switch(n.kind){case cn.Error:return;case cn.Sheet:return t(r.document,n);case cn.SheetRange:var a=r.document,o=e.getSheetIndex(a,n.sheet1);if(!mn(o))return o.reason;var i=e.getSheetIndex(a,n.sheet2);if(!mn(i))return i.reason;var u=o.value,c=i.value;if(fr(u)||fr(c))return;return u===c?fn(a,u):dn(a,Math.min(u,c),Math.abs(c-u)+1);case cn.Relative:return r;default:return I("calc.runtime.resolverService.resolveCellRefQualifier",n)}}(r.sheet,n);return Tn(i)?i:hn(i,o)}}}(Yt=qt||(qt={})).FormulaSource=m,Yt.documentLoc=L,Yt.sheetIndex=F,Yt.sheetRange=_,Yt.gridCell=w,Yt.gridRange=b,Yt.sheetGridCell=j,Yt.sheetGridRange=K,Yt.sheetGridCube=H,Yt.documentScope=J,Yt.nameLoc=q,(Qt=Xt||(Xt={})).SpecialPrecs=x,Qt.OperKind=P,Qt.ErrorType=V,Qt.ErrorTypeBounds=W,Qt.precedents=X,Qt.errorOper=Q,Qt.nullErrorOper=z,Qt.div0ErrorOper=Z,Qt.valueErrorOper=$,Qt.refErrorOper=ee,Qt.nameErrorOper=re,Qt.numErrorOper=te,Qt.naErrorOper=ne,Qt.gettingDataErrorOper=ae,Qt.fieldErrorOper=oe,Qt.arrayOper=ie,Qt.rangeSeqOper=ue,Qt.range3DOper=ce,Qt.missingOper=ve,Qt.blankOper=ge,(Zt=zt||(zt={})).RefStyle=se,Zt.QualifierKind=le,Zt.CellRefKind=fe,Zt.PosKind=de,Zt.NodeKind=he,Zt.BadType=pe,Zt.errorQualifierLabeled=me,Zt.relativeQualifierLabeled=Ee,Zt.errorQualifier=Se,Zt.relativeQualifier=Te,Zt.documentQualifier=Ce,Zt.sheetQualifier=Re,Zt.identQualifier=Ie,Zt.sheetRangeQualifier=ye,Zt.pos=Ae,Zt.cellRefErrorLabeled=Ne,Zt.cellRefError=ke,Zt.cellRefSingle=Le,Zt.cellRefRange=De,Zt.cellRefRow=_e,Zt.cellRefCol=Fe,Zt.formula=Me,Zt.formulaSpan=be,Zt.literalNode=we,Zt.arrayNode=Ue,Zt.appNode=Pe,Zt.operatorNode=Ge,Zt.parenNode=xe,Zt.nameNode=Be,Zt.cellRefNode=Ve,Zt.badNode=We,(en=$t||($t={})).SignatureType=G,en.FunctionFlags=B,en.OperatorId=Ke,en.WorksheetFuncId=Oe,en.SpecialPrecs=x,en.functionType=Y,en.unknownFunctionType=je,en.getOperatorType=nr,en.getWorksheetFuncType=ar,(tn=rn||(rn={})).isSheetIndex=Tr,tn.isSheetGridRange=Ir,tn.isGridCell=Rr,tn.isSheetGridCell=yr,tn.isDocumentLocEqual=Nr,tn.isSheetIndexEqual=Or,tn.isGridCellEqual=kr,tn.isSheetGridCellEqual=Lr,tn.gridRangeAnchor=Dr,tn.sheetGridRangeAnchor=_r,tn.gridCellRange=Fr,tn.getArguments=Gr,tn.getArgType=xr,tn.isValidArgsLength=Br,tn.operKind=Vr,tn.ResultKind=wr,tn.success=Hr,tn.failure=Kr,tn.FailureError=Yr,tn.isSuccess=jr,tn.ReasonKind=Ur,tn.notImplemented=Jr,tn.unavailable=qr,tn.columnName=zr,tn.formatRow=$r,tn.formatCol=et,tn.formatRowRange=tt,tn.formatColRange=nt,tn.formatCellPos=at,tn.getSubExpressionFromPosition=Mr,tn.getFormulaCharIndexFromPoint=br,tn.createResolver=Nn,tn.createResolutionHandler=Cn,tn.createNameFinder=Rn,tn.defaultLiteralVisitor=gt,tn.defaultFormulaVisitor=mt,tn.dispatch=vt,tn.startVisit=pt,tn.prettyPrinter=It,tn.visitorFailure=Ct,tn.noLocaleInfo=Rt,(an=nn||(nn={})).localeInfo=bt,an.calcConfig=kt,an.initCalc=_t,an.createSimpleLocaleInfo=Jt,an.isCalcInit=Ft,an.getCalcAbsUrl=Mt;var On,kn=rn.ReasonKind,Ln=rn.notImplemented;function Dn(e){return{config:e}}!function(e){e.BadFormulaString="BadFormulaString"}(On||(On={}));var _n=it.__assign({},kn,On);function Fn(e){return{kind:_n.BadFormulaString,message:e}}var Mn=" \t\n\r";function bn(e){return Mn.indexOf(e)>=0}function wn(e,r){return"\\"===r||"_"===r||e.isLetter(r)}function Un(e,r){return"."===r||wn(e,r)||e.isNumeral(r)}function Pn(e,r){var t=r-1;return function(r){if(r<=t){var n=e+": internal error: no progress made at index "+r;return C.ULS.assertTag(595980821,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}t=r}}function Gn(e,r,t){for(var n=r;n<e.length&&t(e[n]);n+=1);return[e.substring(r,n),n]}function xn(e,r,t,n,a){var o=e[r];return t(o)?1:o===n&&a(e[r+1])?2:0}function Bn(e,r,t,n,a){for(var o=[],i=r,u=r;u<e.length;){var c=xn(e,u,t,n,a);if(0===c)break;2===c&&(i!==u&&o.push(e.substring(i,u)),i=u+1),u+=c}return i!==u&&o.push(e.substring(i,u)),[o.join(""),u]}var Vn,Wn,Hn,Kn,jn=Xt.nullErrorOper,Jn=Xt.div0ErrorOper,qn=Xt.valueErrorOper,Yn=Xt.refErrorOper,Xn=Xt.nameErrorOper,Qn=Xt.numErrorOper,zn=Xt.naErrorOper,Zn=Xt.gettingDataErrorOper,$n=Xt.fieldErrorOper,ea=$t.OperatorId;function ra(e,r,t){return{kind:e,start:r,chars:t}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(Vn||(Vn={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Wn||(Wn={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(Hn||(Hn={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Kn||(Kn={}));var ta=function(e){return ra(Vn.End,e,"")},na=function(e,r){return ra(Vn.Spaces,e,r)},aa=function(e,r){return ra(Vn.Unexpected,e,r)},oa=function(e,r){return ra(Vn.Ident,e,r)};function ia(e,r,t,n){return{kind:e,start:r,chars:t,value:n}}var ua=function(e){return ia(Vn.Left,e,"(",Wn.Paren)},ca=function(e,r){return ia(Vn.Left,e,r,Wn.Bracket)},sa=function(e,r){return ia(Vn.Left,e,r,Wn.Brace)},la=function(e){return ia(Vn.Left,e,"'",Wn.SQuote)},fa=function(e){return ia(Vn.Right,e,")",Wn.Paren)},da=function(e,r){return ia(Vn.Right,e,r,Wn.Bracket)},ha=function(e,r){return ia(Vn.Right,e,r,Wn.Brace)},pa=function(e){return ia(Vn.Right,e,"'",Wn.SQuote)},va=function(e,r){return ia(Vn.Sep,e,r,Hn.List)},ga=function(e,r){return ia(Vn.Sep,e,r,Hn.Col)},ma=function(e,r){return ia(Vn.Sep,e,r,Hn.Row)},Ea=function(e){return ia(Vn.Sep,e,"!",Hn.Qual)},Sa={"#ALL":function(e,r){return ia(Vn.SpecialRef,e,r,Kn.All)},"#DATA":function(e,r){return ia(Vn.SpecialRef,e,r,Kn.Data)},"#HEADERS":function(e,r){return ia(Vn.SpecialRef,e,r,Kn.Headers)},"#TOTALS":function(e,r){return ia(Vn.SpecialRef,e,r,Kn.Totals)},"#THIS ROW":function(e,r){return ia(Vn.SpecialRef,e,r,Kn.ThisRow)}};function Ta(e,r,t,n,a,o,i,u){return{kind:Vn.CellRef,start:e,chars:r,row:t,col:n,refStyle:a,isName:o,isNumber:i,isQualPart:u}}function Ca(e,r,t,n){void 0===n&&(n=!0);var a="number"==typeof t&&function(e){for(var r=0;r<e.length;r+=1)if("+"===e[r]||"-"===e[r])return!1;return!0}(r);return{kind:Vn.Literal,start:e,chars:r,oper:t,hasRight:n,isQualPart:a}}var Ra=[function(e,r){throw new Error("errorToken[0]: no error type 0")},function(e,r){return Ca(e,r,jn)},function(e,r){return Ca(e,r,Jn)},function(e,r){return Ca(e,r,qn)},function(e,r){return Ca(e,r,Yn)},function(e,r){return Ca(e,r,Xn)},function(e,r){return Ca(e,r,Qn)},function(e,r){return Ca(e,r,zn)},function(e,r){return Ca(e,r,Zn)},function(e,r){return Ca(e,r,$n)}];function Ia(e,r,t){return 0===e.stringCompareCI(e.falseName,t)?Ca(r,t,!1):0===e.stringCompareCI(e.trueName,t)?Ca(r,t,!0):oa(r,t)}var ya=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,".","@","#"];function Aa(e){var r=ya[e];if(null==r)throw new Error("operatorTokenMaker: invalid operator "+e);return function(t){return{kind:Vn.Operator,start:t,chars:r,value:e}}}var Na=Aa(ea.Add),Oa=Aa(ea.Sub),ka=Aa(ea.Mul),La=Aa(ea.Div),Da=Aa(ea.Pow),_a=Aa(ea.Percent),Fa=Aa(ea.Concat),Ma=Aa(ea.Eq),ba=Aa(ea.Lt),wa=Aa(ea.Gt),Ua=Aa(ea.Ne),Pa=Aa(ea.Le),Ga=Aa(ea.Ge),xa=Aa(ea.Range),Ba=(Aa(ea.And),Aa(ea.Or),Aa(ea.Xor),Aa(ea.Dot),Aa(ea.At)),Va=Aa(ea.Pound);function Wa(e,r,t){return t.push(r),r.start+e}var Ha=zt.PosKind,Ka=zt.pos,ja=zt.RefStyle;function Ja(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function qa(e){return e.toUpperCase().charCodeAt(0)-65+1}function Ya(e,r,t,n){for(var a=0,o=n,i=Math.min(t.length,n+r);o<i;o+=1){var u=t[o];if(!e.isNumeral(u))break;a=10*a+e.getOrdinal(u)}return o===i&&e.isNumeral(t[o])?[0,n]:[a,o]}function Xa(e,r,t){return function(n,a,o,i){var u=function(e,r){return"$"===e[r]?[Ha.Abs,r+1]:[Ha.Rel,r]}(o,i),c=u[0],s=u[1],l=e(n,t,o,s),f=l[0],d=l[1];if(d>s){if(f<1||f>r)return;var h=c===Ha.Rel?f-a:f;return[Ka(c,h-1),!1,d]}return[void 0,!1,i]}}function Qa(e,r,t){return function(n,a,o,i){var u=e?n.rowLetter:n.columnLetter;if(i>=o.length||0!==n.stringCompareCI(u,o[i]))return[void 0,!1,i];var c=i+1,s=Ya(n,t,o,c),l=s[0],f=s[1];if(f>c){if(l<1||l>r)return;return[Ka(Ha.Abs,l-1),!1,f]}if(o[c]===n.leftBracket){var d=1;"+"===o[c+=1]?c+=1:"-"===o[c]&&(d=-1,c+=1);var h=Ya(n,t,o,c),p=h[0],v=h[1];if(v>c&&p<r&&o[v]===n.rightBracket)return[Ka(Ha.Rel,p*d),!0,v+1]}return[!1,!1,f]}}function za(e,r,t,n,a,o,i){var u=n(e,r,o,i);if(null==u)return[void 0,void 0,!1,i];var c=u[0],s=u[1],l=u[2];if(l>i){var f=a(e,t,o,l);if(null==f)return s?[c,void 0,!0,l]:[void 0,void 0,!1,i];var d=f[0],h=f[1],p=f[2];return p>l?[c,d,h,p]:[c,void 0,s,l]}var v=a(e,t,o,i);if(null==v)return[void 0,void 0,!1,i];var g=v[0],m=v[1],E=v[2];return E>i?[void 0,g,m,E]:[void 0,void 0,!1,i]}var Za=Xa(Ya,1048576,7),$a=Xa((function(e,r,t,n){return function(e,r,t){for(var n=0,a=t,o=Math.min(r.length,t+e);a<o;a+=1){var i=r[a];if(!Ja(i))break;n=26*n+qa(i)}return a===o&&Ja(r[a])?[0,t]:[n,a]}(r,t,n)}),16384,3),eo=Qa(!0,1048576,7),ro=Qa(!1,16384,5);function to(e,r,t,n,a,o){var i,u,c,s,l,f=function(e,r,t,n,a){if(r===ja.A1&&null!=t){var o=t.range,i=za(e,o.col,o.row,$a,Za,n,a),u=i[0],c=i[1],s=i[2],l=i[3];if((null!=c&&null!=u||null!=c&&c.kind===Ha.Abs||null!=u&&u.kind===Ha.Abs||(null!=c||null!=u)&&(":"===n[a-1]||":"===n[l]))&&(s||l>=n.length||!Un(e,n[l])))return[ja.A1,c,u,l]}var f=za(e,void 0,void 0,eo,ro,n,a),d=f[0],h=f[1],p=f[2],v=f[3];if((null!=d||null!=h)&&(p||v>=n.length||!Un(e,n[v])))return[ja.R1C1,d,h,v]}(e,r,t,n,a);if(null!=f){var d=f[0],h=f[1],p=f[2],v=f[3],g=n.substring(v,a);return Wa(v-a,d===ja.A1?function(e,r,t,n){var a=null==t&&null!=n&&n.kind===zt.PosKind.Rel,o=null==n&&null!=t&&t.kind===zt.PosKind.Rel,i=!(null!=t&&t.kind!==zt.PosKind.Rel||null!=n&&n.kind!==zt.PosKind.Rel);return Ta(e,r,t,n,zt.RefStyle.A1,a,o,i)}(a,g,h,p):(i=a,u=g,s=p,l=!(!1!==(c=h)&&null!=c&&c.kind!==zt.PosKind.Abs||!1!==s&&null!=s&&s.kind!==zt.PosKind.Abs),Ta(i,u,!1===c?zt.pos(zt.PosKind.Rel,0):c,!1===s?zt.pos(zt.PosKind.Rel,0):s,zt.RefStyle.R1C1,!1,!1,l)),o)}}var no=Xt.numErrorOper,ao="+-*/^%&=<>:",oo=!1;function io(e){return!oo&&dt(ot.CalcDynamicArrayOperators)&&(ao+="@#",oo=!0),ao.indexOf(e)>=0}var uo={"+":Na,"-":Oa,"*":ka,"/":La,"^":Da,"%":_a,"&":Fa,"=":Ma,"<":ba,">":wa,":":xa,"@":Ba,"#":Va},co={"<>":Ua,"<=":Pa,">=":Ga};function so(e,r,t){if(r<e.length-1){var n=co[e.substr(r,2)];if(null!=n)return Wa(2,n(r),t)}var a=uo[e[r]];if(null!=a)return Wa(1,a(r),t);return C.ULS.assertTag(595980822,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function lo(e,r,t,n){function a(t){var n=t,a=r[n];if("e"!==a&&"E"!==a)return t;if((n+=1)>=r.length)return t;if("+"===(a=r[n])||"-"===a){if((n+=1)>=r.length)return t;a=r[n]}if(!e.isNumeral(a))return t;for(n+=1;n<r.length&&e.isNumeral(r[n]);n+=1);return n}function o(t,n){var o=t,i=r[o];if(i===e.decimalSeparator){if((o+=1)>=r.length)return n?t:o;i=r[o]}if(!e.isNumeral(i))return n?t:a(o);for(o+=1;o<r.length;o+=1)if(!e.isNumeral(r[o]))return a(o);return o}for(var i=t;i<r.length;i+=1)if(!e.isNumeral(r[i])){i=o(i,i===t);break}if(i>t){var u=r.substring(t,i),c=e.parseNumber(u);return Wa(i-t,Ca(t,u,Wr(c)?c:no,!0),n),i}}function fo(e,r,t){var n=Bn(e,r+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),a=n[0],o=n[1],i=e.substring(r,o+1);return o<e.length?Wa(o+1-r,Ca(r,i,a,!0),t):Wa(o-r,Ca(r,i,a,!1),t)}function ho(e,r,t,n){for(var a=1;a<e.errorNames.length;a+=1){var o=e.errorNames[a],i=r.substr(t,o.length),u=Ra[a];if(0===e.stringCompareCI(o,i)&&null!=u)return Wa(o.length,u(t,i),n)}}var po=Object.getOwnPropertyNames(Sa);function vo(e,r,t,n){for(var a=0;a<po.length;a+=1){var o=po[a],i=r.substr(t,o.length);if(i.toUpperCase()===o)return Wa(o.length,Sa[o](t,i),n)}}function go(e,r){return"'"!==r&&"#"!==r&&r!==e.leftBracket&&r!==e.rightBracket}function mo(e,r,t,n){var a=Wa(1,ca(t,r[t]),n);"#"===r[a]&&(null!=(s=vo(0,r,a,n))&&(a=s));for(var o=function(r){return go(e,r)},i=function(r){return!go(e,r)},u=Pn("calc.parse.tokenizeBracketedColRef",a);a<r.length;){u(a);var c=r[a];if(c===e.rightBracket)return Wa(1,da(a,c),n);if(xn(r,a,o,"'",i)>0){var s,l=Bn(r,a,o,"'",i),f=l[0];a=Wa((s=l[1])-a,oa(a,f),n)}else a=Wa(1,aa(a,c),n)}return a}function Eo(e,r){return!bn(r)&&"'"!==r&&"#"!==r&&":"!==r&&r!==e.listSeparator&&r!==e.leftBracket&&r!==e.rightBracket}function So(e,r,t,n){var a=Wa(1,ca(t,r[t]),n);"#"===r[a]&&(null!=(f=vo(0,r,a,n))&&(a=f));for(var o=function(r){return Eo(e,r)},i=function(r){return!Eo(e,r)},u=Pn("calc.parse.tokenizeBracketedRef",a);a<r.length;){u(a);var c=r[a];if(c===e.rightBracket)return Wa(1,da(a,c),n);if(xn(r,a,o,"'",i)>0){var s=Bn(r,a,o,"'",i),l=s[0];a=Wa((f=s[1])-a,oa(a,l),n)}else if(bn(c)){var f,d=Gn(r,a,bn);l=d[0];a=Wa((f=d[1])-a,na(a,l),n)}else a=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Wa(1,aa(a,c),n):mo(e,r,a,n):Wa(1,va(a,c),n):Wa(1,xa(a),n)}return a}var To,Co="':*?";function Ro(e,r,t,n){for(var a=Wa(1,la(t),n),o=function(r){return function(e,r){return Co.indexOf(r)<0&&r!==e.leftBracket&&r!==e.rightBracket}(e,r)},i=function(e){return"'"===e},u=Pn("calc.parse.tokenizeQuotedQualifier",a);a<r.length;){u(a);var c=r[a];if("'"===c&&"'"!==r[a+1])return Wa(1,pa(a),n);if(":"!==c)if(c!==e.leftBracket)if(xn(r,a,o,"'",i)>0){var s=Bn(r,a,o,"'",i),l=s[0];a=Wa(s[1]-a,oa(a,l),n)}else a=Wa(1,aa(a,c),n);else a=So(e,r,a,n);else a=Wa(1,xa(a),n)}return a}function Io(e,r,t,n){for(var a=e[r],o=r+1;o<e.length;o+=1){var i=e[o];if(i.kind!==t)break;a=n(a,i)}return[a,o]}function yo(e,r){return aa(e.start,e.chars+r.chars)}function Ao(e,r,t,n,a){for(var o=function(e,r,t,n,a){for(var o=[],i=[],u=To.Decimal,c=a,s=Pn("calc.parse.tokenize",c);c<n.length;){s(c);var f=to(e,r,t,n,c,o);if(null==f){var d=n[c];if(u===To.Decimal&&d===e.decimalSeparator||e.isNumeral(d)){var h=lo(e,n,c,o);if(null!=h){c=h,u=To.FieldAccess;continue}if(d!==e.decimalSeparator){var p="calc.parse.tokenize: failed to tokenize numeral at "+c;return C.ULS.assertTag(595980823,l.LogCategory.msoulscat_ES_EWAJS,!1,p)}}if('"'!==d)if(wn(e,d)){var v=Gn(n,c,(function(r){return Un(e,r)})),g=v[0];c=Wa(v[1]-c,Ia(e,c,g),o),u=To.FieldAccess}else if("#"!==d)if(io(d))c=so(n,c,o),u=To.Decimal;else if(bn(d)){var m=Gn(n,c,bn);g=m[0];c=Wa(m[1]-c,na(c,g),o),u=To.Decimal}else if("("!==d)if(")"!==d)if(d!==e.leftBrace)if(d!==e.rightBrace)if(d!==e.leftBracket)if(d!==e.rightBracket){if(i.length>0&&i[i.length-1]===Wn.Brace){if(d===e.columnSeparator){c=Wa(1,ga(c,d),o),u=To.Decimal;continue}if(d===e.rowSeparator){c=Wa(1,ma(c,d),o),u=To.Decimal;continue}}d!==e.listSeparator?"!"!==d?"'"!==d?(c=Wa(1,aa(c,d),o),u=To.Decimal):(c=Ro(e,n,c,o),u=To.Decimal):(c=Wa(1,Ea(c),o),u=To.Decimal):(c=Wa(1,va(c,d),o),u=To.Decimal)}else c=Wa(1,da(c,d),o),u=To.FieldAccess;else c=So(e,n,c,o),u=To.FieldAccess;else i.length>0&&i[i.length-1]===Wn.Brace&&i.pop(),c=Wa(1,ha(c,d),o),u=To.FieldAccess;else i.push(Wn.Brace),c=Wa(1,sa(c,d),o),u=To.Decimal;else i.length>0&&i[i.length-1]===Wn.Paren&&i.pop(),c=Wa(1,fa(c),o),u=To.FieldAccess;else i.push(Wn.Paren),c=Wa(1,ua(c),o),u=To.Decimal;else{var E=ho(e,n,c,o);if(null!=E){c=E,u=To.FieldAccess;continue}dt(ot.CalcDynamicArrayOperators)?(c=so(n,c,o),u=To.Decimal):(c=Wa(1,aa(c,d),o),u=To.Decimal)}else c=fo(n,c,o),u=To.FieldAccess}else c=f,u=To.FieldAccess}return o}(e.config.localeInfo,r,t,n,a),i=[],u=0;u<o.length;){var c=o[u];if(c.kind!==Vn.Unexpected)i.push(c),u+=1;else{var s=Io(o,u,Vn.Unexpected,yo),f=s[0],d=s[1];i.push(f),u=d}}return i.push(ta(n.length)),i}function No(e,r,t,n){var a=void 0;if(function(e){for(var r=e;null!=r;)r=r()}(e(r,t,n,(function(e,r){a=[e,r]}),(function(){a=!1}))),null==a){var o="calc.parse.runParser: internal error: parser did not call resolve or reject on "+g(r);return C.ULS.assertTag(595980827,l.LogCategory.msoulscat_ES_EWAJS,!1,o)}return a}function Oo(e){return function(r,t,n,a,o){return a(e,t)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(To||(To={}));var ko,Lo=function(e,r,t,n,a){return a};function Do(e,r){return function(t,n,a,o,i){return e(t,n,a,(function(e,n){return r(a,e)(t,n,a,o,i)}),i)}}function _o(e,r){return function(t,n,a,o,i){return e(t,n,a,o,(function(){return r(t,n,a,o,i)}))}}function Fo(e){return 0===e.length?Lo:e.reduce(_o)}function Mo(e,r){return function(t,n,a,o,i){return e(t,n,a,o,(function(){return o(r,n)}))}}function bo(e,r){return function(t,n,a,o,i){var u=t[n];if(null==u)return i;var c=e(a,u);return null==c?i:o(c,n+r)}}function wo(e){return bo(e,1)}function Uo(e){return bo(e,0)}function Po(e){return function(r,t,n,a,o){var i=r[t],u=r[t+1];if(null==i||null==u)return o;var c=e(n,i,u);return null==c?o:a(c,t+1)}}function Go(e,r,t){return function(n,a,o,i,u){var c=t,s=a;function f(){return e(n,s,o,d,h)}function d(e,t){if(t<=s){var a=g(n),i="calc.parse.reduce: internal error: no progress made at index "+s+" on "+a;return C.ULS.assertTag(595980829,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return c=r(o,e,c),s=t,f}function h(){return i(c,s)}return f}}function xo(e,r){return Go(e,(function(e,r,t){return t.push(r),t}),r)}function Bo(e){return function(r,t,n,a,o){return xo(e,[])(r,t,n,a,o)}}function Vo(e,r){return Do(e,(function(e,t){return xo(r,[t])}))}function Wo(e){var r=e.length;return function(t,n,a,o,i){var u=n,c=[];function s(){return e[c.length](t,u,a,l,i)}function l(e,t){return u=t,c.push(e),c.length<r?s:o(c,u)}return s}}function Ho(e,r){return Wo([e,r])}function Ko(e,r,t,n,a){return Wo([e,r,t,n,a])}function jo(e,r){return function(t,n,a,o,i){return e(t,n,a,(function(e,t){return o(r(a,e),t)}),i)}}function Jo(e,r,t){return jo(Wo([e,r]),(function(e,r){return t(e,r[0],r[1])}))}function qo(e,r,t,n){return jo(Wo([e,r,t]),(function(e,r){return n(e,r[0],r[1],r[2])}))}function Yo(e,r,t,n,a){return jo(Wo([e,r,t,n]),(function(e,r){return a(e,r[0],r[1],r[2],r[3])}))}function Xo(e,r,t,n,a,o){return jo(Wo([e,r,t,n,a]),(function(e,r){return o(e,r[0],r[1],r[2],r[3],r[4])}))}function Qo(e,r){return Jo(e,r,(function(e,r,t){return r}))}function zo(e,r){return Jo(e,r,(function(e,r,t){return t}))}function Zo(e,r){var t=e.spans[r.label];if(null==t){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+g(r);return C.ULS.assertTag(595980824,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}return t}function $o(e,r,t,n,a){var o=e.label;return e.label+=1,e.spans[o]=zt.formulaSpan(r,t,n,a),o}function ei(e,r,t,n){var a=Zo(e,t);return a.pre=r,a.post=n,t}function ri(e,r,t){return function(n,a,o,i,u){var c=o.leftDelim,s=o.listSep;return o.leftDelim=e,o.listSep=r,t(n,a,o,(function(e,r){return o.leftDelim=c,o.listSep=s,i(e,r)}),(function(){return o.leftDelim=c,o.listSep=s,u}))}}function ti(e,r){return r.kind===Vn.Spaces||r.kind===Vn.End?r.start:Zo(e,r).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(ko||(ko={}));var ni=Mo(wo((function(e,r){return r.kind===Vn.Spaces?r.chars:void 0})),""),ai=function(e,r,t,n,a){var o=e[r];if(null==o){var i="calc.parse.pStart: internal error: expected term at "+r+" in "+g(e);return C.ULS.assertTag(595980864,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return n(ti(t,o),r)};function oi(e){return qo(ni,wo(e),ni,ei)}function ii(e){return Jo(ni,wo(e),(function(e,r,t){return ei(e,r,t,"")}))}function ui(e){return Jo(wo(e),ni,(function(e,r,t){return ei(e,"",r,t)}))}var ci=oi((function(e,r){return r.kind!==zt.NodeKind.Operator||r.id!==$t.OperatorId.Add&&r.id!==$t.OperatorId.Sub?void 0:r})),si=ui((function(e,r){if(r.kind===zt.NodeKind.Operator){if(r.id===$t.OperatorId.Add)return zt.operatorNode($t.OperatorId.Pos,r.label);if(r.id===$t.OperatorId.Sub)return zt.operatorNode($t.OperatorId.Neg,r.label)}})),li=ui((function(e,r){if(r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.At)return zt.operatorNode($t.OperatorId.At,r.label)})),fi=ii((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Pound?r:void 0})),di=oi((function(e,r){return r.kind!==zt.NodeKind.Operator||r.id!==$t.OperatorId.Mul&&r.id!==$t.OperatorId.Div?void 0:r})),hi=oi((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Pow?r:void 0})),pi=ii((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Percent?r:void 0})),vi=oi((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Concat?r:void 0})),gi=oi((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id>=$t.OperatorId.Eq&&r.id<=$t.OperatorId.Ge?r:void 0})),mi=oi((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Range?r:void 0})),Ei=oi((function(e,r){return r.kind===zt.NodeKind.Operator&&r.id===$t.OperatorId.Union?r:void 0})),Si=Po((function(e,r,t){if(r.kind===Vn.Spaces&&t.kind!==Vn.End&&t.kind!==zt.NodeKind.Operator){var n=$o(e,r.start,ti(e,t),r.chars,"");return zt.operatorNode($t.OperatorId.Isect,n)}}));function Ti(e,r,t){return Jo(e,Bo(Ho(r,e)),(function(e,r,n){return 0===n.length?r:n.reduce(t(e),r)}))}function Ci(e,r,t){return Jo(Bo(r),e,(function(e,r,n){return 0===r.length?n:r.reduceRight(t(e),n)}))}function Ri(e,r,t){return Jo(e,Bo(r),(function(e,r,n){return 0===n.length?r:n.reduce(t(e),r)}))}function Ii(e){return function(r,t){var n=t[0],a=t[1],o=Zo(e,r).start,i=Zo(e,a).end,u=$o(e,o,i,"","");return zt.appNode(n,[r,a],!0,u)}}function yi(e){return function(r,t){var n=Zo(e,r).start,a=Zo(e,t).end,o=$o(e,n,a,"","");return zt.appNode(t,[r],!0,o)}}function Ai(e){var r=!0;return function(t,n){var a=Zo(e,n).start,o=Zo(e,t).end,i=$o(e,a,o,"","");if(r&&(r=!1,t.kind===zt.NodeKind.Literal&&"number"==typeof t.oper)){var u=n.id===$t.OperatorId.Pos?t.oper:-t.oper;return zt.literalNode(u,!0,i)}return zt.appNode(n,[t],!0,i)}}function Ni(e){return function(r,t){var n=Zo(e,t).start,a=Zo(e,r).end,o=$o(e,n,a,"","");return zt.appNode(t,[r],!0,o)}}var Oi,ki,Li,Di,_i,Fi,Mi,bi,wi,Ui,Pi,Gi,xi,Bi,Vi=wo((function(e,r){return r.kind!==zt.NodeKind.Operator&&r.kind!==Vn.Spaces&&r.kind!==Vn.End?r:void 0}));function Wi(e,r){var t=$o(e,Zo(e,r[0]).start,Zo(e,r[r.length-1]).end,"","");return zt.badNode(zt.BadType.Sequence,r,t)}var Hi=!1;function Ki(e,r){Hi||(dt(ot.CalcDynamicArrayOperators)?(Oi=Jo(ai,Bo(Vi),(function(e,r,t){return 0===t.length?zt.literalNode(Xt.missingOper,!0,$o(e,r,r,"","")):1===t.length?t[0]:Wi(e,t)})),ki=Ri(Oi,fi,yi),Li=Ti(ki,mi,Ii),Di=Ti(Li,Si,Ii),_i=Ci(Di,li,Ni),Fi=Ti(_i,Ei,Ii),Mi=Ci(Fi,si,Ai),bi=Ri(Mi,pi,yi),wi=Ti(bi,hi,Ii),Ui=Ti(wi,di,Ii),Pi=Ti(Ui,ci,Ii),Gi=Ti(Pi,vi,Ii),xi=Ti(Gi,gi,Ii)):(Li=Jo(ai,Bo(Vi),(function(e,r,t){return 0===t.length?zt.literalNode(Xt.missingOper,!0,$o(e,r,r,"","")):1===t.length?t[0]:Wi(e,t)})),Di=Ti(Li,mi,Ii),_i=Ti(Di,Si,Ii),Fi=Ti(_i,Ei,Ii),Mi=Ci(Fi,si,Ai),bi=Ri(Mi,pi,yi),wi=Ti(bi,hi,Ii),Ui=Ti(wi,di,Ii),Pi=Ti(Ui,ci,Ii),Gi=Ti(Pi,vi,Ii),xi=Ti(Gi,gi,Ii)),Bi=Jo(xi,Bo(zo(Uo((function(e,r){return r.kind===Vn.End?void 0:r})),xi)),(function(e,r,t){return 0===t.length?r:Wi(e,[r].concat(t))})),Hi=!0);var t=e.length-1;if(t<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return C.ULS.assertTag(595980865,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===Vn.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+g(e);return C.ULS.assertTag(595980866,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t-1>=0&&e[t-1].kind===Vn.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+g(e);return C.ULS.assertTag(595980867,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[t].kind!==Vn.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+g(e);return C.ULS.assertTag(595980868,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=No(Bi,e,0,r);if(!1===a){n="calc.parse.parseTerms: internal error: failed to parse "+g(e);return C.ULS.assertTag(595980869,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var o=a[0],i=a[1];if(i<t){n="calc.parse.parseTerms: internal error: consumed "+i+" out of "+t+" in "+g(e);return C.ULS.assertTag(595980870,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}return o}var ji=Mo(wo((function(e,r){return r.kind===Vn.Spaces?r.chars:void 0})),""),Ji=function(e,r,t,n,a){var o=e[r];if(null==o){var i="calc.parse.pStart: internal error: expected token at "+r+" in "+g(e);return C.ULS.assertTag(595980830,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return n(o.start,r)};function qi(e){return wo((function(r,t){return t.kind===Vn.Sep&&t.value===e||void 0}))}function Yi(e){return wo((function(r,t){return t.kind===Vn.Left&&t.value===e?t.start:void 0}))}function Xi(e){return wo((function(r,t){return t.kind===Vn.Right&&t.value===e||void 0}))}var Qi,zi=qi(Hn.List),Zi=qi(Hn.Row),$i=qi(Hn.Col),eu=qi(Hn.Qual),ru=Yi(Wn.Paren),tu=Xi(Wn.Paren),nu=Yi(Wn.Brace),au=Xi(Wn.Brace),ou=Yi(Wn.SQuote),iu=Xi(Wn.SQuote),uu=wo((function(e,r){return r.kind===Vn.Operator&&r.value===$t.OperatorId.Range||void 0})),cu=Qi={impl:function(e,r,t,n,a){return C.ULS.assertTag(595980828,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(e,r,t,n,a){return function(){return Qi.impl(e,r,t,n,a)}}},su=qo(ji,cu.parser,ji,ei),lu=Yo(ru,ri(Wn.Paren,ko.Union,su),Mo(tu,!1),Ji,(function(e,r,t,n,a){var o=$o(e,r,a,"","");return zt.parenNode(t,n,o)})),fu=Vo(su,zo($i,su)),du=Vo(fu,zo(Zi,fu)),hu=Yo(nu,ri(Wn.Brace,ko.Union,du),Mo(au,!1),Ji,(function(e,r,t,n,a){var o=$o(e,r,a,"","");return zt.arrayNode(t,n,o)})),pu=wo((function(e,r){if(r.kind===Vn.Ident||r.kind===Vn.CellRef&&r.isQualPart||r.kind===Vn.Literal&&r.isQualPart||r.kind===Vn.Operator&&r.value===$t.OperatorId.Dot)return r.chars})),vu=Vo(pu,pu),gu=wo((function(e,r){return r.kind===Vn.Ident?r.chars:void 0}));function mu(e){return e.kind===Vn.Literal&&"object"==typeof e.oper&&e.oper.kind===Xt.OperKind.Error&&e.oper.type===Xt.ErrorType.REF}function Eu(e,r,t,n){return null==r?[zt.identQualifier(e,t,n),t?"'"+e+"'":e]:[zt.sheetRangeQualifier(e,r,t,n),t?"'"+e+":"+r+"'":e+":"+r]}var Su=Yo(Ji,vu,Mo(zo(uu,vu),void 0),Ji,(function(e,r,t,n,a){var o=$o(e,r,a,"","");return Eu(t.join(""),null!=n?n.join(""):void 0,!1,o)})),Tu=Xo(ou,gu,Mo(zo(uu,gu),void 0),iu,Ji,(function(e,r,t,n,a,o){return Eu(t,n,!0,$o(e,r,o,"",""))})),Cu=Yo(ou,Bo(wo((function(e,r){return r.kind===Vn.End||r.kind===Vn.Right&&r.value===Wn.SQuote?void 0:r.chars}))),Mo(Ho(iu,Mo(Qo(eu,ji),!1)),[!1,!1]),Ji,(function(e,r,t,n,a){var o=n[0],i=n[1],u="'"+t.join("")+(o?"'":"")+(i?"!":""),c=$o(e,r,a,"","");return[zt.badNode(zt.BadType.Qualifier,u,c),u]})),Ru=Po((function(e,r,t){if(mu(r)){var n=$o(e,r.start,t.start,"","");return[zt.errorQualifierLabeled(n),r.chars]}})),Iu=Jo(Fo([Su,Tu,Uo((function(e,r){var t=$o(e,r.start,r.start,"","");return[zt.relativeQualifierLabeled(t),""]}))]),Qo(eu,ji),(function(e,r,t){return[r[0],r[1]+"!"]})),yu=Fo([Ru,Iu,Cu]);function Au(e,r){return r.kind===Vn.CellRef&&e.refStyle===r.refStyle}var Nu=Po((function(e,r,t){return Au(e,r)?[r,t.start]:void 0}));function Ou(e,r){if(null!=e.row&&null!=e.col)return zt.cellRefSingle(e.row,e.col,r);if(null!=e.row)return zt.cellRefRow(e.row,e.row,r);if(null!=e.col)return zt.cellRefCol(e.col,e.col,r);var t="calc.parse.cellRefToken2cellRef: bad token "+g(e);return C.ULS.assertTag(595980831,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}var ku=Po((function(e,r,t){if(Au(e,r)&&(r.refStyle!==zt.RefStyle.A1||null!=r.row&&null!=r.col))return Ou(r,n=$o(e,r.start,t.start,"",""));if(mu(r)){var n=$o(e,r.start,t.start,"","");return zt.cellRefErrorLabeled(n)}})),Lu=_o(Do(Ko(Nu,ji,uu,ji,Nu),(function(e,r){var t=r[0],n=t[0],a=t[1],o=r[1],i=(r[2],r[3]),u=r[4],c=u[0],s=u[1],l=$o(e,n.start,a,"",o),f=$o(e,c.start,s,i,""),d=Ou(n,l),h=Ou(c,f),p=void 0;if(d.kind===zt.CellRefKind.Single&&h.kind===zt.CellRefKind.Single){var v=$o(e,n.start,s,"","");p=zt.cellRefRange(d,h,v)}else if(0===o.length&&0===i.length)if(d.kind===zt.CellRefKind.Row&&h.kind===zt.CellRefKind.Row){v=$o(e,n.start,s,"","");p=zt.cellRefRow(d.row1,h.row1,v)}else if(d.kind===zt.CellRefKind.Col&&h.kind===zt.CellRefKind.Col){v=$o(e,n.start,s,"","");p=zt.cellRefCol(d.col1,h.col1,v)}return null==p?Lo:n.isQualPart&&c.isQualPart?Uo((function(e,r){return r.kind===Vn.Sep&&r.value===Hn.Qual?void 0:p})):Oo(p)})),ku),Du=wo((function(e,r){return r.kind===Vn.Ident||r.kind===Vn.CellRef&&r.isName?r.chars:void 0})),_u=Do(Ko(Ji,yu,Ji,Mo(_o(Lu,Du),void 0),Ji),(function(e,r){var t=r[0],n=r[1],a=n[0],o=n[1],i=r[2],u=r[3],c=r[4];if(null==u)return a.kind!==zt.QualifierKind.SheetRange||a.isQuoted?a.kind===zt.QualifierKind.Error?Oo(zt.literalNode(Xt.refErrorOper,!0,a.label)):Oo(a.kind===zt.NodeKind.Bad?a:zt.badNode(zt.BadType.Qualifier,o,a.label)):Lo;if("string"==typeof u){if(a.kind===zt.QualifierKind.SheetRange&&!a.isQuoted)return Lo;var s=$o(e,t,c,"","");if(a.kind===zt.NodeKind.Bad||a.kind===zt.QualifierKind.Error||a.kind===zt.QualifierKind.SheetRange){var l=a.kind===zt.NodeKind.Bad?a:zt.badNode(zt.BadType.Qualifier,o,a.label),f=zt.nameNode(u,void 0,$o(e,i,c,"",""));return Oo(zt.badNode(zt.BadType.Sequence,[l,f],s))}return Oo(zt.nameNode(u,a,s))}var d=$o(e,t,c,"","");if(a.kind===zt.NodeKind.Bad||a.kind===zt.QualifierKind.Document){var h=a.kind===zt.NodeKind.Bad?a:zt.badNode(zt.BadType.Qualifier,o,a.label);f=zt.cellRefNode(u,void 0,$o(e,i,c,"",""));return Oo(zt.badNode(zt.BadType.Sequence,[h,f],d))}var p=a.kind===zt.QualifierKind.Ident?zt.sheetQualifier(a.name,void 0,a.isQuoted,a.label):a;return Oo(zt.cellRefNode(u,p,d))})),Fu=qo(Ji,_o(Lu,Du),Ji,(function(e,r,t,n){var a=$o(e,r,n,"","");return"string"==typeof t?zt.nameNode(t,void 0,a):t.kind===zt.CellRefKind.Error?zt.literalNode(Xt.refErrorOper,!0,a):zt.cellRefNode(t,void 0,a)})),Mu=Po((function(e,r,t){if(r.kind===Vn.Literal)return zt.literalNode(r.oper,r.hasRight,$o(e,r.start,t.start,"",""));if(r.kind===Vn.CellRef&&r.isNumber&&"object"==typeof r.row&&null!=e.range){var n=r.row.index+e.range.range.row+1;return zt.literalNode(n,!0,$o(e,r.start,t.start,"",""))}}));function bu(e){return Po((function(r,t,n){if(e(t)){var a=$o(r,t.start,n.start,"","");return zt.badNode(zt.BadType.Unexpected,t.chars,a)}}))}var wu=bu((function(e){return e.kind===Vn.Left&&e.value===Wn.Bracket})),Uu=bu((function(e){return e.kind===Vn.Right&&e.value===Wn.Bracket})),Pu=Xo(Ji,wu,ri(Wn.Bracket,ko.Union,su),Mo(Uu,void 0),Ji,(function(e,r,t,n,a,o){var i=[t,n];null!=a&&i.push(a);var u=$o(e,r,o,"","");return zt.badNode(zt.BadType.Sequence,i,u)})),Gu=Po((function(e,r,t){switch(r.kind){case Vn.End:case Vn.Operator:case Vn.Spaces:return;case Vn.Sep:if(r.value!==Hn.Qual&&(e.leftDelim===Wn.Brace||r.value!==Hn.Col&&r.value!==Hn.Row))return;break;case Vn.Right:if(r.value===e.leftDelim)return}var n=r.kind===Vn.CellRef?zt.BadType.CellRef:zt.BadType.Unexpected,a=$o(e,r.start,t.start,"","");return zt.badNode(n,r.chars,a)})),xu=Po((function(e,r,t){if((r.kind===Vn.Ident||r.kind===Vn.CellRef||r.kind===Vn.Literal&&"boolean"==typeof r.oper)&&t.kind===Vn.Left&&t.value===Wn.Paren&&null!=e.localeInfo.getWorksheetFuncId(r.chars)){var n=$o(e,r.start,t.start,"","");return zt.nameNode(r.chars,void 0,n)}})),Bu=Yo(ru,ri(Wn.Paren,ko.Arg,Vo(su,zo(zi,su))),Mo(tu,!1),Ji,(function(e,r,t,n,a){return[t,n,a]})),Vu=Jo(xu,Bu,(function(e,r,t){var n=t[0],a=t[1],o=t[2],i=$o(e,Zo(e,r).start,o,"","");return zt.appNode(r,n,a,i)})),Wu=Jo(Fo([Vu,_u,Fu,Mu,lu,hu,Pu,Gu]),Bo(Bu),(function(e,r,t){var n=Zo(e,r).start;return t.reduce((function(r,t){var a=t[0],o=t[1],i=t[2],u=$o(e,n,i,"","");return zt.appNode(r,a,o,u)}),r)})),Hu=Po((function(e,r,t){var n=void 0;if(r.kind===Vn.Operator&&(n=r.value),r.kind===Vn.Sep&&r.value===Hn.List&&e.listSep===ko.Union&&(n=$t.OperatorId.Union),null!=n){var a=$o(e,r.start,t.start,"","");return zt.operatorNode(n,a)}})),Ku=wo((function(e,r){return r.kind===Vn.Spaces?r:void 0})),ju=_o(Wu,Hu),Ju=Do(ju,(function(e,r){return Go(Ho(Mo(Ku,void 0),ju),(function(e,r,t){var n=r[0],a=r[1];return null!=n&&t.push(n),t.push(a),t}),[r])})),qu=Jo(Mo(Ju,void 0),Ji,(function(e,r,t){if(null==r){var n=$o(e,t,t,"","");return zt.literalNode(Xt.missingOper,!0,n)}if(1===r.length){var a=r[0];if(a.kind!==zt.NodeKind.Operator&&a.kind!==Vn.Spaces)return a}return r.push(ta(t)),Ki(r,e)}));function Yu(e,r,t,n,a){var o=a.length-1;if(o<0){var i="calc.parse.parseTokens: internal error: expected at least 1 token";return C.ULS.assertTag(595980832,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}if(a[o].kind!==Vn.End){i="calc.parse.parseTokens: internal error: array[n] !== End in "+g(a);return C.ULS.assertTag(595980833,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}var u=function(e,r,t,n){return{localeInfo:e,refStyle:r,range:t,source:n,leftDelim:void 0,listSep:ko.Union,label:1,spans:{}}}(e.config.localeInfo,r,t,n),c=No(su,a,0,u);if(!1===c){i="calc.parse.parseTokens: internal error: failed to parse "+g(a);return C.ULS.assertTag(595980834,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}var s=c[0],f=c[1];if(f<o){i="calc.parse.parseTokens: internal error: consumed "+f+" out of "+o+" in "+g(a);return C.ULS.assertTag(595980835,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return zt.formula(s,u.spans)}cu.impl=qu;var Xu={"=":1,"+":0,"-":0,"@":-1};function Qu(e){return{parseFormula:function(r,t,n,a){return function(e,r,t,n,a){var o=a[0],i=null!=o?Xu[o]:void 0;if(null==i)return rn.failure(Fn("first character is not '=', '+', '-' or '@'"));if(i<0)return rn.failure(Ln(["Lotus 1-2-3 syntax"]));if(r===zt.RefStyle.A1&&null==t){return C.ULS.assertTag(595980825,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined")}var u=Yu(e,r,t,n,Ao(e,r,t,a,i));return rn.success(u)}(e,r,t,n,a)},formatFormula:function(r,t,n,a){return rn.prettyPrinter(a.node,e.config.localeInfo,t,r,n)}}}var zu=zt.QualifierKind,Zu=zt.CellRefKind,$u=zt.NodeKind,ec=rn.ResultKind;function rc(e){return e.kind===ec.Success}function tc(e,r){var t=e[r];return null==t?y("ParseResultHelper.getFormulaSpan: expected span for label "+r+" to be defined"):t}function nc(e,r,t){return!!rc(e)&&(function(e,r,t){if(null==e||null==t)return;var n={};null!=r?r.forEach((function(e){n[e]=!0})):n["*"]=!0;var a=[];a.push(e.node);for(;a.length>0;){var o=a.pop();if(null!=o)switch(o.kind){case $u.Literal:c("literal")&&t("literal",{label:o.label,value:o});break;case $u.Array:o.nodes.map((function(e){return e.map((function(e){a.push(e)}))}));break;case $u.App:if("object"!=typeof o.head)c("literal")&&t("literal",{label:o.label,value:o.head});else{var i=o.head;switch(i.kind){case $u.Operator:c("operator")&&t("operator",{label:o.label,value:i.id});break;case $u.Name:c("function")&&t("function",{label:o.label,name:i.whole,isClosed:o.isClosed,args:o.args});break;default:a.push(i)}}o.args.map((function(e){a.push(e)}));break;case $u.Paren:a.push(o.node);break;case $u.Name:if(c("namedRange")){var u=o.whole.split(".");t("namedRange",{label:o.label,name:u[0],names:u.slice(1),qualifier:s(o)})}break;case $u.CellRef:c("range")&&l(o);break;case $u.Bad:break;default:return I("calc.parse.traverseFormula",o)}}function c(e){return n[e]||n["*"]}function s(e){if(null!=e.qualifier){var r={};switch(e.qualifier.kind){case zu.Sheet:var t=e.qualifier;r.type=zu.Sheet,r.sheet=t.sheet,null!=t.document&&(r.document=t.document.document,null!=t.document.path&&(r.documentPath=t.document.path));break;case zu.SheetRange:var n=e.qualifier;r.type=zu.SheetRange,r.sheet1=n.sheet1,r.sheet2=n.sheet2;break;case zu.Ident:var a=e.qualifier;r.type=zu.Ident,r.name=a.name;break;case zu.Document:var o=e.qualifier;r.document=o.document,null!=o.path&&(r.documentPath=o.path)}return r}}function l(r){if(null!=e&&null!=t)switch(r.ref.kind){case Zu.Error:break;case Zu.Col:var n=r.ref;t("range",{label:r.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:tc(e.spans,n.label),qualifier:s(r)});break;case Zu.Row:var a=r.ref;t("range",{label:r.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:tc(e.spans,a.label),qualifier:s(r)});break;case Zu.Single:var o=r.ref;t("range",{label:r.label,type:"cell",row:o.row,col:o.col,span:tc(e.spans,o.label),qualifier:s(r)});break;case Zu.Range:var i=r.ref;t("range",{label:r.label,type:"range",top:i.ref1.row,left:i.ref1.col,bottom:i.ref2.row,right:i.ref2.col,topLeftSpan:tc(e.spans,i.ref1.label),bottomRightSpan:tc(e.spans,i.ref2.label),qualifier:s(r)})}}}(e.value,r,t),!0)}var ac={isSuccess:rc,traverse:nc,extractReferences:function(e){if(rc(e)){var r=[];return nc(e,["range","namedRange"],(function(t,n){var a={kind:t,ref:n,span:tc(e.value.spans,n.label)};r.push(a)})),r.sort((function(e,r){return e.span.start-r.span.start})),r}}};var oc,ic,uc=rn.ReasonKind,cc=rn.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(oc||(oc={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula",e.JavaScriptError="JavaScriptError"}(ic||(ic={}));var sc,lc=it.__assign({},uc,ic),fc=cc;function dc(e,r,t,n,a){return{config:e,getDocumentLoc:r,getSheetIndex:t,getCellFormat:n,getKnownFormat:a}}!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(sc||(sc={}));var hc={Unclosed_expression:{code:1,category:sc.SyntaxError},Illegal_array_literal_element:{code:2,category:sc.SyntaxError},Empty_array_literal:{code:3,category:sc.SyntaxError},Irregular_array_shape:{code:4,category:sc.SyntaxError},Empty_parenthesis:{code:5,category:sc.SyntaxError},Missing_operation_argument:{code:6,category:sc.SyntaxError},Bad_node:{code:7,category:sc.SyntaxError},Invalid_binder:{code:8,category:sc.SyntaxError},Empty_formula:{code:9,category:sc.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:sc.SyntaxError},Types_not_related:{code:1001,category:sc.TypeError},Unexpected_application_head:{code:1002,category:sc.TypeError},Unexpected_application_head_with_fix:{code:1003,category:sc.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:sc.TypeError},Excess_function_arguments:{code:1005,category:sc.TypeError},Insufficient_function_arguments:{code:1006,category:sc.TypeError}},pc=zt.NodeKind,vc=zt.QualifierKind,gc=zt.BadType,mc=zt.CellRefKind,Ec=qt.FormulaSource,Sc=Xt.OperKind,Tc=Xt.ErrorType,Cc=$t.SignatureType,Rc=$t.SpecialPrecs,Ic=$t.getOperatorType,yc=$t.WorksheetFuncId,Ac=$t.getWorksheetFuncType,Nc=rn.operKind,Oc=rn.getArguments,kc=rn.getArgType,Lc=rn.defaultLiteralVisitor,Dc=rn.defaultFormulaVisitor,_c=rn.dispatch,Fc=rn.startVisit,Mc={};function bc(e,r){return{context:e,result:r}}function wc(e){return function(r){return r.kind===pc.Literal&&e(r.oper)}}var Uc=wc((function(e){return Nc(e)===Sc.Missing})),Pc=wc((function(e){return Nc(e)===Sc.Error&&e.type===Tc.REF})),Gc=wc((function(e){return 0!=(Nc(e)&(Sc.String|Sc.Error|Sc.Boolean))}));function xc(e){return e.kind===pc.Name&&void 0===e.qualifier}function Bc(e,r,t,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(r,t,e.errorData))}function Vc(e,r){return r!==Sc.Range||0!=(e&Sc.Range)}function Wc(e,r){if(r.kind===pc.Literal)switch(Bc(e,r,hc.Unclosed_expression,r.isClosed),Nc(r.oper)){case Sc.Number:case Sc.Boolean:case Sc.String:case Sc.Error:return;default:return void Bc(e,r,hc.Illegal_array_literal_element)}Bc(e,r,hc.Illegal_array_literal_element)}function Hc(e,r,t){Bc(e,r,hc.Types_not_related,Vc(Sc.Array,t)),Bc(e,r,hc.Unclosed_expression,r.isClosed);var n=r.nodes.length>0;if(Bc(e,r,hc.Empty_array_literal,n),!n)return bc(e,t);for(var a=r.nodes[0].length,o=0;o<r.nodes.length;o+=1){var i=r.nodes[o],u=i.length;Bc(e,r,hc.Irregular_array_shape,u===a);for(var c=0;c<u;c+=1)Wc(e,i[c])}return bc(e,t)}function Kc(e,r,t){if(e.earlyExit&&!e.isOk())throw Mc;switch(r.kind){case pc.Array:return Hc(e,r,t);case pc.Paren:return Bc(e,r,hc.Unclosed_expression,r.isClosed),Bc(e,r,hc.Empty_parenthesis,!Uc(r.node)),Kc(e,r.node,t);case pc.Bad:case pc.Name:case pc.CellRef:case pc.App:case pc.Literal:var n=qc(e,r);return Bc(e,r,hc.Types_not_related,Vc(n.result,t)),n.result=t,n;default:return I("calc.analyze.checker.check: unhandled formula case",r)}}function jc(e,r,t){var n,a=Ac(r),o=t.args,i=o.length,u=Oc(t),c=u.length,s=e.isOk();c<a.minArgs&&Bc(e,void 0===(n=o[i-1])?t:n,hc.Insufficient_function_arguments);0===a.restTypes.length&&c>a.headTypes.length&&Bc(e,void 0===(n=o[i-1])?t:n,hc.Excess_function_arguments);a.restTypes.length>1&&r!==yc.SWITCH&&((c-a.headTypes.length)%a.restTypes.length!=0&&Bc(e,void 0===(n=o[i-1])?t:n,hc.Insufficient_function_arguments));for(var l=0;l<c;l+=1)Kc(e,u[l],kc(a,l));var f=!s||e.isOk();return f&&(e.specialDependencies|=a.staticPrecs,function(e,r,t){switch(r){case yc.LET:var n=t[0];return void 0!==n?Bc(e,n,hc.Invalid_binder,xc(n)):I("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",n);case yc.FUN:for(var a=0;a<t.length-1;a+=1){var o=t[a];Bc(e,o,hc.Invalid_binder,xc(o))}}}(e,r,o)),bc(e,f?a.returnType:Cc.All)}function Jc(e,r){Bc(e,r,hc.Unclosed_expression,r.isClosed);var t=r.args;if(r.head.kind===pc.Operator)return function(e,r,t){var n=Ic(r.id),a=t.length,o=a===n.minArgs;Bc(e,r,hc.Incorrect_number_of_operator_arguments,o);for(var i=0;i<a;i+=1){var u=t[i];Uc(u)&&(o=!1,Bc(e,u,hc.Missing_operation_argument)),Kc(e,u,kc(n,i))}return o?(e.specialDependencies|=n.staticPrecs,bc(e,n.returnType)):bc(e,Cc.All)}(e,r.head,t);if(xc(r.head)){var n=e.globals.config.localeInfo.getWorksheetFuncId(r.head.whole.toLocaleUpperCase());if(void 0!==n)return jc(e,n,r)}for(var a=0;a<t.length;a+=1)Kc(e,t[a],Cc.All);var o=r.head,i=qc(e,o);return Vc(i.result,Sc.Range)||i.result===Sc.Error&&function(e){for(var r=e;r.kind===pc.Paren;)r=r.node;return Pc(r)}(o)?bc(e,Cc.All):(Bc(e,o,Gc(o)||o.kind===pc.Array?hc.Unexpected_application_head:hc.Unexpected_application_head_with_fix),bc(e,Cc.All))}function qc(e,r){if(e.earlyExit&&!e.isOk())throw Mc;switch(r.kind){case pc.App:return Jc(e,r);case pc.Array:return Hc(e,r,Sc.Array);case pc.Bad:return Bc(e,r,hc.Bad_node),bc(e,Cc.All);case pc.CellRef:return e.source!==Ec.Cell&&e.source!==Ec.Range||void 0===r.qualifier||r.qualifier.kind!==vc.Relative?bc(e,Sc.Range):(Bc(e,r,hc.Invalid_rel_sheet_qualifier_in_cell),bc(e,Cc.All));case pc.Literal:return Bc(e,r,hc.Unclosed_expression,r.isClosed),bc(e,Nc(r.oper));case pc.Name:return bc(e,Cc.All);case pc.Paren:return Bc(e,r,hc.Unclosed_expression,r.isClosed),Bc(e,r,hc.Empty_parenthesis,!Uc(r.node)),qc(e,r.node);default:return I("calc.analyze.checker.infer: unhandled formula case",r)}}var Yc={ok:!0,isOk:ur,collect:function(e,r,t){return!1}};function Xc(e,r,t,n,a){void 0===a&&(a=!0);var o={globals:e,location:r,source:t,reportError:n.collect,isOk:function(){return n.isOk(o.errorData)},earlyExit:a,specialDependencies:Rc.None,errorData:n.ok};return o}function Qc(e,r){try{return Bc(e,r.node,hc.Empty_formula,!Uc(r.node)),Kc(e,r.node,Cc.All)}catch(r){return r!==Mc&&C.ULS.traceTag(595952020,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+g(r)),bc(e,Cc.All)}}function zc(e,r){if(r.kind!==pc.Bad||r.type!==gc.Sequence||3!==r.contents.length)return!1;var t=r.contents[0],n=r.contents[2];return t.kind===pc.Bad&&t.type===gc.Unexpected&&t.contents===e.leftBracket&&(n.kind===pc.Bad&&n.type===gc.Unexpected&&n.contents===e.rightBracket)}function Zc(e,r){if(2===r.length){var t,n=r[0],a=r[1];return zc(e,n)?(t=a).kind===pc.Name&&null!=t.qualifier&&t.qualifier.kind===vc.Ident?pc.Name:function(e){return e.kind===pc.CellRef&&null!=e.qualifier&&e.qualifier.kind===vc.Sheet&&null==e.qualifier.document}(a)?pc.CellRef:void 0:function(e,r){return r.kind===pc.Bad&&r.type===gc.Qualifier&&r.contents.indexOf(e.leftBracket)>=0}(e,n)?xc(a)?pc.Name:function(e){return e.kind===pc.CellRef&&null==e.qualifier}(a)?pc.CellRef:void 0:void 0}}function $c(e){if(e.kind===pc.Literal&&e.isClosed)switch(Nc(e.oper)){case Sc.Number:case Sc.Boolean:case Sc.String:case Sc.Error:return!0;default:return!1}return!1}function es(e,r){var t=r.head,n=t.kind!==pc.Operator;if(!r.isClosed||r.args.some((function(r){return!rs(e,r,n)})))return!1;if(t.kind===pc.Operator)return(o=Ic(t.id)).minArgs===r.args.length;if(!rs(e,t,!1))return!1;if(xc(t)){var a=e.config.localeInfo.getWorksheetFuncId(t.whole.toLocaleUpperCase());if(void 0!==a){var o=Ac(a),i=Oc(r).length;if(i<o.minArgs)return!1;if(0===o.restTypes.length&&i>o.headTypes.length)return!1;if(o.restTypes.length>1&&a!==yc.SWITCH)if((i-o.headTypes.length)%o.restTypes.length!=0)return!1;return function(e,r){switch(e){case yc.LET:return xc(r[0]);case yc.FUN:return r.slice(0,r.length-1).every(xc);default:return!0}}(a,r.args)}}return!0}function rs(e,r,t){switch(r.kind){case pc.Literal:return r.isClosed&&(!!t||Nc(r.oper)!==Sc.Missing);case pc.Name:case pc.CellRef:return!0;case pc.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every((function(e){return t=e,n=r.nodes[0].length,t.length===n&&t.every($c);var t,n}));case pc.App:return es(e,r);case pc.Paren:return r.isClosed&&rs(e,r.node,!1);case pc.Bad:return!1;default:return I("calc.analyze.isWF",r)}}function ts(e,r,t){switch(r.kind){case pc.Literal:case pc.Name:break;case pc.CellRef:r.ref.kind===mc.Row&&(t.rowRef+=1),r.ref.kind===mc.Col&&(t.colRef+=1);break;case pc.Array:r.nodes.forEach((function(r){return r.forEach((function(r){return ts(e,r,t)}))}));break;case pc.App:r.head.kind!==pc.Operator&&ts(e,r.head,t),r.args.forEach((function(r){return ts(e,r,t)}));break;case pc.Paren:ts(e,r.node,t);break;case pc.Bad:if(r.type===gc.Sequence){var n=r.contents;if(function(e,r){return 2===r.length&&xc(r[0])&&zc(e,r[1])}(e,n))t.structRef+=1;else{var a=Zc(e,n);null!=a?(a===pc.Name?t.docQualName+=1:a===pc.CellRef&&(t.docQualCellRef+=1),ts(e,n[1],t)):n.forEach((function(r){return ts(e,r,t)}))}}else r.type===gc.Qualifier&&(t.badQual+=1);break;default:return I("calc.analyze.collectRefStats",r)}}var ns=Dc(Lc((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var r=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var t=_c(e,ns);r=Math.max(r,t)}))})),1+r},vRange:function(e){var r=_c(e.ref1,ns),t=_c(e.ref2,ns);return 1+Math.max(r,t)},vBad:function(e){if(e.type===gc.Sequence){var r=-1;return e.contents.forEach((function(e){var t=_c(e,ns);r=Math.max(r,t)})),1+r}return 1},vCellRef:function(e){var r=-1;if(void 0!==e.qualifier){var t=_c(e.qualifier,ns);r=Math.max(r,t)}return 1+Math.max(r,_c(e.ref,ns))},vParen:function(e){return 1+_c(e.node,ns)},vApp:function(e){var r=-1;return e.args.forEach((function(e){var t=_c(e,ns);r=Math.max(r,t)})),1+r}});var as,os=[];function is(e,r,t,n,a){var o,i={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(ts(e.config.localeInfo,n.node,i),i.rowRef+i.colRef+i.structRef+i.docQualName+i.docQualCellRef+i.badQual>0&&C.ULS.traceTag(595961670,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+a+"; anonymize: "+g(n.node)+"; stats = "+JSON.stringify(i)),dt(ot.CalcStrictFormulaChecking))if(os.length<10){var u=(o=n.node,Fc(o,ns,-1));os.push(u)}else C.ULS.traceTag(595957962,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+os.join("; ")),os=[];var c=dt(ot.CalcStrictFormulaChecking)?function(e,r,t,n){return Qc(Xc(e,r,t,Yc),n).context.errorData}(e,r,t,n):rs(e,n.node,!1);return c||function(e){e.kind!==pc.App||e.isClosed||C.ULS.traceTag(595949718,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(n.node),it.__assign({},n,{isWellFormed:c})}var us=zt.NodeKind,cs=Xt.OperKind,ss=$t.OperatorId,ls=$t.getWorksheetFuncType,fs=$t.WorksheetFuncId,ds=rn.success,hs=rn.failure,ps=rn.operKind,vs=rn.isSuccess,gs=rn.getArguments,ms=rn.unavailable,Es=rn.sheetGridRangeAnchor,Ss=rn.createResolutionHandler,Ts=rn.createResolver,Cs=rn.isSheetGridRange,Rs={kind:lc.BadOperation},Is={kind:lc.BadFormula},ys={getDocumentLoc:function(){},getSheetIndex:function(){return hs(ms(["defaultInferenceGlobals getSheetIndex"]))},getCellFormat:function(){return hs(ms(["defaultInferenceGlobals getCellFormat"]))},getKnownFormat:function(){return hs(ms(["defaultInferenceGlobals getKnownFormat"]))}};function As(e){return{getDocumentLoc:dr(e.getDocumentLoc,ys.getDocumentLoc),getSheetIndex:dr(e.getSheetIndex,ys.getSheetIndex)}}function Ns(e){return{getDocumentLoc:dr(e.getDocumentLoc,ys.getDocumentLoc),getSheetIndex:dr(e.getSheetIndex,ys.getSheetIndex),getCellFormat:dr(e.getCellFormat,ys.getCellFormat),getKnownFormat:dr(e.getKnownFormat,ys.getKnownFormat)}}function Os(e,r,t,n){return{strongFormat:e,category:r,iformat:t,decimals:n}}var ks,Ls={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(ks||(ks={}));var Ds=((as={})[fs.INT]=ks.Propagate,as[fs.MOD]=ks.Propagate,as[fs.ROUND]=ks.Propagate,as[fs.SUM]=ks.Propagate,as[fs.TRUNC]=ks.Propagate,as[fs.AVERAGE]=ks.Propagate,as[fs.MAX]=ks.Propagate,as[fs.MEDIAN]=ks.Propagate,as[fs.MIN]=ks.Propagate,as[fs.ROUNDUP]=ks.Propagate,as[fs.ROUNDDOWN]=ks.Propagate,as[fs.NPV]=oc.CoCurrencyDec,as[fs.PV]=oc.CoCurrencyDec,as[fs.FV]=oc.CoCurrencyDec,as[fs.PMT]=oc.CoCurrencyDec,as[fs.RATE]=oc.Percentage0,as[fs.MIRR]=oc.Percentage0,as[fs.IRR]=oc.Percentage0,as[fs.DATE]=oc.MMDDYY,as[fs.TIME]=oc.HHMMAP,as[fs.NOW]=oc.MDYHMS,as[fs.SLN]=oc.CoCurrencyDec,as[fs.SYD]=oc.CoCurrencyDec,as[fs.DDB]=oc.CoCurrencyDec,as[fs.IPMT]=oc.CoCurrencyDec,as[fs.PPMT]=oc.CoCurrencyDec,as[fs.TODAY]=oc.MMDDYY,as[fs.VDB]=oc.CoCurrencyDec,as[fs.DB]=oc.CoCurrencyDec,as);var _s=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],Fs=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function Ms(e,r,t){if(2===r.length)return t(e,Vs(e,r[0]),Vs(e,r[1]));throw new fc(Is)}function bs(e,r,t,n){var a=t.iformat,o=n.iformat,i=t.category,u=n.category,c=Ls[i],s=Ls[u],l=c<=s?r[c][s]:r[s][c],f=Ls[l],d=n.decimals>t.decimals?n.decimals:t.decimals;switch(f){case c:return Os(!0,i,a,d);case s:return Os(!0,u,o,d);default:return e.unitlessFormat}}function ws(e,r,t){return bs(e,Fs,r,t)}function Us(e,r,t){var n=r.iformat,a=t.iformat,o=r.category,i=t.category;if(n===a&&o===i&&"Time"===o)return Os(!0,o,n,0);if("Date"===o&&"Time"===i||"Time"===o&&"Date"===i){var u=e.globals.getKnownFormat(oc.MDYHMS);if(!vs(u))throw new fc(u.reason);return Os(!0,u.value.category,u.value.iformat,u.value.decimals)}return bs(e,_s,r,t)}var Ps=function(e){return e.unitlessFormat};function Gs(e,r,t){var n=r.iformat;return n===t.iformat?Os(!0,r.category,n,r.decimals):e.unitlessFormat}function xs(e,r){return Ls[r]===Ls[e.defaultFormat.category]}var Bs=Ss(ds,(function(e){return hs(ms([e]))}),(function(e){return hs(e)}));function Vs(e,r){switch(r.kind){case us.App:var t=r.head;if(t.kind===us.Operator)return function(e,r,t){switch(r){case ss.Mul:case ss.Div:return e.multOrDivTainted=!0,Ms(e,t.args,ws);case ss.Pow:return Ms(e,t.args,ws);case ss.Add:case ss.Sub:return Ms(e,t.args,Us);case ss.Percent:if(1===t.args.length){var n=t.args[0];if(n.kind!==us.Literal||"number"!=typeof n.oper)return e.defaultFormat;var a=Vs(e,n);return Os(a.strongFormat,"Percentage",oc.Percentage,a.decimals)}throw new fc(Is);case ss.Pound:case ss.At:return e.defaultFormat;case ss.Neg:case ss.Pos:if(1===t.args.length)return Vs(e,t.args[0]);throw new fc(Is);case ss.Lt:case ss.Le:case ss.Eq:case ss.Ge:case ss.Gt:case ss.Ne:return Ms(e,t.args,Ps);case ss.Isect:case ss.Union:case ss.Range:case ss.Concat:return Ms(e,t.args,Gs);case ss.And:case ss.Or:case ss.Xor:case ss.Min:case ss.Max:case ss.Dot:throw new fc(Rs);default:return I("calc.analyzer.inferFormat: unexpected operator id",r)}}(e,t.id,r);if((D=t).kind===us.Name&&void 0===D.qualifier){var n=e.config.localeInfo.getWorksheetFuncId(t.whole.toUpperCase());if(void 0!==n){var a=dr(Ds[n],ks.Ignore),o=ls(n),i=gs(r).length;if(L="calc.analyzer.inferFormulaFormat: too few args; formula should be wf.",i>=o.headTypes.length||y(L+": expected condition to be true"),0===o.restTypes.length&&(i=o.headTypes.length),n===fs.HYPERLINK&&(e.hyperlinkTainted=!0),a===ks.Ignore)return e.defaultFormat;if(a===ks.Propagate){if(0===i)return e.defaultFormat;var u=Vs(e,r.args[0]),c=u.iformat,s=u.category,l=u.decimals,f=!xs(e,s);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<i;h+=1){var p=Vs(e,r.args[h]),v=!xs(e,p.category);if(!p.strongFormat&&v)return e.unitlessFormat;d||(c=p.iformat,s=p.category,l=p.decimals,d=v)}return Os(!0,s,c,l)}var g=e.globals.getKnownFormat(a);if(!vs(g))throw new fc(g.reason);return Os(!0,g.value.category,a,g.value.decimals)}}return Vs(e,t);case us.Array:return e.defaultFormat;case us.CellRef:var m=e.resolver.resolveCellRef(e.origin,r.qualifier,r.ref),E=Bs(r.ref,m);if(!vs(E))throw new fc(E.reason);var S=E.value;if(!Cs(S))return e.unitlessFormat;var T=Es(S),C=e.globals.getCellFormat(T);if(!vs(C))throw new fc(C.reason);var R=C.value.iformat,A=C.value.category;return Os(!0,A,R,"Date"!==A&&"Time"!==A&&"Text"!==A&&"Custom"!==A&&"Special"!==A?C.value.decimals:0);case us.Literal:var N=ps(r.oper);switch(N){case cs.String:case cs.Boolean:case cs.Error:case cs.Missing:return e.defaultFormat;case cs.Number:var O=r.oper.toString(),k=O.indexOf(".");l=k>=0?O.length-k-1:0;return Os(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return I("calc.analyze.inferFormat: unexpected literal oper",N)}case us.Name:return e.defaultFormat;case us.Paren:return Vs(e,r.node);case us.Bad:throw new fc(Is);default:return I("calc.analyzer.inferFormat",r)}var L,D}function Ws(e,r,t){try{var n=function(e,r){return{globals:Ns(e),config:e.config,origin:r,defaultFormat:Os(!1,"General",oc.General,0),unitlessFormat:Os(!0,"General",oc.General,0),resolver:Ts(As(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,r),a=Vs(n,t);return C.ULS.traceTag(595948253,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+a),ds(it.__assign({},a,{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof fc?(C.ULS.traceTag(595948254,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+e.reason),e.reason):(C.ULS.traceTag(595948255,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+g(e)),hs((o=e,{kind:ic.JavaScriptError,error:o})))}var o}var Hs,Ks,js=Xt.SpecialPrecs,Js=Xt.precedents;function qs(e){return{findStaticPrecedents:function(e){return Js([],[],js.All,!1)},checkFormula:function(r,t,n,a){return is(e,r,t,n,void 0!==a?a:"undefined")},checkFormulaWithCodes:function(r,t,n){return function(e,r,t,n){return Qc(Xc(e,r,t,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,r,t){return t.push({label:e.label,errorCode:r.code}),t}},!1),n).context.errorData}(e,r,t,n)},findBestFormat:function(r,t){return Ws(e,r,t.node)}}}!function(e){e.WorksheetFunction="WorksheetFunction"}(Hs||(Hs={})),function(e){e.RangeValues="RangeValues"}(Ks||(Ks={}));var Ys=Xt.div0ErrorOper,Xs=Xt.numErrorOper,Qs=Math.pow(2,-52),zs=Math.pow(2,-1022);function Zs(e){return Math.abs(e)<zs?0:e}function $s(e){return isFinite(e)?Zs(e):Xs}var el=Math.pow(2,32)-2;function rl(e,r){var t=Math.pow(e,r);return isFinite(t)?Zs(t):r<0?Ys:Xs}var tl,nl,al,ol={sqrt:function(e){return $s(Math.sqrt(e))},sqrtpi:function(e){return $s(function(e){var r=e*Math.PI;return isFinite(r)?Math.sqrt(r):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return $s(Math.exp(e))},power:function(e,r){return 0===r?0===e?Xs:1:0===e?r<0?Ys:0:e>0?rl(e,r):function(e){if(e<-el||e>el)return!1;if(e===Math.floor(e))return!0;var r=Math.abs(e);return 1+-22.5*Qs<=r&&r<=1+2*Qs}(r)?rl(e,Math.round(r)):Xs},ln:function(e){return $s(Math.log(e))},log10:function(e){return $s(Math.log(e)/Math.LN10)},log:function(e,r){if(e<=0||r<=0)return Xs;var t=Math.log(e)/Math.log(r);return isFinite(t)?Zs(t):Ys},sin:function(e){return Math.abs(e)<Math.pow(2,27)?$s(Math.sin(e)):Xs},cos:function(e){return Math.abs(e)<Math.pow(2,27)?$s(Math.cos(e)):Xs},tan:function(e){return Math.abs(e)<Math.pow(2,27)?$s(Math.tan(e)):Xs},asin:function(e){return $s(Math.asin(e))},acos:function(e){return $s(Math.acos(e))},atan:function(e){return $s(Math.atan(e))},atan2:function(e,r){return 0===e&&0===r?Ys:Zs(Math.atan2(r,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(al||(al={}));var il=(tl=ir(ur,ur)).wrap,ul=tl.unwrap,cl=(nl=ir((function(e){return-e}),(function(e){return-e}))).wrap,sl=nl.unwrap;function ll(e){return e>0}function fl(e){return{kind:e,data:void 0,children:void 0}}function dl(e,r,t){var n=fl(al.Array);return n.children=t,n.data={rows:e,cols:r},n}function hl(e,r){var t=fl(al.Fun);return t.children=r,t.data=e,t}function pl(e,r,t){var n=fl(al.Let);return n.children=[r,t],n.data=e,n}function vl(e,r,t){var n=fl(al.App);return n.children=t,n.data={funName:e,funType:r},n}function gl(e){var r=fl(al.Ident);return r.data=e,r}function ml(e,r,t){var n=fl(al.If);return n.children=[e,r,t],n}function El(e){return"object"!=typeof e||e.kind>0}function Sl(e,r){for(var t,n=0;n<e.length;n+=1){var a=e[n],o=r(a);void 0===t?o!==a&&(t=e.slice(0,n)).push(o):t.push(o)}return void 0!==t?t:e}function Tl(e,r){return Sl(e,function(e){return function(r){return Sl(r,e)}}(r))}function Cl(e,r){return r(function(e,r){if(El(e))return e;switch(e.kind){case al.Let:var t=e.children,n=t[0],a=t[1],o=r(n),i=r(a);return n===o&&a===i?e:pl(e.data,o,i);case al.App:var u=Sl(e.children,r);return u===e.children?e:vl(e.data.funName,e.data.funType,u);case al.If:var c=e.children,s=c[0],l=c[1],f=c[2],d=r(s),h=r(l),p=r(f);return s===d&&l===h&&f===p?e:ml(d,h,p);case al.Fun:var v=r(e.children);return v===e.children?e:hl(e.data,v);case al.Array:var g=Tl(e.children,r);return g===e.children?e:dl(e.data.rows,e.data.cols,g);case al.Name:case al.CellRef:case al.Ident:return e}}(e,(function(e){return Cl(e,r)})))}var Rl=function(){function e(e,r,t){A("calc.common.StrictArray2D",e),A("calc.common.StrictArray2D",r);var n=t.length;n<e&&y("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var a=0;a<n;a+=1){var o=t[a].length;o<r&&y("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+o)}this.rows=e,this.cols=r,this.elements=t}return e.prototype.get=function(e,r){return O("calc.common.StrictArray2D.get",e,this.rows),O("calc.common.StrictArray2D.get",r,this.cols),this.elements[e][r]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var r=this;return new Il(this.rows,this.cols,(function(t,n){return e(r.elements[t][n])}))},e}();var Il=function(){function e(e,r,t){A("calc.common.NonstrictArray2D",e),A("calc.common.NonstrictArray2D",r),this.rows=e,this.cols=r,this.func=t}return e.prototype.get=function(e,r){return O("calc.common.NonstrictArray2D.get",e,this.rows),O("calc.common.NonstrictArray2D.get",r,this.cols),this.func(e,r)},e.prototype.strict=function(){var e=yl(this.rows,this.cols,this.func);return new Rl(this.rows,this.cols,e)},e.prototype.map=function(r){var t=this;return new e(this.rows,this.cols,(function(e,n){return r(t.func(e,n))}))},e}();function yl(e,r,t){for(var n=[],a=0;a<e;a+=1){for(var o=[],i=0;i<r;i+=1)o[i]=t(a,i);n[a]=o}return n}function Al(e){return yl(e.rows,e.cols,e.get.bind(e))}function Nl(e,r,t){for(var n=[],a=[],o=0;o<r;o+=1)a[o]=t;for(var i=0;i<e;i+=1)n[i]=a;return n}function Ol(e,r,t){return new Il(e,r,(function(e,r){return t}))}var kl,Ll=qt.FormulaSource,Dl=rn.ResultKind,_l=rn.isGridCell,Fl=rn.ReasonKind,Ml=rn.notImplemented,bl=rn.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(kl||(kl={}));var wl,Ul,Pl=it.__assign({},Fl,kl);function Gl(e,r){return{config:e,mathpack:r}}function xl(e){return{kind:Pl.IllFormedFormula,message:e}}function Bl(e){return{kind:wl.FinalValue,oper:e}}function Vl(e){return{kind:wl.PendingValue,anchor:e}}function Wl(e,r,t){return r!==Ll.Cell||_l(e.range)||y("calc.runtime.cellFormula: expected single-cell range; given "+g(e)),{kind:wl.Formula,range:e,source:r,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(wl||(wl={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(Ul||(Ul={}));var Hl={kind:Pl.Stopped};function Kl(e){return 0===e.length&&y("calc.runtime.unevaluated: expected nonempty array"),{kind:Pl.Unevaluated,anchors:e}}function jl(e,r,t,n,a,o,i,u,c,s,l,f,d,h,p,v){return void 0===v&&(v=function(e){return Kr(Ml(["getUsedRange"]))}),{config:e,mathpack:r,getDocumentLoc:function(e,r){return Xr(t(e,r))},getSheetIndex:n,getCellValue:a,getCellValues:o,getFirstOrderFunc:i,getNameFormula:u,getCellFormula:c,interruptToken:[Ul.Continue],schedulerInfo:null!=p?p:{},setCellValue:s,setCellValues:l,setCellFailure:f,setDynamicPrecs:d,loadObjects:h,getUsedRange:v}}function Jl(e){return{kind:Pl.NameCycle,names:e}}function ql(e){return{kind:Pl.CellCycle,cells:e}}function Yl(e){return{kind:Pl.PreviousFailure,range:e}}function Xl(e){return{kind:Pl.JavaScriptError,error:e}}function Ql(e){return{kind:Dl.Paused,reason:Pl.Timeout,resume:e}}function zl(e){if(e.kind===Dl.Failure)return e.reason.kind}var Zl=qt.gridCell,$l=Xt.arrayOper,ef=Xt.naErrorOper,rf=Xt.OperKind,tf=rf.Number|rf.String|rf.Boolean|rf.Error|rf.Rich|rf.Array,nf=rf.Number|rf.String|rf.Boolean|rf.Error|rf.Blank|rf.Rich,af=nf|rf.Array;function of(e,r,t){var n=e+": generated Excel error, type "+r+"; "+t;C.ULS.traceTag(596120270,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,n)}function uf(e){return"object"==typeof e&&e.kind===rf.Error}function cf(e){return"object"==typeof e&&e.kind===rf.Blank}function sf(e){return"object"==typeof e&&e.kind===rf.Array}function lf(e){return e.kind===wr.Success?e.value:void 0}function ff(e,r){switch(e.kind){case wr.Success:return Hr(Bl(e.value));case wr.Failure:return Kr(Yl(r))}}function df(e,r,t){var n=sf(t)?function(e,r,t,n,a,o){if(e===t&&r===n)return a;if(1===e&&1===r)return Nl(t,n,void 0===a[0]?o:a[0][0]);var i,u=[];i=1===e?function(e,t){return t<r?a[0][t]:o}:1===r?function(r,t){return r<e?a[r][0]:o}:function(t,n){return t<e&&n<r?a[t][n]:o};for(var c=0;c<t;c+=1){u.push([]);for(var s=0;s<n;s+=1)u[c][s]=i(c,s)}return u}(t.rows,t.cols,e,r,t.opers,ef):Nl(e,r,t);return $l(e,r,n)}function hf(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols,l=pr(t,i),f=pr(n,u);return M(l,f,vr(t+a,i+c)-l,vr(n+o,u+s)-f)}function pf(e){return 0===e.length&&y("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(hf)}function vf(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols,l=vr(t,i),f=vr(n,u),d=pr(t+a,i+c)-l,h=pr(n+o,u+s)-f;if(!(d<=0||h<=0))return M(l,f,d,h)}function gf(e){return e.rows*e.cols}var mf,Ef=zt.NodeKind,Sf=rn.getArguments,Tf=Xt.arrayOper,Cf=$t.WorksheetFuncId,Rf=rn.success,If=(mf=0,function(){var e=mf;return mf+=1,e});function yf(e){return"object"!=typeof e||El(e)&&("object"!=typeof(r=e)||r.kind===rf.Error||r.kind===rf.Array||r.kind===rf.Rich);var r}function Af(e,r,t){var n=Sf(t).map((function(t){return Nf(e,r,t)})),a=$t.getWorksheetFuncType(Cf._UDF);return vl(cl(Cf._UDF),a,[Nf(e,r,t.head)].concat(n))}function Nf(e,r,t){switch(t.kind){case Ef.Array:var n=t.nodes.map((function(t){return t.map((function(t){return Nf(e,r,t)}))}));return m=(v=n).length,E=void 0===v[0]?0:v[0].length,v.every((function(e){return e.every(yf)}))?Tf(m,E,v):dl(m,E,v);case Ef.App:var a=t.head;if(a.kind===Ef.Operator){var o=Sf(t).map((function(t){return Nf(e,r,t)})),i=$t.getOperatorType(a.id);return vl(il(a.id),i,o)}if(a.kind===Ef.Name&&null==a.qualifier)if(null!=(c=e.config.localeInfo.getWorksheetFuncId(a.whole.toLocaleUpperCase()))){var u=void 0;switch(c){case Cf.LET:u=function(e,r,t){if(3===t.args.length){var n=t.args[0];if(n.kind===Ef.Name&&null==n.qualifier){var a=n.whole,o=If(),i=sr(r);return i[a]=o,pl(o,Nf(e,r,t.args[1]),Nf(e,i,t.args[2]))}}}(e,r,t);break;case Cf.FUN:u=function(e,r,t){var n=t.args.slice(0,t.args.length-1);if(n.length>0&&n.every((function(e){return e.kind===Ef.Name&&null==e.qualifier}))){for(var a=n.map((function(e){return e.whole})),o=a.map(If),i=sr(r),u=0;u<a.length;u+=1)i[a[u]]=o[u];return hl(o,Nf(e,i,t.args[n.length-1]))}}(e,r,t);break;case Cf.IF:u=function(e,r,t){var n=t.args;return 3===n.length?ml(Nf(e,r,n[0]),Nf(e,r,n[1]),Nf(e,r,n[2])):2===n.length?ml(Nf(e,r,n[0]),Nf(e,r,n[1]),!1):void 0}(e,r,t);break;default:o=Sf(t).map((function(t){return Nf(e,r,t)})),i=$t.getWorksheetFuncType(c);u=vl(cl(c),i,o)}return void 0===u?Af(e,r,t):u}return Af(e,r,t);case Ef.Paren:return Nf(e,r,t.node);case Ef.Name:var c;if(null==t.qualifier)if(void 0!==(c=r[t.whole]))return gl(c);return f=t.whole,d=t.whole.split("."),h=t.qualifier,(p=fl(al.Name)).data={whole:f.toLocaleUpperCase(),split:d.map((function(e){return e.toLocaleUpperCase()})),qualifier:h},p;case Ef.CellRef:return function(e,r){var t=fl(al.CellRef);return t.data={ref:e,qualifier:r},t}(t.ref,t.qualifier);case Ef.Literal:return t.oper;case Ef.Bad:var s="calc.runtime.compile: unexpected bad node "+g(t);return C.ULS.assertTag(595980820,l.LogCategory.msoulscat_ES_EWAJS,!1,s);default:return I("calc.runtime.compile",t)}var f,d,h,p,v,m,E}var Of=function(e){if(!El(e)&&e.kind===al.App&&!ll(e.data.funName)){var r=sl(e.data.funName);if(r===Cf.IFERROR||r===Cf.IFNA){var t=If(),n=gl(t),a=r===Cf.IFERROR?Cf.ISERROR:Cf.ISNA,o=$t.getWorksheetFuncType(a),i=ml(vl(cl(a),o,[n]),e.children[1],n);return pl(t,e.children[0],i)}}return e};var kf,Lf="__compiledFormulaBrand__";function Df(e,r){return function(e){return e.kind===Lf}(r)?r.term:I(e+": expected known compiled formula type; given "+g(r),r)}function _f(e,r,t,n){var a=Nf(e,cr(),n.node),o=Cl(a,Of);return Rf(function(e){return{kind:Lf,term:e}}(o))}function Ff(e){return{compileFormula:function(r,t,n){return _f(e,0,0,n)}}}function Mf(e,r){return 0==(e&r)}function bf(e,r){return(e|r-1)&~r}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(kf||(kf={}));var wf={kind:kf.Empty};function Uf(e){return e===wf}function Pf(e,r){return{kind:kf.Lf,key:e,value:r}}function Gf(e,r,t,n){return{kind:kf.Br,prefix:e,mask:r,l:t,r:n}}function xf(e,r,t,n){var a=function(e,r){return t=e^r,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)^t>>>1;var t}(e,t),o=bf(e,a),i=Mf(e,a);return Gf(o,a,i?r:n,i?n:r)}var Bf,Vf=wf,Wf=function e(r,t,n){switch(n.kind){case kf.Empty:return Pf(r,t);case kf.Lf:var a=Pf(r,t);return n.key===r?a:xf(r,a,n.key,n);case kf.Br:return function(e,r,t){return bf(e,t)===r}(r,n.prefix,n.mask)?Mf(r,n.mask)?Gf(n.prefix,n.mask,e(r,t,n.l),n.r):Gf(n.prefix,n.mask,n.l,e(r,t,n.r)):xf(r,Pf(r,t),n.prefix,n)}},Hf=function(e,r){for(var t=r;t.kind===kf.Br;)t=Mf(e,t.mask)?t.l:t.r;if(!Uf(t))return e===t.key?t.value:void 0},Kf=qt.FormulaSource,jf=rn.isSheetGridCell,Jf=Yr;function qf(e){throw new Jf(e)}function Yf(e,r,t,n){return{range:e,source:r,precedents:t,visitedCellMap:n}}function Xf(e,r,t,n){if(r===Kf.Cell){if(jf(e))return Yf(e,r,t,n);y("calc.runtime.evalLocals: expected single-cell range; given "+g(e))}return Yf(e,r,t,n)}!function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(Bf||(Bf={}));var Qf={kind:Bf.Default},zf=function(){function e(e){this.context=e,this.latestTransition=Bf.Default}return e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=Bf.Default,Qf},e.prototype.performDependencyTransition=function(e){return this.latestTransition=Bf.Dependency,{kind:Bf.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=Bf.Call,{kind:Bf.Call,machine:e}},e.prototype.performWriteTransition=function(e,r){return this.latestTransition=Bf.Write,{kind:Bf.Write,result:e,locals:r}},e.prototype.performReturnTransition=function(e){return this.latestTransition=Bf.Return,{kind:Bf.Return,result:e}},e}(),Zf={newVisitedMap:ed,visit:function(e,r,t){return rd(id,e,r,t)},unVisit:function(e,r,t){return td(id,e,r,t)},lookup:function(e,r){return nd(id,e,r)},runFrom:function(e,r){return ad(id,e,r)}},$f={newVisitedMap:ed,visit:function(e,r,t){return rd(ud,e,r,t)},unVisit:function(e,r,t){return td(ud,e,r,t)},lookup:function(e,r){return nd(ud,e,r)},runFrom:function(e,r){return ad(ud,e,r)}};function ed(){return{run:[],visited:cr()}}function rd(e,r,t,n){var a=e(r);n.visited[a]=t,n.run.push([a,r])}function td(e,r,t,n){var a=e(r);n.visited[a]=t,n.run.pop()}function nd(e,r,t){return t.visited[e(r)]}function ad(e,r,t){for(var n=[],a=t.run,o=0;o<a.length;){var i=a[o][0];if(e(r)===i)break;o+=1}for(;o<a.length;)n.push(a[o][1]),o+=1;return n}function od(e){var r=e.document,t=e.index,n="$";return null!=r.path&&(n+=r.path),n+=";",n+=r.name,n+=";",null!=t&&(n+=t,n+=";"),n}function id(e){var r=od(e.scope);return r+=";",r+=e.name}function ud(e){var r=od(e.sheet);return r+=";",r+=e.range.row,r+=";",r+=e.range.col}var cd=Xt.SpecialPrecs,sd=Xt.precedents,ld=Xt.OperKind,fd=rn.failure,dd=rn.sheetGridRangeAnchor,hd=rn.success,pd=rn.ResultKind,vd=function(e){function r(r,t){var n=e.call(this,r)||this;return n.cell=t,n.locals=void 0,n}return it.__extends(r,e),r.prototype.getRealReason=function(e){if(e.kind!==Pl.PreviousFailure)return e;var r=dd(e.range),t=$f.lookup(r,this.context.visitedCellMap);return"object"==typeof t&&t.kind===pd.Failure?t.reason:e},r.prototype.visitAnchor=function(e){var r=dd(e.range),t=$f.lookup(r,this.context.visitedCellMap);if(null!=t){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+g(r)+"; given "+g(t));return C.ULS.assertTag(595980812,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}$f.visit(r,wl.PendingValue,this.context.visitedCellMap);var a=sd([],[],cd.None,!0);return this.locals=Xf(e.range,e.source,a,this.context.visitedCellMap),this.locals},r.prototype.unVisitAnchor=function(e){var r=this.locals;if(null!=r){var t=dd(r.range);return $f.unVisit(t,e,this.context.visitedCellMap),this.locals=void 0,r}},r.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===pd.Failure)return this.performReturnTransition(fd(this.getRealReason(e.reason)));var r=e.value;if(r.kind===wl.FinalValue)return this.performReturnTransition(hd(r.oper));var t=this.context.globals.getCellFormula(r.anchor);if(t.kind===pd.Failure){var n="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return C.ULS.assertTag(595980813,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=t.value;if(null==a){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+g(r.anchor)+") != null");return C.ULS.assertTag(595980814,l.LogCategory.msoulscat_ES_EWAJS,!1,n)}var o=this.visitAnchor(a),i=this.context.createFormulaEvaluationMachine(this.context,o,a.formula);return this.performCallTransition(i)},r.prototype.receiveSuccess=function(e){var r=e.value;if("object"==typeof r&&(r.kind===ld.Range||r.kind===ld.Missing)){var t="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+g(r));return C.ULS.assertTag(595980815,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}var n=this.unVisitAnchor(void 0);if(null==n){t="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return C.ULS.assertTag(595980816,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}return this.performWriteTransition(e,n)},r.prototype.receiveFailure=function(e){var r=this.getRealReason(e.reason);if(r.kind===Pl.Unevaluated){var t="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+g(r));return C.ULS.assertTag(595980817,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}var n=r===e.reason?e:fd(r),a=this.unVisitAnchor(n);if(null==a){t="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return C.ULS.assertTag(595980818,l.LogCategory.msoulscat_ES_EWAJS,!1,t)}return this.performWriteTransition(n,a)},r.prototype.cleanup=function(){this.unVisitAnchor(void 0)},r}(zf);function gd(e,r){return new vd(e,r)}function md(e,r){for(var t=Wh(e),n=[],a=0;a<r.length;a+=1)n.push(gd(t.machineContext,r[a]));return new jh(t,n)}var Ed=qt.FormulaSource,Sd=qt.sheetGridCell,Td=qt.sheetGridRange,Cd=Xt.OperKind,Rd=Xt.ErrorType,Id=Xt.refErrorOper,yd=Xt.valueErrorOper,Ad=Xt.arrayOper,Nd=rn.ResultKind,Od=rn.isGridCell,kd=rn.isSheetIndex,Ld=rn.getArgType;function Dd(e,r){if($f.lookup(e,r.visitedCellMap)===wl.PendingValue)return qf(ql($f.runFrom(e,r.visitedCellMap)))}function _d(e,r,t,n){r.precedents.cells.push(t);var a=e.getCellValue(t);if(a.kind===Nd.Failure)return qf(a.reason);var o=a.value;if(o.kind===wl.FinalValue)return o.oper;Dd(o.anchor,r),n.push(o.anchor)}function Fd(e,r,t,n){r.precedents.cells.push(t);var a=e.getCellValues(t);if(a.kind===Nd.Failure)return qf(a.reason);var o=n.length,i=function(e,r,t){for(var n=[],a=r.length,o=0,i=0;i<a;i+=1){n.push([]);var u=r[i].length;o=0===o?u:Math.min(u,o);for(var c=0;c<u;c+=1){var s=r[i][c];wl.FinalValue===s.kind?n[i][c]=s.oper:(Dd(s.anchor,e),t.push(s.anchor),n[i][c]=Id)}}return new Rl(a,o,n)}(r,a.value,n);return o===n.length?i:void 0}function Md(e,r,t,n){var a=Fd(e,r,t,n);if(null!=a)return Ad(a.rows,a.cols,Al(a.map((function(e){return cf(e)?0:e}))))}function bd(e,r,t,n,a){if(0!=(n&Cd.Range))return t;if("object"!=typeof t||t.kind!==Cd.Range)return t;var o=t.sheets;if(!kd(o))return of("calc.runtime.dereference",Rd.REF,"3D range, oper = "+g(t)),Id;if(1!==t.ranges.length)return of("calc.runtime.dereference",Rd.VALUE,"union range, oper = "+g(t)),yd;var i=t.ranges[0];if(0!=(n&nf)){if(Od(i))return _d(e,r,Sd(o,i),a);if(r.source===Ed.Cell&&!dt(ot.CalcSupportDynamicArrays)&&!dt(ot.CalcPreventSpillingHack)){var u=function(e,r){var t=e.row,n=e.col,a=r.row,o=r.col,i=r.rows,u=r.cols,c=a<=t&&t<a+i,s=o<=n&&n<o+u;return c&&s?Zl(t,n):c&&1===u?Zl(t,o):s&&1===i?Zl(a,n):void 0}(r.range.range,i);return null==u?(of("calc.runtime.dereference",Rd.VALUE,"empty intersection, oper = "+g(t)),yd):_d(e,r,Sd(o,u),a)}return Md(e,r,Td(o,i),a)}return 0!=(n&Cd.Array)?Md(e,r,Td(o,i),a):(of("calc.runtime.dereference",Rd.VALUE,"bad target type "+n),yd)}function wd(e,r,t,n){for(var a=[],o=0;o<t.length;o+=1){var i=bd(e,r,t[o],Ld(n,o),a);null!=i&&(t[o]=i)}if(a.length>0)return qf(Kl(a))}var Ud=Xt.OperKind,Pd=Xt.valueErrorOper,Gd=Xt.arrayOper,xd=rn.operKind,Bd=rn.notImplemented,Vd=[Pd,0,"",!1,!1],Wd=Ud.Number|Ud.String|Ud.Boolean;function Hd(e){var r=e&Wd;return Vd[r&-r]}function Kd(e,r,t){var n=function e(r,t,n){if("number"==typeof t)return 0!=(n&Ud.Number)?t:0!=(n&Ud.String)?r.formatNumber(t):0!=(n&Ud.Boolean)?0!==t:0!=(n&Ud.Array)?Gd(1,1,[[t]]):Pd;if("string"==typeof t){if(0!=(n&Ud.String))return t;if(0!=(n&Ud.Number)){if(0===t.length)return Pd;var a=r.parseNumber(t);if(Wr(a))return a;throw new Jf(Bd(["string -> number coercion: "+g(zt.literalNode(t))]))}return 0!=(n&Ud.Boolean)?0===r.stringCompareCI(t,r.trueName)||0!==r.stringCompareCI(t,r.falseName)&&Pd:Pd}if("boolean"==typeof t)return 0!=(n&Ud.Boolean)?t:0!=(n&Ud.Number)?t?1:0:0!=(n&Ud.String)?t?r.trueName:r.falseName:Pd;if(0!=(n&t.kind))return t;switch(t.kind){case Ud.Error:return t;case Ud.Missing:return 0!=(n&Ud.Blank)?Xt.blankOper:Hd(n);case Ud.Blank:return Hd(n);case Ud.Rich:return e(r,t.getFallback(),n);default:return Pd}}(e.config.localeInfo,r,t);return uf(n)&&!uf(r)&&of("calc.runtime.coerceOper",n.type,"kind = "+xd(r)),n}var jd=qt.sheetIndex,Jd=Xt.OperKind,qd=Xt.rangeSeqOper,Yd=Xt.ErrorType,Xd=Xt.valueErrorOper,Qd=Xt.div0ErrorOper,zd=Xt.nullErrorOper,Zd=$t.OperatorId,$d=rn.operKind,eh=rn.isSheetIndex,rh=rn.isDocumentLocEqual;function th(e,r){switch(e){case Zd.Eq:return 0===r;case Zd.Ne:return 0!==r;case Zd.Lt:return r<0;case Zd.Gt:return r>0;case Zd.Le:return r<=0;case Zd.Ge:return r>=0}}function nh(e,r,t){return th(e,r-t)}function ah(e,r,t){return th(e,r.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase()))}function oh(e,r,t){return th(e,r<t?-1:r>t?1:0)}function ih(e,r,t){if(eh(r.sheets))if(eh(t.sheets))if(rh(r.sheets.document,t.sheets.document)){if(r.sheets.index===t.sheets.index)return jd(r.sheets.document,r.sheets.index);n="different sheet, range1 = "+g(r)+", range2 = "+g(t);of(e,Yd.VALUE,n)}else{var n="different document, range1 = "+g(r)+", range2 = "+g(t);of(e,Yd.VALUE,n)}else of(e,Yd.VALUE,"3D reference, range2 = "+g(t));else of(e,Yd.VALUE,"3D reference, range1 = "+g(r))}function uh(e,r,t){if(1===t.length){var n=t[0];switch(r){case Zd.Percent:return Zs(n/100);case Zd.Neg:return-n;case Zd.Pos:return n;default:var a="bad application of "+r+" to 1 argument";return of("calc.runtime.applyOperator",Yd.VALUE,a),Xd}}if(2===t.length){n=t[0];var o=t[1];switch(r){case Zd.Add:return $s(n+o);case Zd.Sub:return $s(n-o);case Zd.Mul:return $s(n*o);case Zd.Div:return 0===o?(of("calc.runtime.applyOperator",Yd.DIV0,"division by zero"),Qd):$s(n/o);case Zd.Pow:return e.mathpack.power(n,o);case Zd.Concat:return n+o;case Zd.Eq:case Zd.Ne:case Zd.Lt:case Zd.Le:case Zd.Gt:case Zd.Ge:return function(e,r,t){var n=$d(r),a=$d(t);if(n!==a){if(n===Jd.Blank)switch(a){case Jd.Number:return oh(e,0,t);case Jd.String:return ah(e,"",t);case Jd.Boolean:return nh(e,!1,t)}if(a===Jd.Blank)switch(n){case Jd.Number:return oh(e,r,0);case Jd.String:return ah(e,r,"");case Jd.Boolean:return nh(e,r,!1)}return th(e,n-a)}switch(n){case Jd.Number:return oh(e,r,t);case Jd.String:return ah(e,r,t);case Jd.Boolean:return nh(e,r,t);case Jd.Blank:return th(e,0);default:return!1}}(r,n,o);case Zd.Range:return function(e,r){var t=ih("calc.runtime.applyRangeOp",e,r);if(null==t)return Xd;var n=[hf(pf(e.ranges),pf(r.ranges))];return qd(t,n)}(n,o);case Zd.Isect:return function(e,r){var t=ih("calc.runtime.applyIsectOp",e,r);if(null==t)return Xd;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var o=0;o<r.ranges.length;o+=1){var i=vf(e.ranges[a],r.ranges[o]);null!=i&&n.push(i)}if(0===n.length){var u="empty intersection, range1 = "+g(e)+", range2 = "+g(r);return of("calc.runtime.applyIsectOp",Yd.NULL,u),zd}return qd(t,n)}(n,o);case Zd.Union:return null==(s=ih("calc.runtime.applyUnionOp",u=n,c=o))?Xd:qd(s,u.ranges.concat(c.ranges));case Zd.And:return n&&o;case Zd.Or:return n||o;case Zd.Xor:return n!==o;case Zd.Min:return Math.min(n,o);case Zd.Max:return Math.max(n,o);default:var i="bad application of "+r+" to 2 arguments";return of("calc.runtime.applyOperator",Yd.VALUE,i),Xd}}var u,c,s,l="bad application of "+r+" to "+t.length+" arguments";return of("calc.runtime.applyOperator",Yd.VALUE,l),Xd}var ch=qt.sheetIndex,sh=qt.sheetGridRange,lh=Xt.arrayOper,fh=Xt.nameErrorOper,dh=Xt.naErrorOper,hh=Xt.numErrorOper,ph=Xt.valueErrorOper,vh=Xt.OperKind,gh=Xt.ErrorType,mh=Xt.SpecialPrecs,Eh=$t.functionType,Sh=$t.FunctionFlags,Th=$t.SignatureType,Ch=$t.WorksheetFuncId,Rh=$t.getOperatorType,Ih=$t.getWorksheetFuncType,yh=rn.operKind,Ah=rn.ResultKind,Nh=rn.success,Oh=rn.getArgType,kh=rn.isValidArgsLength,Lh=vh.Number|vh.String|vh.Boolean|vh.Rich|vh.Error|vh.Blank,Dh=Eh(3,[vh.Boolean,Lh,Lh],[],Th.All,mh.None,Sh.None),_h=function(){function e(e,r){this.globals=e,this.locals=r}return e.prototype.getMathpack=function(){return this.globals.mathpack},e.prototype.applyFunction=function(e,r){var t=Ih(e),n=r.some((function(e){return"object"==typeof e&&e.kind===vh.Range}))?r.slice(0):r;return wd(this.globals,this.locals,n,t),this.runFunctionToCompletion(cl(e),t,n)},e.prototype.applyOperatorOrFunction=function(e,r){if(ll(e))return uh(this.globals,ul(e),r);var t=sl(e);if(t===Ch._UDF)return qf(Ml(["call UDF"]));var n=this.globals.getFirstOrderFunc(t);if(n.kind===Ah.Failure)return qf(n.reason);var a=n.value;if(null==a){var o="nonexistent worksheet function "+t;return of("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",gh.NAME,o),fh}var i=a(this,r);if("object"==typeof i&&i.kind===vh.Error){o="worksheet function "+t+" return value";of("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.type,o)}return i},e.prototype.arrayLift=function(e,r,t){for(var n=this,a=0,o=0,i=0;i<t.length;i+=1){var u=t[i];sf(u)&&0==(Oh(e,i)&vh.Array)?(a=Math.max(a,u.rows),o=Math.max(o,u.cols)):(a=Math.max(a,1),o=Math.max(o,1))}var c=t.map((function(r,t){return n.broadcastOper(a,o,r,Oh(e,t))})),s=new Il(a,o,(function(e,t){return r(c.map((function(r){return r.get(e,t)})))})).map((function(e){var r;if("object"!=typeof(r="object"==typeof e&&e.kind===Hs.WorksheetFunction?n.runFunctionMachineToCompletion(e):e))return r;switch(r.kind){case vh.Range:return ph;case vh.Missing:case vh.Blank:return 0;default:return r}}));return lh(s.rows,s.cols,Al(s))},e.prototype.dispatchFunction=function(e,r,t){var n=this;if(!kh(r,t.length)){var a=JSON.stringify(r),o="bad application of "+JSON.stringify(e)+" to "+t.length+" arguments, ftype = "+a;return of("calc.runtime.FunctionDispatcher.dispatchFunction",gh.NUM,o),hh}for(var i=t.length,u=Th.None,c=0;c<i;c+=1){var s=yh(t[c]);0==(s&Oh(r,c))&&(u|=s)}if(u===Th.None)return this.applyOperatorOrFunction(e,t);if(0!=(u&vh.Array)){return this.arrayLift(r,(function(t){return n.dispatchFunction(e,r,t)}),t)}u&=~vh.Array;var l=[];for(c=0;c<i;c+=1){var f=t[c];if(0!=(u&yh(f))){var d=Oh(r,c);if(f=this.coerceOper(f,d),yh(f)===vh.Error&&0==(d&vh.Error))return f}l[c]=f}return this.applyOperatorOrFunction(e,l)},e.prototype.dispatchStrictIf=function(e){var r=this,t=e[0];if("object"!=typeof t){var n=this.coerceOper(t,vh.Boolean);return!0===n?e[1]:!1===n?e[2]:n}switch(t.kind){case vh.Error:return t;case vh.Missing:case vh.Blank:return e[2];case vh.Array:return this.arrayLift(Dh,(function(e){return r.dispatchStrictIf(e)}),e);case vh.Rich:return qf(Ml(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case vh.Range:var a="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+g(t));return C.ULS.assertTag(595980809,l.LogCategory.msoulscat_ES_EWAJS,!1,a);default:return I("calc.runtime.FunctionDispatcher.dispatchStrictIf",t)}},e.prototype.dereferenceOper=function(e,r){return function(e,r,t,n){var a=[],o=bd(e,r,t,n,a);if(null==o){if(a.length>0)return qf(Kl(a));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+g(t);return C.ULS.assertTag(595980819,l.LogCategory.msoulscat_ES_EWAJS,!1,i)}return o}(this.globals,this.locals,e,r)},e.prototype.dereferenceOpers=function(e,r){wd(this.globals,this.locals,e,r)},e.prototype.dereferenceAllOpers=function(e){for(var r=[],t=[],n=0;n<e.length;n+=1){var a=e[n];if("object"==typeof a&&a.kind===vh.Range){for(var o=[],i=a.sheets,u=i.index,c=i.length,s=0;s<c;s+=1)for(var l=ch(a.sheets.document,s+u),f=0;f<a.ranges.length;f+=1){var d=sh(l,a.ranges[f]),h=Fd(this.globals,this.locals,d,r);null!=h&&o.push(h)}t.push({kind:Ks.RangeValues,arrays:o})}else t.push(a)}return r.length>0?qf(Kl(r)):t},e.prototype.makeOperatorReducer=function(e,r){var t=this.getBinaryOperator(e);return function(e,n){return void 0===e?null!=r?r(n):n:t(e,n)}},e.prototype.makeBranchOperatorReducer=function(e,r){var t=this;return function(n,a){var o=t.makeOperatorReducer(e,r)(n,a);return void 0!==n&&!0===o?n:a}},e.prototype.reduceDerefOpers=function(e,r,t){function n(t,n){if(sf(n))return a(t,new Rl(n.rows,n.cols,n.opers));var o=r(n);return null==o?t:e(t,o)}function a(e,r){for(var t=e,a=0;a<r.rows;a+=1)for(var o=0;o<r.cols;o+=1)t=n(t,r.get(a,o));return t}return t.reduce((function(e,r){return"object"==typeof r&&r.kind===Ks.RangeValues?r.arrays.reduce(a,e):n(e,r)}),void 0)},e.prototype.broadcastOper=function(e,r,t,n){if("object"!=typeof t)return Ol(e,r,t);switch(t.kind){case vh.Missing:case vh.Blank:return Ol(e,r,0);case vh.Array:return 0!=(n&vh.Array)?Ol(e,r,t):function(e,r,t,n){return t.rows===e&&t.cols===r?t:1===t.rows&&1===t.cols?Ol(e,r,t.get(0,0)):1===t.rows?new Il(e,r,(function(e,r){return r<t.cols?t.get(0,r):n})):1===t.cols?new Il(e,r,(function(e,r){return e<t.rows?t.get(e,0):n})):new Il(e,r,(function(e,r){return e<t.rows&&r<t.cols?t.get(e,r):n}))}(e,r,new Rl(t.rows,t.cols,t.opers),dh);case vh.Range:default:return Ol(e,r,t)}},e.prototype.coerceOper=function(e,r){return Kd(this.globals,e,r)},e.prototype.getBinaryOperator=function(e){var r=this,t=Rh(e),n=[0,0];return function(a,o){return n[0]=a,n[1]=o,wd(r.globals,r.locals,n,t),r.runFunctionToCompletion(il(e),t,n)}},e.prototype.getUnaryOperator=function(e){var r=this,t=Rh(e),n=[0];return function(a){return n[0]=a,wd(r.globals,r.locals,n,t),r.runFunctionToCompletion(il(e),t,n)}},e.prototype.runFunctionToCompletion=function(e,r,t){var n=this.dispatchFunction(e,r,t);return"object"==typeof n&&n.kind===Hs.WorksheetFunction?this.runFunctionMachineToCompletion(n):n},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var r=e.next();if(null!=r)return r}},e}(),Fh=function(e){function r(r,t){var n=e.call(this,r)||this;return n.func=t,n}return it.__extends(r,e),r.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition(Nh(e))},r.prototype.receiveSuccess=function(e){return C.ULS.assertTag(595980810,l.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case Pl.Unevaluated:for(var t=[],n=r.anchors,a=n.length-1;a>=0;a-=1){var o=this.context.createCellEvaluationMachine(this.context,n[a]);t.push(o)}return this.performDependencyTransition(t);default:return this.performReturnTransition(e)}},r}(zf);function Mh(e,r){return new Fh(e,r)}var bh=qt.FormulaSource,wh=Xt.naErrorOper,Uh=rn.failure,Ph=rn.ResultKind,Gh=rn.createResolver;function xh(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Date.now()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function Bh(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var r=Date.now()+e.yieldIntervalMs;return void 0===e.endTimeMs?r:Math.min(e.endTimeMs,r)}}var Vh={kind:Pl.Timeout};function Wh(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Date.now()>=e}},machineContext:Hh(e)}}function Hh(e){return{globals:e,visitedCellMap:$f.newVisitedMap(),resolver:Gh(e),createCellEvaluationMachine:gd,createFormulaEvaluationMachine:Sp,createFunctionEvaluationMachine:Mh}}var Kh,jh=function(){function e(e,r){N("calc.runtime.EvaluationRuntime",r.length),this.context=e,this.inputMachines=r.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var r=this;if(this.context.globals.interruptToken[0]===Ul.Stop)return this.generatePartialResults(),C.ULS.traceTag(595953880,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var t=this.evaluate(Bh(e));return t instanceof Array?(C.ULS.traceTag(595953881,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(t)):(C.ULS.traceTag(595953882,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise((function(t){return e.scheduleFunction((function(){return C.ULS.traceTag(595964228,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),t(r.evaluateAsync(e))}))})))}catch(e){return Promise.reject(Uh(e))}},e.prototype.evaluateSync=function(e){var r=this,t=function(n){if(r.context.globals.interruptToken[0]===Ul.Stop||r.context.timer.doTimeout(e.endTimeMs))return r.generatePartialResults(),r.results;var a=r.evaluate(n);return a instanceof Array?a:Ql((function(r){return t(void 0!==r?r:Bh(e))}))};return t(Bh(e))},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return Vh;var r=this.evaluationStack[this.evaluationStack.length-1],t=this.evaluateMachine(r);switch(this.currentResult=void 0,t.kind){case Bf.Default:break;case Bf.Dependency:for(var n=0;n<t.machines.length;n+=1)this.evaluationStack.push(t.machines[n]);break;case Bf.Call:this.evaluationStack.push(t.machine);break;case Bf.Return:case Bf.Write:this.performResultTransition(t);break;case Pl.JavaScriptError:this.stopEvaluatingWithJavaScriptError(t);break;default:return I("calc.runtime.EvaluationRuntime.evaluate",t)}}}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return C.ULS.assertTag(595980807,l.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===Ph.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof Jf))return Xl(e);this.currentResult=Uh(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Xl(e)}},e.prototype.performResultTransition=function(e){if(e.kind===Bf.Write)try{this.writeResult(e.locals,e.result)}catch(e){return this.stopEvaluatingWithJavaScriptError(Xl(e))}var r=this.evaluationStack.pop();if(null!=r&&r.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===Ph.Success){(t=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Bf.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var t;if((t=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Bf.Dependency)break;if(t.latestTransition===Bf.Call){this.currentResult=e.result;break}var n=this.evaluationStack.pop();null!=n&&n.cleanup()}if(0===this.evaluationStack.length){var a="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+g(e.result));return C.ULS.assertTag(595980808,l.LogCategory.msoulscat_ES_EWAJS,!1,a)}}},e.prototype.writeResult=function(e,r){switch(r.kind){case Ph.Success:this.setFormulaValue(e,r.value);break;case Ph.Failure:this.context.globals.setCellFailure(e.range,r.reason)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,r){var t=cf(r)?0:r;if(e.source===bh.Cell){if(sf(t)){var n=void 0===t.opers[0]?wh:t.opers[0][0];return this.context.globals.setCellValue(e.range,n)}return this.context.globals.setCellValue(e.range,t)}var a=e.range.range,o=df(a.rows,a.cols,t).opers;return this.context.globals.setCellValues(e.range,o)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,r=0;r<e;r+=1)this.results.push(Uh(Hl))},e.prototype.stopEvaluatingWithJavaScriptError=function(e){for(;;){var r=this.evaluationStack.pop();if(null==r)break;r.cleanup()}this.results.push(Uh(e))},e}(),Jh=qt.documentScope,qh=qt.nameLoc,Yh=qt.sheetIndex,Xh=qt.sheetRange,Qh=qt.gridCell,zh=qt.FormulaSource,Zh=zt.documentQualifier,$h=zt.QualifierKind,ep=zt.PosKind,rp=zt.CellRefKind,tp=Xt.ErrorType,np=Xt.nameErrorOper,ap=Xt.refErrorOper,op=Xt.OperKind,ip=Xt.arrayOper,up=Xt.range3DOper,cp=Xt.rangeSeqOper,sp=rn.gridCellRange,lp=rn.ResultKind,fp=rn.success,dp=rn.failure,hp=rn.sheetGridRangeAnchor,pp=rn.createResolutionHandler,vp=rn.createNameFinder,gp=[void 0,np],mp=Vf;!function(e){e.Document="document",e.Sheet="sheet",e.Ident="sheet, then document"}(Kh||(Kh={}));var Ep=function(e){function r(r,t,n){var a=e.call(this,r)||this;return a.nameEvaluator=pp(vp((function(e){var r=a.getNameFormulaAsTerm(a.locals,e);return void 0!==r&&a.checkForNameCycle(e,a.visitedNameMap),r}),gp),(function(e){var r="name resolution; qualifier = "+g(e);return of("calc.runtime.FormulaEvaluationMachine.evalName",tp.NAME,r),gp}),qf),a.cellEvaluator=pp((function(e){return up(e.sheet,e.range)}),(function(e){var r="error ref, qualifier = "+g(e.data.qualifier);return of("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",tp.REF,r),ap}),qf),a.term=Df("calc.runtime.FormulaEvaluationMachine",n),a.locals=t,a.continuation=[],a.env=mp,a.visitedNameMap=Zf.newVisitedMap(),a.dispatcher=new _h(a.context.globals,t),a}return it.__extends(r,e),r.prototype.next=function(){if(El(this.term)){var e=this.continuation;if(0===e.length){var r=this.dispatcher.dereferenceOper(this.term,af),t=this.dispatcher.coerceOper(r,af);return dt(ot.CalcPreventSpillingHack)&&this.locals.source===zh.Cell&&sf(t)&&(1!==t.rows||1!==t.cols)?this.performReturnTransition(dp(Ml(["spilling"]))):this.performReturnTransition(fp(t))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},r.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case Pl.Unevaluated:for(var t=[],n=r.anchors,a=n.length-1;a>=0;a-=1){var o=this.context.createCellEvaluationMachine(this.context,n[a]);t.push(o)}return this.performDependencyTransition(t);default:return this.performReturnTransition(e)}},r.prototype.applyContinuation=function(e,r){var t=r.context;switch(t.kind){case al.App:var n=r.holeIndex,a=t.children.length;if((c=r.locals)[n]=e,n+1<a)return this.nextHoleTransition(r,t.children[n+1]);var o=t.data.funName,i=t.data.funType;this.dispatcher.dereferenceOpers(c,i);var u=this.dispatcher.dispatchFunction(o,i,c);return"object"==typeof u&&u.kind===Hs.WorksheetFunction?this.evaluateFunctionTransition(u,r.env):this.popContextTransition(r.env,u);case al.If:var c;if(0===(n=r.holeIndex)){var s=this.dispatcher.dereferenceOper(e,op.Boolean);if("object"!=typeof s){var f=this.dispatcher.coerceOper(s,op.Boolean),d=!0===f?t.children[1]:!1===f?t.children[2]:f;return this.popContextTransition(r.env,d)}switch(s.kind){case op.Error:return this.popContextTransition(r.env,s);case op.Missing:case op.Blank:return this.popContextTransition(r.env,t.children[2]);case op.Array:return r.locals=[s],this.nextHoleTransition(r,t.children[n+1]);case op.Rich:return this.performReturnTransition(dp(Ml(["IF with a rich value condition"])));case op.Range:var h="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+g(s));return C.ULS.assertTag(595980811,l.LogCategory.msoulscat_ES_EWAJS,!1,h);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",s)}}if((c=r.locals)[n]=e,1===n)return this.nextHoleTransition(r,t.children[n+1]);this.dispatcher.dereferenceOpers(c,Dh);var p=this.dispatcher.dispatchStrictIf(c);return this.popContextTransition(r.env,p);case al.Name:var v=r.locals;return Zf.unVisit(v,void 0,this.visitedNameMap),this.popContextTransition(r.env,e);case al.Let:var m=t.data,E=e,S=r.env;return this.popContextTransition(Wf(m,E,S),t.children[1]);case al.Array:var T=this.dispatcher.dereferenceOper(e,tf),R=t.data,y=R.rows,A=R.cols,N=r.holeIndex,O=N%A,k=A===O+1,L=(N-O)/A,D=r.locals;if(D[L][O]=this.dispatcher.coerceOper(T,tf),y===L+1&&k)return this.popContextTransition(r.env,ip(y,A,D));var _=k?L+1:L,F=k?0:O+1;return this.nextHoleTransition(r,t.children[_][F]);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation",t)}},r.prototype.reduceFormula=function(e){switch(e.kind){case al.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,e));case al.App:var r=e.data.funName;if(!ll(r)){var t=this.context.globals.getFirstOrderFunc(sl(r));if(t.kind===lp.Failure)return qf(t.reason)}if(0===e.children.length){var n=this.dispatcher.dispatchFunction(r,e.data.funType,[]);return"object"==typeof n&&n.kind===Hs.WorksheetFunction?this.evaluateFunctionTransition(n,void 0):this.updateTermTransition(n)}return this.pushContextTransition(e,e.children[0],[]);case al.If:case al.Let:return this.pushContextTransition(e,e.children[0],void 0);case al.Name:var a=this.evalName(this.locals,e.data.qualifier,e.data.whole,this.visitedNameMap);return void 0!==a[0]?this.pushContextTransition(e,a[1],a[0]):this.updateTermTransition(a[1]);case al.Ident:var o=Hf(e.data,this.env);if(null==o){var i="undefined local "+e.data;of("calc.runtime.FormulaEvaluationMachine.reduceFormula",tp.NAME,i)}return this.updateTermTransition(void 0===o?np:o);case al.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case al.Fun:return this.performReturnTransition(dp(Ml(["Step: FunNode to closure"])));default:return I("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},r.prototype.pushContextTransition=function(e,r,t){var n=function(e,r,t){return{context:e,holeIndex:0,env:r,locals:t}}(e,this.env,t);return this.continuation[this.continuation.length]=n,this.updateTermTransition(r)},r.prototype.popContextTransition=function(e,r){return this.env=e,this.continuation.pop(),this.updateTermTransition(r)},r.prototype.evaluateFunctionTransition=function(e,r){void 0!==r&&(this.env=r,this.continuation.pop());var t=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(t)},r.prototype.nextHoleTransition=function(e,r){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(r)},r.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},r.prototype.evalDocumentQualifier=function(e){var r=this.context.globals.getDocumentLoc(e.path,e.document);return null!=r?r:Kh.Document},r.prototype.getSheetIndex=function(e,r){var t=this.context.globals.getSheetIndex(e,r);return t.kind===lp.Failure?qf(t.reason):null==t.value?void 0:t.value},r.prototype.evalSheetQualifier=function(e,r){var t=null==r.document?e.range.sheet.document:this.evalDocumentQualifier(r.document);if("string"==typeof t)return t;var n=this.getSheetIndex(t,r.sheet);return null==n?Kh.Sheet:Yh(t,n)},r.prototype.evalNameQualifier=function(e,r){var t;switch(r.kind){case $h.Document:return"string"!=typeof(t=this.evalDocumentQualifier(r))?Jh(t):t;case $h.Sheet:return this.evalSheetQualifier(e,r);case $h.Ident:t=e.range.sheet.document;var n=this.getSheetIndex(t,r.name);return null!=n?Yh(t,n):"string"!=typeof(t=this.evalDocumentQualifier(Zh(r.name)))?Jh(t):Kh.Ident;default:return I("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",r)}},r.prototype.getNameFormulaAsTerm=function(e,r){e.precedents.names.push(r);var t=this.context.globals.getNameFormula(r);if(t.kind===lp.Failure)return qf(t.reason);var n=t.value;return null!=n?Df("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},r.prototype.checkNameCycle=function(e,r,t){return void 0!==Zf.lookup(e,t)?qf(Jl(Zf.runFrom(e,t))):(Zf.visit(e,!0,t),[e,r])},r.prototype.checkForNameCycle=function(e,r){if(void 0!==Zf.lookup(e,r))return qf(Jl(Zf.runFrom(e,r)));Zf.visit(e,!0,r)},r.prototype.evalName=function(e,r,t,n){if(dt(ot.CalcUnifyRangeResolutionCode)){var a=hp(e.range),o=this.context.resolver.resolveName(a,r,t);return this.nameEvaluator(r,o)}if(null==r||r.kind===$h.Relative){var i=e.range.sheet,u=qh(i,t);if(null!=(l=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,l,n);if(u=qh(Jh(i.document),t),null!=(l=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,l,n);var c="name resolution; qualifier = "+g(r);return of("calc.runtime.FormulaEvaluationMachine.evalName",tp.NAME,c),[void 0,np]}var s=this.evalNameQualifier(e,r);if("string"!=typeof s){var l;u=qh(s,t);if(null!=(l=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,l,n);var f=null==s.index?"document":"sheet",d="name resolution, qualifier = "+g(r)+", resolved to "+f;return of("calc.runtime.FormulaEvaluationMachine.evalName",tp.NAME,d),[void 0,np]}var h="qualifier resolution, qualifier = "+g(r)+", failed on "+s;return of("calc.runtime.FormulaEvaluationMachine.evalname",tp.NAME,h),[void 0,np]},r.prototype.evalPos=function(e,r){return r.kind===ep.Abs?r.index:e+r.index},r.prototype.evalCellRefSingle=function(e,r){return Qh(this.evalPos(e.row,r.row),this.evalPos(e.col,r.col))},r.prototype.evalCellRef=function(e,r){var t=e.range.range;switch(r.kind){case rp.Error:return;case rp.Single:var n=this.evalCellRefSingle(t,r);return sp(n,n);case rp.Range:var a=this.evalCellRefSingle(t,r.ref1),o=this.evalCellRefSingle(t,r.ref2);return sp(a,o);case rp.Row:return qf(Ml(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case rp.Col:return qf(Ml(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},r.prototype.evalCellRefTerm=function(e,r){if(dt(ot.CalcUnifyRangeResolutionCode)){var t=hp(this.locals.range),n=this.context.resolver.resolveCellRef(t,r.data.qualifier,r.data.ref);return this.cellEvaluator(r,n)}var a=e.range.sheet.document,o=r.data.qualifier,i=this.evalCellRef(e,r.data.ref);if(null==i){var u="error ref, qualifier = "+g(o);return of("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",tp.REF,u),ap}if(null!=o&&o.kind===$h.Error){u="qualifier resolution, qualifier = "+g(o);return of("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",tp.REF,u),ap}if(null!=o&&o.kind===$h.SheetRange){var c=this.getSheetIndex(a,o.sheet1);if(null==c){u="qualifier resolution, qualifier = "+g(o)+", sheet 1";return of("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",tp.REF,u),ap}var s=this.getSheetIndex(a,o.sheet2);if(null==s){u="qualifier resolution, qualifier = "+g(o)+", sheet 2";return of("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",tp.REF,u),ap}if(c===s)return cp(Yh(a,c),[i]);var l=Xh(a,Math.min(c,s),Math.abs(s-c)+1);return up(l,i)}var f=null==o||o.kind===$h.Relative?e.range.sheet:this.evalSheetQualifier(e,o);if("string"==typeof f){u="qualifier resolution, qualifier = "+g(o)+", failed on "+f;return of("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",tp.REF,u),ap}return cp(f,[i])},r}(zf);function Sp(e,r,t){return new Ep(e,r,t)}function Tp(e,r,t,n){var a=Wh(e),o=Sp(a.machineContext,r,t);return function e(r,t){var n=r.evaluate(t);return n instanceof Array?n[0]:Ql((function(n){return e(r,"number"==typeof n?n:t)}))}(new jh(a,[o]),n)}var Cp=Xt.SpecialPrecs,Rp=Xt.precedents;function Ip(e){var r=$f.newVisitedMap();return{evalFormula:function(t,n,a,o){var i=Xf(t,n,Rp([],[],Cp.None,!0),r);return Tp(e,i,a,o)},evalCells:function(r){return function(e,r){if(0===r.length)return[];var t=md(e,r),n=xh(e.schedulerInfo);return t.evaluateSync(n)}(e,r)},evalCellsAsync:function(r){return function(e,r){if(0===r.length)return Promise.resolve([]);var t=md(e,r),n=xh(e.schedulerInfo);return t.evaluateAsync(n)}(e,r)}}}var yp=zt.formulaSpan,Ap=zt.RefStyle,Np=qt.FormulaSource,Op=rn.getSubExpressionFromPosition,kp=rn.isSuccess,Lp=rn.failure,Dp=rn.ResultKind,_p=yp(0,0,"","");function Fp(e){var r,t,n,a,o=e.config,i=e.mathpack,u=Dn(o),c=dc(o),s=Gl(o,i),l=qs(c),f=Ff(s),d=Ip(e),h=Qu(u).parseFormula,p=!1,v=void 0,g=-1,m=!1;function E(){p=!1,n=void 0,g=-1,v=void 0,a=void 0,m=!1}function S(){if(!p){if(p=!0,void 0===r||void 0===t)return;var e=h(Ap.A1,r,Np.Range,t);kp(e)&&(n=e.value)}}function T(e){if(S(),void 0!==n&&e!==g){var r=v;v=void 0,e>=0&&e<t.length&&(v=Op(n,e)),v!==r&&(a=void 0,m=!1),g=e}}function C(){if(void 0!==v&&!m&&void 0!==n){var e=r,t=l.checkFormula(e,Np.Range,{node:v,spans:n.spans});if(t.isWellFormed){var o=f.compileFormula(e,Np.Range,t);if(kp(o)){var i=d.evalFormula(e,Np.Range,o.value,void 0);i.kind!==Dp.Paused&&(a=i)}}m=!0}}return{setCellAndFormula:function(e,n){r=e,t=n,E()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(T(e),void 0!==n&&void 0!==v){var r=n.spans[v.label];if(void 0!==r)return r}return _p},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return T(e),C(),void 0!==a?Promise.resolve(a):Promise.resolve(Lp(Xl("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return S(),void 0!==n&&(v=n.node,a=void 0,m=!1),C(),void 0!==a?Promise.resolve(a):Promise.resolve(Lp(Xl("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}var Mp=Xt.OperKind,bp=Xt.valueErrorOper,wp=Xt.div0ErrorOper,Up=$t.OperatorId,Pp=rn.isSheetIndex,Gp=32767;function xp(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case Mp.Error:return e;case Mp.Missing:case Mp.Blank:return;case Mp.Rich:return xp(e.getFallback());default:return I("calc.funcs.arithmeticOperationCoerce",e)}}function Bp(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(Up.Concat,(function(r){return e.coerceOper(r,Mp.String)})),(function(e){return e}),t);if(null==n){var a="calc.funcs.concat: returned undefined; args = "+g(r);return C.ULS.assertTag(595969627,l.LogCategory.msoulscat_ES_EWAJS,!1,a)}return"string"==typeof n&&n.length>Gp?Xt.valueErrorOper:n}function Vp(e){var r="object"==typeof e&&e.kind===Mp.Blank;return(r=r||""===e)?1:0}function Wp(e){return"object"!=typeof e||e.kind!==Mp.Blank?1:0}function Hp(e,r){var t=r[0];if("object"!=typeof t||t.kind!==Mp.Range||!Pp(t.sheets)||1!==t.ranges.length)return bp;var n=e.dereferenceAllOpers(r),a=e.makeOperatorReducer(Up.Add),o=e.reduceDerefOpers(a,Wp,n);return null==o?0:o}function Kp(e){return function r(t){if("boolean"==typeof t)return t;if("number"==typeof t)return e.coerceOper(t,Mp.Boolean);if("string"!=typeof t)switch(t.kind){case Mp.Error:return t;case Mp.Missing:case Mp.Blank:return;case Mp.Rich:return r(t.getFallback());default:return I("funcs.aggregationFuncs: booleanOperationCoerce",t)}}}function jp(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(Up.And),Kp(e),t);return null==n?bp:n}function Jp(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(Up.Or),Kp(e),t);return null==n?bp:n}function qp(e,r){var t=e.dereferenceAllOpers(r),n=[];var a=e.reduceDerefOpers((function(e,r){return void 0===e?r:("number"==typeof e&&n.push(e),uf(e)?e:r)}),(function(e){if("number"==typeof e)return e;if("boolean"!=typeof e&&"string"!=typeof e)switch(e.kind){case Mp.Error:return e;case Mp.Missing:case Mp.Blank:case Mp.Rich:return;default:return I("funcs.makeMedianCoerce",e)}}),t);if("number"==typeof a&&n.push(a),null==a)return te;if(uf(a))return a;if(0===n.length)return te;if(1===n.length)return n[0];if((n=n.sort((function(e,r){return e-r}))).length%2==0){var o=n.length/2;return(n[o-1]+n[o])/2}var i=(n.length-1)/2;return n[i]}function Yp(e){return function(r,t){return e(r)(t[0])}}function Xp(e){return function(r,t){return e(r)(t[0],t[1])}}var Qp=Xt.numErrorOper,zp=Xt.div0ErrorOper,Zp=180/Math.PI,$p=Math.PI/180;function ev(e,r){return Math.PI}var rv=Yp((function(e){return e.getMathpack().sqrt})),tv=Yp((function(e){return e.getMathpack().exp})),nv=Xp((function(e){return e.getMathpack().power})),av=Yp((function(e){return e.getMathpack().ln})),ov=Yp((function(e){return e.getMathpack().log10}));function iv(e,r){var t=r[0],n=r.length<2?10:r[1];return e.getMathpack().log(t,n)}var uv=Yp((function(e){return e.getMathpack().sin})),cv=Yp((function(e){return e.getMathpack().cos})),sv=Yp((function(e){return e.getMathpack().tan})),lv=Yp((function(e){return e.getMathpack().asin})),fv=Yp((function(e){return e.getMathpack().acos})),dv=Yp((function(e){return e.getMathpack().atan})),hv=Xp((function(e){return e.getMathpack().atan2}));function pv(e,r){var t=r,n=t[0],a=t[1],o=Math.pow(10,Math.ceil(a));return n<0?-Math.round(-n*o)/o:Math.round(n*o)/o}function vv(e,r){var t=r,n=t[0],a=t[1],o=Math.pow(10,a<0?-Math.floor(-a):Math.floor(a));return n<0?-Math.ceil(-n*o)/o:Math.ceil(n*o)/o}function gv(e,r){var t=r,n=t[0],a=t[1],o=Math.pow(10,a<0?-Math.floor(-a):Math.floor(a));return n<0?-Math.floor(-n*o)/o:Math.floor(n*o)/o}function mv(e,r){var t=r,n=t[0],a=t[1];return 0===a?0:a<0&&n>0?Qp:a*Math.ceil(n/a)}function Ev(e,r){var t=r,n=t[0],a=t[1];return 0===a?0===n?0:zp:a<0&&n>0?Qp:a*Math.floor(n/a)}function Sv(e,r){var t=r[0];return 2*(t<0?Math.floor(t/2):Math.ceil(t/2))}function Tv(e,r){var t=r[0];return Math.abs(t)}function Cv(e,r){var t=r[0];return t>0?1:0===t?0:t<0?-1:Qp}function Rv(e,r){return r[0]*Zp}function Iv(e,r){return r[0]*$p}var yv=170;function Av(e,r){var t=r[0];if(!isFinite(t)||t<0)return Qp;var n=Math.floor(t+2147483648-2147483648);return n>yv?Qp:function e(r){return A("call just Fact with non Natural value",r),0===r?1:r*e(r-1)}(n)}function Nv(e,r){var t=r[0];if(rn.operKind(t)===Xt.OperKind.Range){var n=t.sheets,a=t.ranges[0];if(1!==n.length||1!==a.rows||1!==a.cols)return Xt.valueErrorOper;t=e.dereferenceOper(t,Xt.OperKind.Number)}switch(rn.operKind(t)===Xt.OperKind.String&&(t=e.coerceOper(t,Xt.OperKind.Number)),rn.operKind(t)){case Xt.OperKind.Number:return 0==(1&Math.floor(Math.abs(t)));case Xt.OperKind.Error:return t;case Xt.OperKind.Missing:return Xt.naErrorOper;case Xt.OperKind.Blank:return!0;case Xt.OperKind.Rich:return Nv(e,[t.getFallback()]);default:return Xt.valueErrorOper}}var Ov=Xt.valueErrorOper;function kv(e){return[e[0],Math.floor(e.length>1?e[1]:1)]}function Lv(e,r){var t=kv(r),n=t[0],a=t[1];return a<0?Ov:a>=n.length?n:n.substr(n.length-a,a)}function Dv(e,r){var t=kv(r),n=t[0],a=t[1];return a<0?Ov:a>=n.length?n:n.substr(0,a)}function _v(e,r){var t=r[0],n=r[1]-1,a=Math.floor(r[2]);return n<0||a<0?Ov:t.substr(n,a)}function Fv(e,r){return r[0].length}function Mv(e,r){if(2!==r.length)return oe;var t,n=r[0],a=r[1];if("object"==typeof(t=n)&&t.kind===rf.Rich&&"string"==typeof a){var o=n.getField(a);if(void 0!==o)return o}return oe}function bv(e,r){return wv(e,[$].concat(r))}function wv(e,r){for(var t=r[0],n={},a=1;a<r.length;a+=2){var o=r[a],i=r[a+1];n[o.toLowerCase()]=i}return new Uv(n,t)}var Uv=function(e,r){var t=this;void 0===e&&(e={}),void 0===r&&(r=$),this._fields=e,this._fallback=r,this.kind=P.Rich,this.getFallback=function(){return t._fallback},this.getField=function(e){var r=e.toLowerCase(),n=t._fields[r];if(void 0!==n)return n}},Pv=rn.success,Gv=rn.failure,xv={};xv[$t.WorksheetFuncId.SUM]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(Up.Add),xp,t);return null==n?0:n},xv[$t.WorksheetFuncId.PRODUCT]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.reduceDerefOpers(e.makeOperatorReducer(Up.Mul),xp,t);return null==n?0:n},xv[$t.WorksheetFuncId.AVERAGE]=function(e,r){var t,n=e.makeOperatorReducer(Up.Add),a=e.dereferenceAllOpers(r),o=e.reduceDerefOpers(n,xp,a),i=e.reduceDerefOpers(n,(t=xp,function(e){if(null!=t(e))return 1}),a);if(null!=o&&null!=i)return e.getBinaryOperator(Up.Div)(o,i);if(null==o&&null==i)return wp;var u="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+g(r);return C.ULS.assertTag(595980871,l.LogCategory.msoulscat_ES_EWAJS,!1,u)},xv[$t.WorksheetFuncId.CONCAT]=Bp,xv[$t.WorksheetFuncId.CONCATENATE]=Bp,xv[$t.WorksheetFuncId.COUNTBLANK]=function(e,r){var t=r[0];if("object"!=typeof t||t.kind!==Mp.Range||!Pp(t.sheets)||1!==t.ranges.length)return bp;var n=e.dereferenceAllOpers(r),a=e.makeOperatorReducer(Up.Add),o=e.reduceDerefOpers(a,Vp,n);return null==o?0:o},xv[$t.WorksheetFuncId.MAX]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.makeBranchOperatorReducer(Up.Gt,(function(e){return!1})),a=e.reduceDerefOpers(n,xp,t);return null==a?0:a},xv[$t.WorksheetFuncId.MIN]=function(e,r){var t=e.dereferenceAllOpers(r),n=e.makeBranchOperatorReducer(Up.Lt,(function(e){return!1})),a=e.reduceDerefOpers(n,xp,t);return null==a?0:a},xv[$t.WorksheetFuncId.ISERROR]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Error},xv[$t.WorksheetFuncId.ISERR]=function(e,r){var t=r[0];return rn.operKind(t)===Xt.OperKind.Error&&t.type!==Xt.ErrorType.NA},xv[$t.WorksheetFuncId.ISBLANK]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Blank},xv[$t.WorksheetFuncId.ISLOGICAL]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Boolean},xv[$t.WorksheetFuncId.ISNA]=function(e,r){var t=r[0];return rn.operKind(t)===Xt.OperKind.Error&&t.type===Xt.ErrorType.NA},xv[$t.WorksheetFuncId.ISNONTEXT]=function(e,r){return rn.operKind(r[0])!==Xt.OperKind.String},xv[$t.WorksheetFuncId.ISTEXT]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.String},xv[$t.WorksheetFuncId.ISNUMBER]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Number},xv[$t.WorksheetFuncId.ISREF]=function(e,r){return rn.operKind(r[0])===Xt.OperKind.Range},xv[$t.WorksheetFuncId.ISEVEN]=Nv,xv[$t.WorksheetFuncId.ISODD]=function(e,r){var t=Nv(e,r);return rn.operKind(t)===Xt.OperKind.Boolean?!t:t};var Bv,Vv,Wv=!1;function Hv(e){return Wv||(Wv=!0,dt(ot.CalcNewFunctions)&&(xv[$t.WorksheetFuncId.AND]=jp,xv[$t.WorksheetFuncId.OR]=Jp,xv[$t.WorksheetFuncId.COUNTA]=Hp,xv[$t.WorksheetFuncId.ABS]=Tv,xv[$t.WorksheetFuncId.CEILING]=mv,xv[$t.WorksheetFuncId.DEGREES]=Rv,xv[$t.WorksheetFuncId.FLOOR]=Ev,xv[$t.WorksheetFuncId.RADIANS]=Iv,xv[$t.WorksheetFuncId.ROUND]=pv,xv[$t.WorksheetFuncId.ROUNDUP]=vv,xv[$t.WorksheetFuncId.ROUNDDOWN]=gv,xv[$t.WorksheetFuncId.EVEN]=Sv,xv[$t.WorksheetFuncId.SIGN]=Cv,xv[$t.WorksheetFuncId.PI]=ev,xv[$t.WorksheetFuncId.SQRT]=rv,xv[$t.WorksheetFuncId.EXP]=tv,xv[$t.WorksheetFuncId.POWER]=nv,xv[$t.WorksheetFuncId.LN]=av,xv[$t.WorksheetFuncId.LOG10]=ov,xv[$t.WorksheetFuncId.LOG]=iv,xv[$t.WorksheetFuncId.SIN]=uv,xv[$t.WorksheetFuncId.COS]=cv,xv[$t.WorksheetFuncId.TAN]=sv,xv[$t.WorksheetFuncId.ASIN]=lv,xv[$t.WorksheetFuncId.ACOS]=fv,xv[$t.WorksheetFuncId.ATAN]=dv,xv[$t.WorksheetFuncId.ATAN2]=hv,xv[$t.WorksheetFuncId.FACT]=Av,xv[$t.WorksheetFuncId.LEFT]=Dv,xv[$t.WorksheetFuncId.RIGHT]=Lv,xv[$t.WorksheetFuncId.MID]=_v,xv[$t.WorksheetFuncId.LEN]=Fv),dt(ot.CalcWorksheetFunctions)&&(xv[$t.WorksheetFuncId.MEDIAN]=qp),dt(ot.CalcFieldValueFunction)&&(xv[$t.WorksheetFuncId.FIELDVALUE]=Mv),dt(ot.CalcRecordFunctions)&&(xv[$t.WorksheetFuncId.RECORD]=bv,xv[$t.WorksheetFuncId.RECORDTEST]=wv)),xv[e]}function Kv(e){return function(r){if("number"==typeof r){var t=Hv(r);return null!=t?Pv(t):Gv(Ml([e.getWorksheetFuncName(r)]))}return Pv(void 0)}}(Vv=Bv||(Bv={})).DerefOperKind=Ks,Vv.FuncKind=Hs;var jv={},Jv=0;function qv(e){var r=jv[e];jv[e]=(void 0===r?0:r)+1,(Jv+=1)%100==0&&(C.ULS.traceTag(595858520,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"hashUtils.logCollision: "+JSON.stringify(jv)+"."),jv={})}function Yv(e,r){return{key:e,value:r}}function Xv(e,r){return{map:{},nentries:0,keyToHash:e,keyEquals:r,getCount:function(){return this.nentries},getValue:function(e){var r=this.keyToHash(e),t=this.map[r];if(!fr(t)){for(var n=0;n<t.length;n+=1){var a=t[n];if(this.keyEquals(e,a.key))return a.value}qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,r){var t=this.keyToHash(e),n=this.map[t];if(null==n)this.map[t]=[Yv(e,r)],this.nentries+=1;else{for(var a=0;a<n.length;a+=1){var o=n[a];if(this.keyEquals(o.key,e))return void(o.value=r)}n.push(Yv(e,r)),this.nentries+=1,qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e)}},remove:function(e){var r=this.keyToHash(e),t=this.map[r];if(fr(t))return!1;for(var n=[],a=!1,o=0;o<t.length&&!a;o+=1){var i=t[o];this.keyEquals(e,i.key)?(this.nentries-=1,a=!0):n.push(i)}return this.map[r]=n,a||qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),a},getOrSetValue:function(e,r){var t=this.keyToHash(e),n=this.map[t];if(fr(n)){var a=r();return this.map[t]=[Yv(e,a)],this.nentries+=1,a}for(var o=0;o<n.length;o+=1){var i=n[o];if(this.keyEquals(e,i.key))return i.value}var u=r();return n.push(Yv(e,u)),this.nentries+=1,qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),u},forEach:function(e){var r=this;Object.keys(this.map).forEach((function(t){r.map[+t].forEach((function(r){e(r.key,r.value)}))}))},filter:function(e){var r=[];this.forEach((function(t,n){return e(t,n)||r.push(t),!0}));for(var t=0,n=r;t<n.length;t++){var a=n[t];this.remove(a)}}}}function Qv(e){if(null==e)return"";var r,t=Xr(e.sheet.document);t===k?r="illegalDocument":r=(null==t.path?"":"p:"+t.path.toLocaleUpperCase()+",")+"n:"+t.name.toLocaleUpperCase();return r+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}var zv=function(e){var r=e^e>>16;return r*=2246822507,r^=r>>13,r*=3266489909,r^=r>>16};function Zv(e){var r=1;return r=31*(r=31*(r=31*(r=31*r+zv(e.sheet.index))+zv(e.range.col))+zv(e.range.row))+zv(e.sheet.document.name.length),void 0!==e.sheet.document.path&&(r=31*r+zv(e.sheet.document.path.length)),r}function $v(e,r){return Lr(e,r)}function eg(){return{map:{},keyToHash:Zv,keyEquals:$v,nelements:0,add:function(e){var r=this.keyToHash(e);if(fr(this.map[r]))this.map[r]=[e],this.nelements+=1;else{for(var t=this.map[r],n=0;n<t.length;n+=1)if(this.keyEquals(e,t[n]))return;qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),t.push(e),this.nelements+=1}},contains:function(e){var r=this.keyToHash(e),t=this.map[r];if(fr(t))return!1;for(var n=0;n<t.length;n+=1)if(this.keyEquals(e,t[n]))return!0;return qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var r=this;Object.keys(this.map).forEach((function(t){r.map[+t].forEach((function(r){e(r)}))}))},size:function(){return this.nelements},remove:function(e){var r=this,t=this.keyToHash(e),n=this.map[t];if(fr(n))return!1;var a=[],o=!1;return n.forEach((function(t){r.keyEquals(e,t)?(r.nelements-=1,o=!0):a.push(t)})),this.map[t]=a,o||qv("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),o}}}function rg(){return Xv((function(e){return e}),(function(e,r){return e===r}))}var tg=rn.createResolutionHandler,ng=rn.createNameFinder,ag={};function og(e){dt(ot.CalcLogStopWatch)&&(ag[e]=ct(e))}function ig(e){if(dt(ot.CalcLogStopWatch)){var r=ag[e];void 0!==r&&r.stop()}}function ug(e,r){return void 0===e&&void 0===r||void 0!==e&&void 0!==r&&Nr(e,r)}function cg(e,r,t,n){var a=function(e,r){if(void 0===e){var t=r.getCurrentDocumentLoc(),n=r.getCurrentSheetIndex();if(null==t||null==n)return;return F(t,n)}switch(e.kind){case le.Error:return;case le.Relative:t=r.getCurrentDocumentLoc(),n=r.getCurrentSheetIndex();if(null==t||null==n)return;return F(t,n);case le.Sheet:var a=void 0!==e.document?L(e.document.path,e.document.document):r.getCurrentDocumentLoc();if(null==a)return;var o=r.getSheetIndex(a,e.sheet);if(null==o)return;return F(a,o);case le.SheetRange:if(null==(a=r.getCurrentDocumentLoc()))return;var i=r.getSheetIndex(a,e.sheet1),u=r.getSheetIndex(a,e.sheet2);if(null==i||null==u)return;return i===u?F(a,i):_(a,Math.min(i,u),Math.abs(i-u)+1);default:return I("calc.calc.qualifierToSheet",e)}}(e.qualifier,t);if(void 0!==a)if(ug(r.sheet.document,a.document)||(n.crossDocRefs+=1),Tr(a))switch(a.index!==r.sheet.index&&(n.crossSheetRefs+=1),e.ref.kind){case fe.Error:return void(n.errRefs+=1);case fe.Col:return void(n.columnRefs+=1);case fe.Row:return void(n.rowRefs+=1);case fe.Range:var o=Fr(sg(e.ref.ref1,r),sg(e.ref.ref2,r));return t.maxRangeSize>0&&gf(o)>t.maxRangeSize?void(n.largeRanges+=1):K(a,o);case fe.Single:var i=sg(e.ref,r);return j(a,i);default:return I("calc.calc.cellRefToGridLoc",e.ref)}else n.crossSheetRefs+=1;else n.errRefs+=1}function sg(e,r){return w(lg(e.row,r.range.row),lg(e.col,r.range.col))}function lg(e,r){switch(e.kind){case de.Abs:return e.index;case de.Rel:return e.index+r}}function fg(e,r){var t=void 0;if(void 0===e.qualifier){var n=r.getCurrentDocumentLoc(),a=r.getCurrentSheetIndex();if(null==n||null==a)return;t=F(n,a)}else switch(e.qualifier.kind){case le.Document:t=J(L(e.qualifier.path,e.qualifier.document));break;case le.Relative:n=r.getCurrentDocumentLoc(),a=r.getCurrentSheetIndex();if(null==n||null==a)return;t=F(n,a);break;case le.Ident:var o=r.getCurrentDocumentLoc();if(null==o)return;var i=r.getSheetIndex(o,e.qualifier.name);t=null==i?J(L(void 0,e.qualifier.name)):F(o,i);break;case le.Sheet:if(null==(o=void 0!==e.qualifier.document?L(e.qualifier.document.path,e.qualifier.document.document):r.getCurrentDocumentLoc()))return;if(null==(i=r.getSheetIndex(o,e.qualifier.sheet)))return;t=F(o,i);break;default:return I("calc.calc.nameNodeToNameLoc",e.qualifier)}return q(t,e.whole)}function dg(e,r){switch(r.ref.kind){case fe.Error:e.errRefs+=1;break;case fe.Col:e.columnRefs+=1;break;case fe.Row:e.rowRefs+=1}}function hg(e,r){var t=r[e];return void 0===t&&(t=0),t}function pg(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:cr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(r){e.columnRefs+=r.columnRefs,e.crossDocRefs+=r.crossDocRefs,e.crossSheetRefs+=r.crossSheetRefs,e.largeRanges+=r.largeRanges,e.nameRefs+=r.nameRefs,e.parserErrors+=r.parserErrors,e.rowRefs+=r.rowRefs,e.tableRefs+=r.tableRefs,e.errRefs+=r.errRefs,function(e,r){if(og("calc_ts_merge_sets"),dt(ot.CalcHashSet)){var t=eg();e.forEach((function(e){t.add(e)})),r.forEach((function(r){t.contains(r)||e.push(r)}))}else{var n=cr();e.forEach((function(e){n[Qv(e)]=!0})),r.forEach((function(r){var t=Qv(r);n[t]||(e.push(r),n[t]=!0)}))}ig("calc_ts_merge_sets")}(e.dependents,r.dependents),Object.keys(r.functionsCount).forEach((function(t){var n=e.functionsCount[t];void 0===n&&(n=0),e.functionsCount[t]=n+r.functionsCount[t]})),Object.keys(r.operatorsCount).forEach((function(t){var n=Number(t),a=e.operatorsCount[n];void 0===a&&(a=0),e.operatorsCount[n]=a+r.operatorsCount[n]}))}};return e}function vg(e){var r={_logger:e,_dependencyGraph:cr(),haveDependents:function(e){return void 0!==r._dependencyGraph[Qv(e)]},directDependents:function(e){var t=[],n=r._dependencyGraph[Qv(e)];return void 0!==n&&n.forEach((function(e){t.push(e)})),t},allDependents:function(e){return r.getDependents(e,!1)},rootDependents:function(e){return r.getDependents(e,!0)},reset:function(){r._dependencyGraph=cr()},add:function(e,t,n){var a=it.__assign({},e);a.getCurrentDocumentLoc=function(){return Xr(e.getCurrentDocumentLoc())};var o=pg();if(null==n)return o;var i=void 0,u=void 0;dt(ot.CalcUnifyRangeResolutionCode)&&(i=function(e,r,t,n){return tg(ng((function(a){var o=r.nameRefToSheetGridRange(e,a);return null==o?o:(t.addDependency(o,e,r.maxRangeSize,n),o)}),void 0),ur,(function(){}))}(t,a,r,o),u=function(e,r,t,n){return tg((function(a){Tr(a.sheet)||(n.crossSheetRefs+=1),ug(e.sheet.document,a.sheet.document)||(n.crossDocRefs+=1),a.sheet.index!==e.sheet.index&&(n.crossSheetRefs+=1),Ir(a)&&t.addDependency(a,e,r.maxRangeSize,n)}),(function(e){return dg(n,e)}),(function(e,r){e.kind===Ur.NotImplemented?dg(n,r):n.errRefs+=1}))}(t,a,r,o));var c,s,f,d=[];for(d.push(n.node);d.length>0;){var h=d.pop();if(null!=h)switch(h.kind){case he.Literal:break;case he.Array:h.nodes.map((function(e){return e.map((function(e){d.push(e)}))}));break;case he.App:if("object"==typeof h.head){var p=h.head;switch(p.kind){case he.Operator:o.operatorsCount[p.id]=(c=p.id,s=o.operatorsCount,f=void 0,void 0===(f=s[c])&&(f=0),f+1);break;case he.Name:o.functionsCount[p.whole]=hg(p.whole,o.functionsCount)+1;break;default:d.push(p)}}h.args.map((function(e){d.push(e)}));break;case he.Paren:d.push(h.node);break;case he.Name:if(o.nameRefs+=1,dt(ot.CalcUnifyRangeResolutionCode)&&void 0!==i)i(void 0,a.resolver.resolveName(t,h.qualifier,h.whole));else if(void 0===i){var v=fg(h,a);if(void 0!==v)null!=(g=a.nameRefToSheetGridRange(t,v))&&r.addDependency(g,t,a.maxRangeSize,o)}else C.ULS.traceTag(595952269,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case he.CellRef:if(dt(ot.CalcUnifyRangeResolutionCode)&&void 0!==u)u(h,a.resolver.resolveCellRef(t,h.qualifier,h.ref));else if(void 0===u){var g;void 0!==(g=cg(h,t,a,o))&&r.addDependency(g,t,a.maxRangeSize,o)}else C.ULS.traceTag(595952270,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case he.Bad:o.parserErrors+=1;break;default:return I("calc.calc.recalcMapperImpl",h)}}return o},merge:function(e){r.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=vg(r._logger);return e.mergeGraph(r._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){og("calc_ts_merge_graph");var t=function(t){var n=r._dependencyGraph[t],a=e[t];void 0===n&&(n=[]);var o=n;if(dt(ot.CalcHashSet)){var i=eg();o.forEach((function(e){i.add(e)})),a.forEach((function(e){i.contains(e)||o.push(e)}))}else{var u=cr();o.forEach((function(e){u[Qv(e)]=!0})),a.forEach((function(e){u[Qv(e)]||o.push(e)}))}r._dependencyGraph[t]=o};for(var n in e)t(n);ig("calc_ts_merge_graph")},addDependency:function(e,t,n,a){if(yr(e)){var o=Qv(e);r.updateDependency(o,t)&&a.dependents.push(e)}else if(gf(e.range)>n)a.largeRanges+=1;else for(var i=e.range.row;i<e.range.row+e.range.rows;i+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=j(e.sheet,w(i,u));r.addDependency(c,t,n,a)}},updateDependency:function(e,t){var n=r._dependencyGraph[e];return void 0===n&&(n=[]),!n.some((function(e){return Lr(e,t)}))&&(n.push(t),r._dependencyGraph[e]=n,!0)},getDependents:function(e,t){if(og("calc_ts_get_dependents"),dt(ot.CalcHashSet)){for(var n=eg(),a=[],o=r.directDependents(e);o.length>0;){if(void 0!==(s=o.shift()))if(!n.contains(s))n.add(s),(l=r.directDependents(s)).length>0&&l.forEach((function(e){o.push(e)})),t&&0!==l.length||a.push(s)}return a}for(var i=cr(),u=[],c=r.directDependents(e);c.length>0;){var s;if(void 0!==(s=c.shift())){var l,f=Qv(s);if(!i[f])i[f]=!0,(l=r.directDependents(s)).length>0&&(c=c.concat(l)),t&&0!==l.length||u.push(s)}}return ig("calc_ts_get_dependents"),u},stats:function(){var e=Object.keys(r._dependencyGraph);if(void 0===e||0===e.length)return gg(0,0);var t=e.length,n=0;return e.forEach((function(e){var t=r._dependencyGraph[e];n+=t.length})),gg(t,n)}};return r}function gg(e,r){return{nodes:e,arcs:r}}var mg=rn.createResolver,Eg=rn.success;function Sg(e){return R(e),vg(e)}function Tg(e,r,t,n,a,o,i,u,c,s){return{maxRangeSize:e,nameRefs:r,rowRefs:t,columnRefs:n,crossSheetRefs:a,crossDocRefs:o,getCurrentDocumentLoc:i,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:s,resolver:mg({getSheetIndex:function(e,r){return Eg(c(e,r))},getDocumentLoc:i})}}var Cg=qt.FormulaSource,Rg=qt.sheetGridCell,Ig=qt.gridCell,yg=qt.documentLoc,Ag=qt.sheetIndex,Ng=zt.RefStyle,Og=rn.ResultKind,kg=rn.failure;function Lg(e,r){return{}}function Dg(e,r,t){return{config:e,mathpack:r,formatInfo:t}}function _g(e){var r={globals:e,runtime:function(e){var r=e.config,t=e.mathpack,n={config:r},a=it.__assign({config:r},e.formatInfo),o={config:r,mathpack:t},i=Qu(n),u=qs(a),c=Ff(o);return{parser:i,analyzer:u,compiler:c}}(e),cache:cr(),lazyCreateCacheItem:function(e){var t,n=Qv(e),a=r.cache[n];return void 0===a&&(a={cell:e,rawValue:t,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},r.cache[n]=a),a},size:function(){var e=0;for(var t in r.cache)e+=1;return e},clear:function(){r.cache=cr()},cells:function(){var e=Object.keys(r.cache);return void 0===e||0===e.length?[]:e.map((function(e){return r.cache[e].cell}))},getItem:function(e){var t=Qv(e);return r.cache[t]},getValue:function(e){var t=r.getItem(e);if(void 0!==t&&null!==t.rawValue)return t.rawValue},getFormula:function(e,t,n){var a=r.getItem(e);if(void 0!==a&&Fg(r.runtime,a,t,n)&&Mg(a.formula))return a.formula},getFormulaFormat:function(e){var t=r.getItem(e);if(void 0!==t)return t.format},getCompiledFormula:function(e,t){var n=r.getItem(e);if(void 0!==n&&function(e,r,t){if(Mg(r.compiledFormula))return!0;if(!Fg(e,r,t))return!1;if(void 0!==t&&t)return!1;r.compiledFormula=null;try{var n=e.compiler.compileFormula(r.cell,Cg.Cell,r.formula);return n.kind===Og.Success&&(r.compiledFormula=n.value,!0)}catch(e){return C.ULS.traceTag(595968586,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+g(e)),!1}}(r.runtime,n,t)&&Mg(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var t=r.getItem(e);if(void 0!==t)return t.evalResult},isEqualValue:function(e,t){var n=r.getItem(e);return void 0!==n&&n.rawValue===t},updateCellValue:function(e,t,n,a,o){if(!r.isEqualValue(e,t)){var i=r.lazyCreateCacheItem(e);if(i.rawValue=t,i.formula=void 0,i.compiledFormula=void 0,i.evalResult=void 0,i.format=void 0,null!=n){var u=n.getValue(e);void 0!==u&&t===u&&(i.formula=n.getFormula(e,!0),i.compiledFormula=n.getCompiledFormula(e,!0),i.evalResult=void 0,i.format=i.format)}null!=o&&(i.format=o),null!=a&&a.forEach((function(e){var t=r.getItem(e);void 0!==t&&(t.evalResult=void 0)}))}},updateEvalResult:function(e,t,n){var a=r.lazyCreateCacheItem(e);a.evalResult=t,null!=n&&(a.format=n)},merge:function(e,t){e.cells().forEach((function(n){var a=e.getValue(n);void 0===a||!0!==t&&void 0!==r.getItem(n)||r.updateCellValue(n,a,e)}))},parseCompileNameFormula:function(e,t,n){var a,o=void 0===n?Ng.A1:n,i=Cg.NameManager;if(void 0!==t)a=r.runtime.parser.parseFormula(o,t,i,e);else{var u=Ag(yg(void 0,"Doc"),0),c=Ig(0,0);a=r.runtime.parser.parseFormula(o,Rg(u,c),i,e)}var s=g(e);if(a.kind!==Og.Success){var f="calc.formulaCache.parseCompileNameFormula: couldn't parse "+s;return C.ULS.traceTag(595969230,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,f),kg(Fn(f))}var d=r.runtime.analyzer.checkFormula(t,Cg.NameManager,a.value);if(d.isWellFormed)return r.runtime.compiler.compileFormula(t,i,d);var h="calc.formulaCache.parseCompileNameFormula: formula "+s+" is not well-formed.";return C.ULS.traceTag(595969231,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,h),kg(xl(h))}};return r}function Fg(e,r,t,n){if(Mg(r.formula))return!0;if(!Mg(r.rawValue))return!1;if(void 0!==r.formula&&null===r.formula)return!1;if(void 0!==t&&t)return!1;r.formula=null;var a=r.rawValue;try{var o=e.parser.parseFormula(zt.RefStyle.A1,r.cell,Cg.Cell,a);if(o.kind!==Og.Success)return!1;var i=e.analyzer.checkFormula(r.cell,Cg.Cell,o.value,n);return!!i.isWellFormed&&(r.formula=i,dt(ot.CalcFormatCalculations)&&(r.format=void 0),!0)}catch(e){return C.ULS.traceTag(595968585,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+g(e)),!1}}function Mg(e){return null!=e}var bg,wg=bg=function(e,r){return{functionId:e,functionName:r}},Ug=function(e){return e}((function(e,r){return{errorType:e,errorName:r}})),Pg=function(e){return e}((function(e,r,t,n,a,o,i,u,c,s,l,f,d,h){var p=[];return r.forEach((function(e,r){"string"==typeof e?p.push(Ug(r,e)):lr(e)&&p.push(e)})),{worksheetFunctionNames:e,errorTypeNames:p,errorNames:[],trueName:t,falseName:n,rowLetter:a,columnLetter:o,leftBrace:i,rightBrace:u,leftBracket:c,rightBracket:s,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}})),Gg=function(e){return e}((function(e,r,t){return{iformat:e,category:r,decimals:t}})),xg=function(e){return e}((function(e,r){return{sheetId:e,sheetName:r}})),Bg={kind:"Blank"},Vg=function(e){return e}((function(e){return{kind:"Error",type:e}})),Wg=function(e){return e}((function(e){return{kind:"Rich",fields:e}})),Hg=function(e){return e}((function(e,r){return{row:e,column:r}})),Kg=function(e){return e}((function(e,r,t,n){return{row:e,column:r,lastRow:t,lastColumn:n}})),jg=function(e){return e}((function(e,r,t,n,a){return{sheetId:e,row:r,column:t,lastRow:n,lastColumn:a}})),Jg=function(e){return e}((function(e,r,t){return{formulaBarText:e,value:r,iformat:t}})),qg=function(e){return e}((function(e,r,t,n,a){return{range:e,data:r,fromStateId:t,excludeRows:n,excludeColumns:a}})),Yg=function(e){return e}((function(e,r,t,n){return qg(e,r,void 0,t,n)}));function Xg(e,r,t,n){return qg(e,void 0,r,t,n)}var Qg=function(e){return e}((function(e,r){return{isSpilled:e,formulaBarText:r}})),zg=function(e){return e}((function(e,r,t){return{range:e,data:r,fromStateId:t}}));function Zg(e,r){return zg(e,r,void 0)}function $g(e,r){return zg(e,void 0,r)}var em,rm,tm,nm,am=function(e){return e}((function(e,r,t,n,a){return{range:e,formulaBarText:r,value:t,origin:n,viewport:a}})),om=function(e){return e}((function(e,r,t,n){return{range:e,formulaBarText:r,origin:t,viewport:n}})),im=function(e){return e}((function(e,r,t,n,a){return{isExact:e,iformat:r,hasHyperlink:t,category:n,decimals:a}})),um=function(e){return e}((function(e,r,t){return{formulaBarText:e,value:r,format:t}})),cm=function(e){return e}((function(e,r){return{range:e,data:r}})),sm=function(e){return e}((function(e,r){return{range:e,data:r}})),lm=function(e){return e}((function(e,r,t){return{range:e,task:r,reason:t}})),fm=function(e){return e}((function(e,r,t,n,a,o){return{stateId:e,priorityGroup:r,isFinished:t,rangeDeltas:n,arrayDeltas:a,rangeFailures:[]}})),dm=function(e){return e}((function(e,r){return{rangeUpdateRanges:e,arrayUpdateRanges:r}})),hm=6e4,pm=3e4;function vm(){var e;return[new Promise((function(r,t){return e=[r,t]})),e]}function gm(e,r){var t=vm(),n=t[0],a=t[1],o=a[0],i=a[1],u=setTimeout(r,Math.max(0,e));return[n,[function(e){clearTimeout(u),o(e)},function(e){clearTimeout(u),i(e)}]]}function mm(e,r,t){var n=gm(e,(function(){return s(r())})),a=n[0],o=n[1],i=o[0],u=o[1],c=!1;function s(e){u(e),c=!0}var l=Promise.resolve().then((function(e){return t(s,(function(){return c}))}));return function(e,r){return e.then((function(e){return r(),e}),(function(e){return r(),Promise.reject(e)}))}(Promise.race([a,l]),i)}function Em(e,r){var t;return new Promise((function(n,a){Promise.resolve(r).then((function r(o){if(void 0!==o){t=o;try{Promise.resolve(e(t)).then(r,a)}catch(e){a(e)}}else n(t)}),a)}))}function Sm(e,r){return{setMessageListeners:function(r){e.onmessage=function(e){return r.onMessage(e.data)},e.onmessageerror=function(e){return r.onMessageError(e.data)}},postMessage:function(r){return e.postMessage(r)},close:function(){return r.call(e)}}}function Tm(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(em||(em={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(rm||(rm={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(tm||(tm={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(nm||(nm={}));var Cm,Rm={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function Im(e){return[e.name,e.message,e.stack]}function ym(e){var r,t=e[0],n=e[1],a=e[2],o=Rm[t];return null!=o?r=new o(n):(r=new Error(n)).name=t,void 0!==a&&(r.stack=a),r}function Am(e){return Tm(e)?[Cm.Error,Im(e)]:[Cm.Unknown,e]}function Nm(e,r,t,n){var a=new Error(e);return a.stack=e+"\n    at "+r+":"+t+":"+n,a}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(Cm||(Cm={}));var Om="__START_ERROR__",km="__END_ERROR__";function Lm(e){var r=e.message.indexOf(Om),t=e.message.indexOf(km);return r>=0&&t>=0?ym(JSON.parse(e.message.substring(r+Om.length,t))):null!=e.error?e.error:Nm(e.message,e.filename,e.lineno,e.colno)}function Dm(e,r,t,n,a,o){var i={port:r,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==i)throw new Error("endpoint is closed");return i}function c(e,r,t){if(null!=i){var n=i.callbacks[e];null!=n&&(delete i.callbacks[e],n[r](t))}}function s(e,r,t,n,a){var o;try{o=u()}catch(e){return Promise.reject(e)}var i=o.lastAppId+1,c=[tm.App,i,e,r,t,a],s=gm(n,(function(){f(c,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),l=s[0],d=s[1];o.callbacks[i]=d,o.lastAppId=i;try{o.port.postMessage(c)}catch(e){f(c,e)}return l}function l(e,r,t,n){var a=u(),o=[tm.App,-1,e,r,t,n];try{a.port.postMessage(o)}catch(e){f(o,e)}}function f(e,r){var t=e[1],n=e[5];null!=i&&(t>=0&&c(t,nm.Rejected,r),n?m(t>=0?rm.PostCallError:rm.PostNotifyError,r,!0):(t<0&&m(rm.PostNotifyError,r,!1),s("","",[],Math.max(E.callTimeout,E.initTimeout),!0).catch((function(e){}))))}function d(e){var r=e[1],t=e[2],n=e[3],a=e[4],o=e[5];if(null!=i)if(""!==t||""!==n){var u=Promise.resolve().then((function(e){if(null!=i){var r=t,o=n,u=i.modules[r],c=null!=u?u[o]:void 0;if(null==c)throw new Error("method "+r+"."+o+" has not been exported");return c.apply(u,a)}}));r>=0?u.then((function(e){return h(r,nm.Fulfilled,e,o)}),(function(e){return h(r,nm.Rejected,e,o)})):u.catch((function(e){m(rm.UnhandledNotifyError,function(e,r,t){var n=r+"."+t+".notify: ";if(Tm(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var a=new Error(n+e);return a.stack=void 0,a}(e,t,n),!1)}))}else h(r,nm.Fulfilled,void 0,o)}function h(e,r,t,n){if(null!=i){var a=[tm.Result,e,r,Am(t),n];try{i.port.postMessage(a)}catch(e){p(a,e)}}}function p(e,r){var t=e[1],n=e[4];null!=i&&(n?m(rm.PostResultError,r,!0):h(t,nm.Rejected,Am(r),!0))}function v(e){var r=e[1],t=e[2],n=e[3];null!=i&&c(r,t,function(e){return e[0]===Cm.Unknown?e[1]:ym(e[1])}(n))}function g(e){if(void 0===e&&(e=!0),null!=i){var r=i.port,t=i.callbacks;if(i=void 0,e)try{r.postMessage([tm.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var a in t)c(Number(a),nm.Rejected,n);try{r.close()}catch(e){}if(null!=o)try{o(E)}catch(n){var u=null!=n.stack?n.stack:n.message;console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function m(e,r,t){if(null!=i){var n=void 0;try{a(E,{kind:e,closing:t,error:r})||(n=[r])}catch(r){n=[r]}if(t&&g(),null!=n){var o=n[0],u=null!=o.stack?o.stack:o.message;console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+u)}}}var E={workerKind:e,initTimeout:t,callTimeout:n,setExports:function(e,r){return u().modules[e]=r},getImports:function(e,r){var t={};return r.forEach((function(r){return t[r]=function(e,r){var t={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var o=null!=t.callTimeout?t.callTimeout:E.callTimeout;return s(e,r,n,o,t.isCritical)},notify:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];l(e,r,n,t.isCritical)}};return t}(e,r)})),t},close:g,dispatchError:m};return i.port.setMessageListeners({onMessage:function(e){switch(e[0]){case tm.App:return d(e);case tm.Result:return v(e);case tm.Close:return g(!1);default:return I("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var r=new Error("failed to send "+e[0]+" message");switch(e[0]){case tm.App:return f(e,r);case tm.Result:return p(e,r);case tm.Close:return;default:return I("calc.worker.createPortEndpoint.onMessageError",e)}}}),E}function _m(e,r,t){var n=this,a=null!=r.initTimeout?r.initTimeout:hm,o=null!=r.callTimeout?r.callTimeout:pm;return mm(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(i,u){return it.__awaiter(n,void 0,void 0,(function(){function n(e){return function(r,t){return s?null!=e.onError&&(e.onError(r,t),!0):(i(t.error),!0)}}function c(e){return function(r){s&&null!=e.onClosed&&e.onClosed(r)}}var s,l,f;return it.__generator(this,(function(i){switch(i.label){case 0:return s=!1,l=Dm(e,t.outside,a,o,n(r.outside),c(r.outside)),f=Dm(e,t.inside,a,o,n(r.inside),c(r.inside)),u()||null==r.inside.onInit?[3,2]:[4,r.inside.onInit(f)];case 1:i.sent(),i.label=2;case 2:return u()||null==r.outside.onInit?[3,4]:[4,r.outside.onInit(l)];case 3:i.sent(),i.label=4;case 4:return s=!0,[2,l]}}))}))}))}function Fm(){return"undefined"!=typeof MessageChannel}var Mm=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return y("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var bm,wm,Um=100;function Pm(){if(null==nn.getCalcAbsUrl()){return C.ULS.traceTag(595907587,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function Gm(e){setTimeout((function(){try{e.terminate()}catch(e){}}),Um)}function xm(){var e={};for(var r in ot){var t=ot[r];null!=t&&(e[r]=dt(t))}return e}t(9);var Bm=((bm={})[em.FunctionCall]=function(){return!0},bm[em.MessageChannel]=Fm,bm[em.Dedicated]=Pm,bm);function Vm(e){return Bm[e]()}var Wm=((wm={})[em.FunctionCall]=function(e){return _m(em.FunctionCall,e,(r=new Mm,t=new Mm,r.open(t),{outside:r,inside:t}));var r,t},wm[em.MessageChannel]=function(e){if(!Fm())return y("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var r=function(){var e=new MessageChannel;return{outside:Sm(e.port1,e.port1.close),inside:Sm(e.port2,e.port2.close)}}();try{return _m(em.MessageChannel,e,r)}catch(e){try{r.outside.close()}catch(e){}throw e}},wm[em.Dedicated]=function(e){var r=this,t=e.outside,n=e.inside,a=e.initTimeout,o=e.callTimeout,i=n.scriptName;if(null==i)return y("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=nn.getCalcAbsUrl();if(!Pm()||null==u)return y("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var c=null!=a?a:hm,s=null!=o?o:pm;return mm(c,(function(){return new Error("exceeded timeout; initTimeout = "+c+"ms")}),(function(e,n){return st("calc.worker.createDedicatedWorker (total)",(function(){return it.__awaiter(r,void 0,void 0,(function(){function r(r){return it.__awaiter(this,void 0,void 0,(function(){function a(r,n){return i?null!=t.onError&&(t.onError(r,n),!0):(e(n.error),!0)}function o(e){i&&null!=t.onClosed&&t.onClosed(e)}var i,l,f,d,h;return it.__generator(this,(function(e){switch(e.label){case 0:i=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),l=new Worker(r),d=Sm(l,(function(){return Gm(l)})),f=Dm(em.Dedicated,d,c,s,a,o),l.onerror=function(e){var t;e.preventDefault(),t=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+r):Lm(e),f.dispatchError(rm.UnhandledError,t,!i)},function(e,r){var t={shipAssertTag:function(e,t,n,a){try{r.ULS.shipAssertTag(e,t,n,a)}catch(e){}},assertTag:function(e,t,n,a){try{r.ULS.assertTag(e,t,n,a)}catch(e){}},traceTag:function(e,t,n,a){try{r.ULS.traceTag(e,t,n,a)}catch(e){}},debugTraceTag:function(e,t,n,a){try{r.ULS.debugTraceTag(e,t,n,a)}catch(e){}}};e.setExports("",t)}(f,C),n()?[3,3]:[4,st("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=c,e.isCritical=!0,e.call({initTimeout:c,callTimeout:s,calcAbsUrl:u,features:xm()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==t.onInit?[3,5]:[4,t.onInit(f)];case 4:e.sent(),e.label=5;case 5:return i=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=l&&Gm(l),h;case 7:return[2]}}))}))}var a,o,f,d;return it.__generator(this,(function(e){switch(e.label){case 0:n=i+(/\.min\.js$/.test(t=u)?".min.js":".js"),c=t.lastIndexOf("/"),a=t.substring(0,c+1)+n,o="calc.worker.createDedicatedWorker: workerUrl = "+a,C.ULS.traceTag(595907588,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,o),e.label=1;case 1:e.trys.push([1,6,,7]),f=new Blob(['importScripts("'+encodeURI(a)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(f),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,r(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),C.ULS.traceTag(595881991,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+a+". Attempting with string url instead..."),[2,r(a)];case 7:return[2]}var t,n,c}))}))}))}))},wm);function Hm(e,r){return Wm[e](r)}function Km(e,r){return it.__awaiter(this,void 0,void 0,(function(){var t,n,a,o,i;return it.__generator(this,(function(u){switch(u.label){case 0:t=0,u.label=1;case 1:if(!(t<e.length))return[3,6];if(!Vm(n=e[t]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Hm(n,r)];case 3:return[2,u.sent()];case 4:return a=u.sent(),o=null!=a.stack?a.stack:a.message,i="calc.worker.tryCreateWorker: starting "+n+" worker threw "+o,C.ULS.traceTag(595907598,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,i),[3,5];case 5:return t+=1,[3,1];case 6:return[2,void 0]}}))}))}function jm(){setTimeout((function(){try{self.close()}catch(e){}}),Um)}function Jm(e,r,t,n){var a=r.initTimeout,o=r.callTimeout,i=r.calcAbsUrl,u=r.features;return it.__awaiter(this,void 0,void 0,(function(){var r,c,s,l,f=this;return it.__generator(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,mm(a,(function(){return new Error("exceeded timeout; initTimeout = "+a+"ms")}),(function(e,r){return it.__awaiter(f,void 0,void 0,(function(){function c(r,t){return l?null!=n.onError&&(n.onError(r,t),!0):(e(t.error),!0)}function s(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,p,v;return it.__generator(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=Sm(self,jm),f=Dm(em.Dedicated,d,a,o,c,s),h=function(e){var r=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);return{shipAssertTag:function(e,t,n,a){if(r.shipAssertTag.notify(e,t,n,a),!n)throw new Error("shipAssertTag: "+a)},assertTag:function(e,t,n,a){if(r.assertTag.notify(e,t,n,a),!n)throw new Error("assertTag: "+a)},traceTag:function(e,t,n,a){r.traceTag.notify(e,t,n,a)},debugTraceTag:function(e,t,n,a){r.debugTraceTag.notify(e,t,n,a)}}}(f),p=function(e){return!0===u[e]},t.config.initCalc(h,p,i),r()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw v=e.sent(),null!=f?f.close():jm(),v;case 5:return[2]}}))}))})).then((function(e){return[nm.Fulfilled,e]}),(function(e){return[nm.Rejected,e]}))];case 1:r=d.sent(),c=r[0],s=r[1],l=[tm.Result,e,c,Am(s),!0];try{self.postMessage(l)}catch(e){throw jm(),e}return[2]}}))}))}var qm={onError:function(e,r){var t=null!=r.error.stack?r.error.stack:r.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:t});C.ULS.traceTag(595908699,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var r=e.getImports("talk",["ping"]);e.setExports("location",qt),e.setExports("talk",{start:function(e,t,n){return it.__awaiter(this,void 0,void 0,(function(){var a,o=this;return it.__generator(this,(function(i){switch(i.label){case 0:return a=Date.now(),[4,Em((function(i){return it.__awaiter(o,void 0,void 0,(function(){return it.__generator(this,(function(o){switch(o.label){case 0:return Date.now()>=a+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 1:return o.sent(),r.ping.notify(i,n),[2,i+1]}}))}))}),0)];case 1:return i.sent(),[2]}}))}))},memoryTest:function(e){var r=[],t=0;try{for(;t<e;t+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,r.push(n)}}catch(e){}r=[];var a="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+t+"KB";C.ULS.traceTag(595906820,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,a)},ping:function(e,r){if(r&&e%1e3==0){var t="calc.worker.smokeTestInsideDef.ping: n = "+e;C.ULS.traceTag(595907656,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}return e+1},logMessage:function(e,r){if(r){var t="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;C.ULS.traceTag(595714188,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"},Ym="To be, or not to be, that is the question:Whether 'tis nobler in the mind to sufferThe slings and arrows of outrageous fortune,Or to take arms against a sea of troublesAnd by opposing end them. To die—to sleep,No more; and by a sleep to say we endThe heart-ache and the thousand natural shocksThat flesh is heir to: 'tis a consummationDevoutly to be wish'd. To die, to sleep;To sleep, perchance to dream—ay, there's the rub:For in that sleep of death what dreams may come,When we have shuffled off this mortal coil,Must give us pause—there's the respectThat makes calamity of so long life.For who would bear the whips and scorns of time,Th'oppressor's wrong, the proud man's contumely,The pangs of dispriz'd love, the law's delay,The insolence of office, and the spurnsThat patient merit of th'unworthy takes,When he himself might his quietus makeWith a bare bodkin? Who would fardels bear,To grunt and sweat under a weary life,But that the dread of something after death,The undiscovere'd country, from whose bournNo traveller returns, puzzles the will,And makes us rather bear those ills we haveThan fly to others that we know not of?Thus conscience does make cowards of us all,And thus the native hue of resolutionIs sicklied o'er with the pale cast of thought,And enterprises of great pitch and momentWith this regard their currents turn awryAnd lose the name of action.",Xm={outside:{onError:function(e,r){var t=null!=r.error.stack?r.error.stack:r.error.message,n="calc.worker.smokeTestOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:t});C.ULS.traceTag(595910859,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,n)},onClosed:function(e){C.ULS.traceTag(595908701,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"calc.worker.smokeTestOutsideDef.onClose")},onInit:function(e){e.setExports("talk",{ping:function(e,r){if(r&&e%1e3==0){var t="calc.worker.smokeTestOutsideDef.ping: n = "+e;C.ULS.traceTag(595907657,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}return e+1}})}},inside:qm},Qm=!1,zm=void 0;function Zm(){null!=zm&&zm.close(),Qm=!1}var $m=Promise.resolve();function eE(e,r,t,n){return void 0===n&&(n=0),dt(ot.CalcWebWorkerTest)?(Zm(),$m=$m.then((function(a){return function(e,r,t,n){return it.__awaiter(this,void 0,void 0,(function(){var a,o,i,u,c,s,f,d=this;return it.__generator(this,(function(h){switch(h.label){case 0:Qm=!0,h.label=1;case 1:return h.trys.push([1,8,9,10]),f="calc.worker.runSmokeTest: starting; duration = "+e+"ms, pingInterval = "+r+"ms",C.ULS.traceTag(595908687,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,f),[4,Km([em.Dedicated,em.MessageChannel,em.FunctionCall],Xm)];case 2:if(null==(zm=h.sent()))throw new Error("could not create any kind of worker");if(!Qm)throw new Error("smoke test canceled during worker creation");return f="calc.worker.runSmokeTest: worker created; outside.workerKind = "+zm.workerKind,C.ULS.traceTag(595907658,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,f),a=zm.getImports("talk",["start","memoryTest","ping","logMessage"]),o=zm.getImports("location",["gridCell"]),[4,a.ping.call(-1,t)];case 3:return i=h.sent(),[4,o.gridCell.call(2,3)];case 4:if(u=h.sent(),0!==i||2!==u.row||3!==u.col)throw new Error("expected 0, 2, 3; got "+i+", "+u.row+", "+u.col);return n>0&&zm.workerKind===em.Dedicated?[4,a.memoryTest.call(n)]:[3,6];case 5:h.sent(),h.label=6;case 6:return a.start.notify(e,r,t),c=Date.now(),[4,Em((function(n){return it.__awaiter(d,void 0,void 0,(function(){var o;return it.__generator(this,(function(i){switch(i.label){case 0:return Date.now()>=c+e?[2,void 0]:n%1e3!=0?[3,3]:(o=ct("calc.worker.runSmokeTest: ping call roundtrip"),[4,a.ping.call(n,!1)]);case 1:return i.sent(),o.stop(),o=ct("calc.worker.runSmokeTest: logMessage notify"),[4,a.logMessage.notify(Ym,!1)];case 2:i.sent(),o.stop(),i.label=3;case 3:return[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 4:return i.sent(),a.ping.notify(n,t),[2,n+1]}}))}))}),0)];case 7:return h.sent(),f="calc.worker.runSmokeTest: success",C.ULS.traceTag(595906821,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,f),[3,10];case 8:return s=h.sent(),Qm&&(f="calc.worker.runSmokeTest: failure: "+(null!=s.stack?s.stack:s.message),C.ULS.traceTag(595908702,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Error,f)),[3,10];case 9:return Zm(),zm=void 0,[7];case 10:return[2]}}))}))}(e,r,t,n)}))):Promise.resolve()}var rE,tE=t(1).__assign;function nE(e){var r,t,n,a=it.__assign({},e,{split:(r=e.split,t=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var a=r(e),o=e===t?0:e.depth;return void 0!==o&&o<n&&(e.split=a,a[0][0].depth=o+1,a[1][0].depth=o+1),a})});return function(e){return aE(a,vE(a,a.top,e))}}function aE(e,r){return r===hE||r===dE?r:{setOperations:e,root:r}}function oE(e,r,t){if(t===hE)return r;if(t===dE)return t;if(r===hE)return t;if(r===dE)return r;if(r.isExact&&t.isExact){var n=function(e,r,t){var n=r.pathKey,a=r.key,o=t.key,i=e.compare(a,o);if(void 0!==i)return i<0?t:r;var u=e.union(a,o);if(void 0!==u){var c=e.compare(u,n);return void 0!==c&&0===c?dE:gE(n,u,!0)}return}(e,r,t);if(void 0!==n)return n}var a=mE(e,r),o=mE(e,t);return fE(oE(e,a.left,o.left),oE(e,a.right,o.right))}function iE(e,r,t){if(r===hE)return r;if(t===hE)return t;if(r===dE)return t;if(t===dE)return r;if(r.isExact&&t.isExact){var n=function(e,r,t){var n=r.pathKey,a=r.key,o=t.key;if(!e.meets(a,o))return hE;var i=e.compare(a,o);if(void 0!==i)return i<0?r:t;var u=e.intersect(a,o);if(void 0!==u)return gE(n,u,!0);return}(e,r,t);if(void 0!==n)return n}var a=mE(e,r),o=mE(e,t);return fE(iE(e,a.left,o.left),iE(e,a.right,o.right))}function uE(e,r,t){if(r===hE||t===hE)return!1;if(r===dE||t===dE)return!0;if(r.isExact&&t.isExact)return e.meets(r.key,t.key);var n=mE(e,r),a=mE(e,t);return uE(e,n.left,a.left)||uE(e,n.right,a.right)}function cE(e,r,t){if(r===hE)return r;if(t===hE)return r;if(t===dE)return hE;if(r===dE){var n=mE(e,t);return fE(cE(e,dE,n.left),cE(e,dE,n.right))}if(r.isExact&&t.isExact){var a=function(e,r,t){var n=r.pathKey,a=r.key,o=t.key;if(!e.meets(a,o))return r;var i=e.except(a,o);if(void 0!==i)return gE(n,i,!0);return}(e,r,t);if(void 0!==a)return a}var o=mE(e,r),i=mE(e,t);return fE(cE(e,o.left,i.left),cE(e,o.right,i.right))}function sE(e,r){if(void 0!==e&&void 0!==r)return 0===e?r:0===r?e:e===r?e:void 0}function lE(e,r,t){if(r===t)return 0;if(r===hE)return-1;if(t===hE)return 1;if(r===dE)return t===dE?0:1;if(t===dE)return-1;if(r.isExact&&t.isExact)return function(e,r,t){return e.compare(r.key,t.key)}(e,r,t);var n=mE(e,r),a=mE(e,t),o=lE(e,n.left,a.left);if(void 0!==o){var i=lE(e,n.right,a.right);if(void 0!==i)return sE(o,i)}}function fE(e,r){return e===hE?r===hE?hE:pE(e,r,void 0,void 0,!1):r===hE?pE(e,r,void 0,void 0,!1):e===dE&&r===dE?dE:pE(e,r,void 0,void 0,!1)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(rE||(rE={}));var dE=rE.Dense,hE=rE.Empty;function pE(e,r,t,n,a){return{key:n,pathKey:t,left:e,right:r,isExact:a}}function vE(e,r,t){if(!e.meets(r,t))return hE;var n=e.compare(r,t);if(void 0!==n)return n<=0?dE:gE(r,t,!0);var a=e.intersect(r,t);return void 0!==a?gE(r,a,!0):gE(r,t,!1)}function gE(e,r,t){return pE(void 0,void 0,e,r,!!t)}function mE(e,r){if(void 0!==r.left)return r;var t=e.split(r.pathKey),n=t[0][0],a=t[1][0],o=fE(vE(e,n,r.key),vE(e,a,r.key));if(o===hE||o===dE)throw new Error("incorrect set operations implementation");var i=o;return tE(r,{left:i.left,right:i.right})}function EE(e,r){return e===hE||function(e,r,t){return function r(n,a){if(a===hE)return!0;if(a===dE)return t(n);if(a.isExact)return t(a.key);var o=mE(e,a),i=e.split(n),u=i[0][0],c=i[1][0];return r(u,o.left)&&r(c,o.right)}(e.top,r)}(e.setOperations,e.root,r)}function SE(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return[vr(t,a),pr(n,o)]}function TE(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return vr(t,a)<pr(n,o)}function CE(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return t<a&&o>=n?[t,a]:t>=a&&o<n?[o,n]:void 0}function RE(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return t===a&&n===o?0:t>=a&&n<=o?-1:t<=a&&n>=o?1:void 0}function IE(e,r,t){var n=function(e,r,t){var n=Math.pow(r,e),a=1-Math.pow(r/t,e),o=Math.pow(t,e),i=o*n,u=o-n,c=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(r){return(1-n*Math.pow(r,-e))/a},invCdf:1===e?function(e){return 1/((o-e*u)/i)}:function(e){return Math.pow((o-e*u)/i,c)}}}(e,r,t);return{canSplit:function(e){var r=e[0];return e[1]-r>1},split:function(e){var r=e[0],t=e[1],a=n.cdf(t),o=n.cdf(r+1),i=n.invCdf((a+o)/2),u=Math.min(Math.max(Math.round(i),r+1),t-1);return[[[r,u],n.cdf(u)-n.cdf(r+1)],[[u,t],n.cdf(t)-n.cdf(u)]]}}}function yE(e,r,t,n,a){var o=IE(e,r,t);return{id:a,split:function(e){return o.split(e)},canSplit:function(e){return o.canSplit(e)},meets:TE,intersect:SE,union:function(e,r){return n=r,a=(t=e)[0],o=t[1],i=n[0],u=n[1],vr(a,i)<=pr(o,u)?function(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return[pr(t,a),vr(n,o)]}(e,r):void 0;var t,n,a,o,i,u},except:CE,compare:RE,top:n}}var AE=[{},{}];function NE(e){var r=!0;for(var t in e)if(e.hasOwnProperty(t)){r=!1;break}return r?dE:{isSubspace:!0,bounds:e}}function OE(e,r,t){return{isSubspace:!1,left:e,right:r,bounds:t,subspaceCount:zE(e)+zE(r)}}function kE(e,r){if(r===dE)return r;if(r.isSubspace){var t=!1;for(var n in r.bounds)if(e.hasOwnProperty(n)){t=!0;break}if(!t)return dE}return{productOperations:e,root:r}}var LE,DE={unzip:function(e){var r={},t={};for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];if(a===hE)return hE;if(a===dE)continue;r[n]=a.setOperations,t[n]=a.root}return kE(r,NE(t))},combineProduct:function(e,r,t,n){var a={};for(var o in e)if(e.hasOwnProperty(o)){var i=n(e[o],FE(r[o]),FE(t[o]));if(i===hE)return i;if(i===dE)continue;a[o]=i}return a},restrict:function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n={},a=0,o=r;a<o.length;a++){var i=o[a];if(e.hasOwnProperty(i)){var u=e[i];n[i]=u}}return n},fromUntypedProduct:function(e,r,t){for(var n={},a=0,o=t;a<o.length;a++){var i=o[a],u=r[i];n[i]=aE(e[i],void 0!==u?u:dE)}return n},denseProduct:function(e){for(var r={},t=0,n=e;t<n.length;t++){r[n[t]]=dE}return r}},_E=DE.unzip;function FE(e){return void 0===e?dE:e}function ME(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];if(e===dE||e===hE)return e;var n=DE.restrict.apply(DE,[e.productOperations].concat(r)),a=bE.apply(void 0,[n,e.root].concat(r));return a===hE?a:kE(n,a)}function bE(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var a=DE.restrict.apply(DE,[r.bounds].concat(t));if(r.isSubspace)return NE(a);var o=bE.apply(void 0,[e,r.left].concat(t));if(o===dE)return dE;var i=bE.apply(void 0,[e,r.right].concat(t));return HE(e,o,i)}function wE(e,r){if(r===hE)return e;if(r===dE)return r;if(e===hE)return r;if(e===dE)return e;var t=it.__assign({},e.productOperations,r.productOperations),n=BE(t,e.root,r.root,AE);return n===hE?n:kE(t,n)}function UE(e,r){if(e===hE)return e;if(r===hE)return r;if(e===dE)return r;if(r===dE)return e;var t=it.__assign({},e.productOperations,r.productOperations),n=VE(t,e.root,r.root,AE);return n===hE?n:kE(t,n)}function PE(e,r){if(e===hE)return e;if(r===hE)return e;if(r===dE)return hE;if(e===dE){var t=WE(r.productOperations,dE,r.root,AE);return t===hE?t:kE(r.productOperations,t)}var n=it.__assign({},e.productOperations,r.productOperations),a=WE(n,e.root,r.root,AE);return a===hE?a:kE(n,a)}function GE(e,r){return e===r?0:e===hE?-1:r===hE?1:e===dE?r===dE?0:1:r===dE?-1:function e(r,t,n,a){if(t===n)return 0;if(t===hE)return-1;if(n===hE)return 1;if(t===dE)return n===dE?0:1;if(n===dE)return-1;if(t.isSubspace&&n.isSubspace)return jE(r,t.bounds,n.bounds);var o=YE(r,a),i=o[0],u=o[1];var c=XE(r,t,i,u),s=c[0],l=c[1];var f=XE(r,n,i,u),d=f[0],h=f[1];var p=e(r,s,d,i);if(void 0===p)return;return sE(p,e(r,l,h,u))}(it.__assign({},e.productOperations,r.productOperations),e.root,r.root,AE)}function xE(e,r){return e!==hE&&r!==hE&&(e===dE||r===dE||function e(r,t,n,a){if(t===hE||n===hE)return!1;if(t===dE||n===dE)return!0;if(!function(e,r,t){for(var n in e)if(e.hasOwnProperty(n)){var a=FE(r[n]),o=FE(t[n]);if(!uE(e[n],a,o))return!1}return!0}(r,t.bounds,n.bounds))return!1;if(t.isSubspace&&n.isSubspace)return!0;var o=YE(r,a),i=o[0],u=o[1];var c=XE(r,t,i,u),s=c[0],l=c[1];var f=XE(r,n,i,u),d=f[0],h=f[1];return e(r,s,d,i)||e(r,l,h,u)}(it.__assign({},e.productOperations,r.productOperations),e.root,r.root,AE))}function BE(e,r,t,n){if(t===hE)return r;if(r===hE)return t;if(r===dE)return r;if(t===dE)return t;if(r.isSubspace&&t.isSubspace){var a=KE(e,r,t);if(void 0!==a)return a}return qE(e,r,t,n,BE)}function VE(e,r,t,n){if(r===hE||t===hE)return hE;if(r===dE)return t;if(t===dE)return r;if(r.isSubspace&&t.isSubspace){var a=DE.combineProduct(e,r.bounds,t.bounds,iE);return a===hE?hE:NE(a)}return qE(e,r,t,n,VE)}function WE(e,r,t,n){if(r===hE)return r;if(t===dE)return hE;if(t===hE)return r;if(r===dE)return qE(e,r,t,n,WE);if(r.isSubspace&&t.isSubspace){var a=function(e,r,t){var n,a=jE(e,r.bounds,t.bounds);if(0===a||-1===a)return hE;var o=void 0;for(var i in e)if(e.hasOwnProperty(i)){var u=lE(e[i],FE(r.bounds[i]),FE(t.bounds[i]));if(void 0===u||u>0){if(void 0!==o)return;o=i}}if(void 0!==o){var c=cE(e[o],FE(r.bounds[o]),FE(t.bounds[o]));if(c===hE)return hE;if(c===dE){var s=r.bounds,l=o;s[l];return NE(it.__rest(s,["symbol"==typeof l?l:l+""]))}return NE(it.__assign({},r.bounds,((n={})[o]=c,n)))}return}(e,r,t);if(void 0!==a)return a}return qE(e,r,t,n,WE)}function HE(e,r,t){if(t===hE)return r;if(t===dE)return t;if(r===hE)return t;if(r===dE)return r;if(!r.isSubspace||!t.isSubspace)return OE(r,t,JE(e,r.bounds,t.bounds));var n=KE(e,r,t);return void 0!==n?n:OE(r,t,JE(e,r.bounds,t.bounds))}function KE(e,r,t){var n,a=jE(e,r.bounds,t.bounds);if(void 0!==a)return a<=0?t:r;var o=void 0;for(var i in e){if(e.hasOwnProperty(i))if(0!==lE(e[i],FE(r.bounds[i]),FE(t.bounds[i]))){if(void 0!==o)return;o=i}}if(void 0!==o){var u=oE(e[o],FE(r.bounds[o]),FE(t.bounds[o]));if(u===hE)return hE;if(u===dE){var c=r.bounds,s=o;c[s];return NE(it.__rest(c,["symbol"==typeof s?s:s+""]))}return NE(it.__assign({},r.bounds,((n={})[o]=u,n)))}}function jE(e,r,t){var n=0;for(var a in e)if(e.hasOwnProperty(a)){var o=FE(r[a]),i=FE(t[a]);if(void 0===(n=sE(n,lE(e[a],o,i))))return}return n}function JE(e,r,t){var n=DE.combineProduct(e,r,t,oE);if(n===hE)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function qE(e,r,t,n,a){var o=YE(e,n),i=o[0],u=o[1],c=XE(e,r,i,u),s=c[0],l=c[1],f=XE(e,t,i,u),d=f[0],h=f[1],p=a(e,s,d,i);return p===dE?dE:HE(e,p,a(e,l,h,u))}function YE(e,r){var t,n,a,o,i,u=r[0],c=r[1],s=void 0,l=0;for(var f in e)if(e.hasOwnProperty(f)){var d=c[f],h=e[f];if(void 0===d){s=f,i=h.top;break}if(d>l){var p=FE(u[f]);if(p===hE)throw new Error("the key split can never return empty");var v=h.top;if(p!==dE){if(!p.isExact)throw new Error("the key can always be represented exactly");v=p.key}if(!h.canSplit(v))continue;s=f,l=d,i=v}}if(void 0===s||void 0===i)throw new Error("there has to be at least one dimension");var g=e[s],m=g.split(i),E=m[0],S=E[0],T=E[1],C=m[1],R=C[0],I=C[1];return[[it.__assign({},u,(t={},t[s]=vE(g,g.top,S),t)),it.__assign({},c,(n={},n[s]=T,n))],[it.__assign({},u,(a={},a[s]=vE(g,g.top,R),a)),it.__assign({},c,(o={},o[s]=I,o))]]}function XE(e,r,t,n){var a=t[0],o=n[0];return[QE(e,r,a),QE(e,r,o)]}function QE(e,r,t){if(t===hE||r===hE)return hE;if(r===dE)return NE(t);var n=jE(e,r.bounds,t);if(void 0!==n&&n<=0)return r;var a=DE.combineProduct(e,r.bounds,t,iE);return a===hE?hE:r.isSubspace?NE(a):HE(e,QE(e,r.left,t),QE(e,r.right,t))}function zE(e){return e.isSubspace?1:e.subspaceCount}!function(e){e[e.Available=0]="Available",e[e.Failure=1]="Failure"}(LE||(LE={}));var ZE=[LE.Available,LE.Failure+1],$E=[0,1<<20],eS=[0,16384],rS={availability:yE(1,ZE[0]+1,ZE[1],ZE,"Availability operations, alpha = 1"),row:yE(.2,$E[0]+1,$E[1],$E,"Row operations, alpha = 0.2"),col:yE(.35,eS[0]+1,eS[1],eS,"Col operations, alpha = 0.35")},tS={availability:nE(rS.availability),row:nE(rS.row),col:nE(rS.col)};function nS(e){return _E({row:tS.row([e.row,e.row+e.rows]),col:tS.col([e.col,e.col+e.cols])})}var aS=_E({availability:tS.availability([LE.Available,LE.Available+1])}),oS=_E({availability:tS.availability([LE.Failure,LE.Failure+1])});function iS(e,r){return function(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var a=ME.apply(void 0,[e].concat(t));if(a===hE)return!0;if(a===dE)return r(DE.denseProduct(t));var o=a.productOperations;return function e(n){return n.isSubspace?r(DE.fromUntypedProduct(o,n.bounds,t)):e(n.left)&&e(n.right)}(a.root)}(e,(function(e){return function(e,r){return e!==dE?EE(e,r):r(rS.row.top)}(e.row,(function(t){var n=t[0],a=t[1];return function(e,r){return e!==dE?EE(e,r):r(rS.col.top)}(e.col,(function(e){var t=e[0],o=e[1];return r(b(n,t,a-n,o-t))}))}))}),"row","col")}function uS(e,r){return iS(e,(function(e){return Ar(e,r)}))}function cS(e,r,t){if(void 0!==t){var n=e.slice();return n[r]=t,n}var a=e.slice(0,-1);return r<e.length-1&&(a[r]=e[e.length-1]),a}function sS(e,r,t){return{kind:e,key:r,value:t}}function lS(e,r){return sS(1,e,r)}function fS(e,r){return sS(2,e,r)}function dS(e,r){return sS(3,e,r)}var hS=function(){function e(e,r,t){this.lattice=e,this.root=r,this.count=t}return e.create=function(r,t,n,a,o){void 0===o&&(o=2);var i=o>1?Math.ceil(o):1;return new e({keyJoin:r,keyMeets:t,keyCompare:n,keyDistance:a,minChildren:i,maxChildren:2*i,keyGe:function(e,r){var t=n(e,r);return void 0!==t&&t>=0},keyLe:function(e,r){var t=n(e,r);return void 0!==t&&t<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){if(void 0!==this.root)return function r(t,n){var a=t.keyCompare(n.key,e);if(1===n.kind)return 0===a?n.value:void 0;if(!(void 0===a||a<0))for(var o=0,i=n.value;o<i.length;o++){var u=r(t,i[o]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.setValue=function(r,t,n){void 0===n&&(n=function(e){return!0});var a=SS(this.lattice,this.root,r,n,t);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,ES(this.lattice,this.root,lS(r,t)),this.count+1)},e.prototype.filter=function(r){var t=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return r(e,n)&&(t=t.setValue(e,n)),!0})),t},e.prototype.contains=function(e,r){return void 0===r&&(r=function(e){return!0}),void 0!==SS(this.lattice,this.root,e,r)},e.prototype.getOrSetValue=function(e,r){var t=this.getValue(e);if(void 0===t){var n=r();return[this.setValue(e,n),n]}return[this,t]},e.prototype.forEach=function(e){pS(this.root,e)},e.prototype.forEachGe=function(e,r){var t=this;pS(this.root,r,(function(r){return t.lattice.keyGe(r,e)}),(function(r){return t.lattice.keyGe(r,e)}))},e.prototype.forEachLe=function(e,r){var t=this;pS(this.root,r,(function(r){return t.lattice.keyMeets(r,e)}),(function(r){return t.lattice.keyLe(r,e)}))},e.prototype.forEachMeets=function(e,r){var t=this;pS(this.root,r,(function(r){return t.lattice.keyMeets(r,e)}),(function(r){return t.lattice.keyMeets(r,e)}))},e.prototype.remove=function(r){var t=this;if(null==this.root)return this;var n=[],a=this.lattice,o=function(e,t){var i=a.keyCompare(e.key,r);if(void 0===i||i<0)return hr(e,1);if(2===e.kind){for(var u=e.value,c=0;c<u.length;c+=1)if(0===a.keyCompare(u[c].key,r)){if((h=cS(u,c)).length<t){var s=fS(e.key,h);return n.push(s),hr(s,3)}return hr(fS(gS(a,h),h),2)}}else for(u=e.value,c=0;c<u.length;c+=1){var l=o(u[c],a.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=cS(u,c)).length>=t)return hr(dS(gS(a,h),h),2);s=dS(e.key,h);return n.push(s),hr(s,3)}if(2===d)return hr(dS(e.key,cS(u,c,f)),2)}return hr(e,1)},i=2===this.root.kind?1:2,u=o(this.root,i),c=u[0],s=u[1];if(c===this.root)return this;for(var l=3===s?void 0:c,f=0;f<n.length;f+=1)pS(n[f],(function(e,r){return l=ES(t.lattice,l,lS(e,r)),!0}));return new e(this.lattice,l,this.count-1)},e}();function pS(e,r,t,n){var a=void 0!==t?t:function(){return!0},o=void 0!==n?n:function(){return!0};if(null!=e){var i=function(e){if(!a(e.key))return!0;if(2===e.kind)for(var t=e.value,n=0;n<t.length;n+=1){var u=t[n];if(o(u.key)&&!r(u.key,u.value))return!1}else for(t=e.value,n=0;n<t.length;n+=1)if(!i(t[n]))return!1;return!0};i(e)}}function vS(e,r){for(var t=function(e,r){for(var t=0,n=1,a=e.keyDistance(r[0].key,r[1].key),o=2;o<r.length;o+=1)for(var i=0;i<o;i+=1){var u=e.keyDistance(r[i].key,r[o].key);u>a&&(t=i,n=o,a=u)}return hr(t,n)}(e,r),n=t[0],a=t[1],o=r[n].key,i=r[a].key,u=[],c=0;c<r.length;c+=1){var s=r[c];u.push([s,e.keyDistance(o,s.key)-e.keyDistance(i,s.key)])}u.sort((function(e,r){return e[1]-r[1]}));for(var l=e.minChildren;l<r.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(c=0;c<l;c+=1)f.push(u[c][0]);for(c=l;c<r.length;c+=1)d.push(u[c][0]);return hr(f,d)}function gS(e,r){for(var t=r[0].key,n=1;n<r.length;n+=1)t=e.keyJoin(t,r[n].key);return t}function mS(e,r,t){var n=vS(e,t),a=n[0],o=n[1];return hr(sS(r,gS(e,a),a),sS(r,gS(e,o),o))}function ES(e,r,t){if(null==r)return fS(t.key,[t]);var n=function r(n){if(2===n.kind){var a=n.value.concat([t]);if(a.length>e.maxChildren){var o=mS(e,n.kind,a),i=o[0],u=o[1];return hr(fS(i.key,i.value),u)}return hr(fS(e.keyJoin(n.key,t.key),a),void 0)}var c=n.value.slice(),s=function(e,r,t){for(var n=0,a=e.keyDistance(r[0].key,t),o=r[0].value.length,i=1;i<r.length;i+=1){var u=r[i],c=e.keyDistance(u.key,t);(c<a||c===a&&u.value.length<o)&&(n=i,a=c,o=u.value.length)}return n}(e,c,t.key),l=r(c[s]),f=l[0],d=l[1];if(c[s]=f,null!=d&&(c.push(d),c.length>e.maxChildren)){var h=mS(e,n.kind,c),p=h[0];u=h[1];return hr(dS(p.key,p.value),u)}return hr(dS(e.keyJoin(n.key,t.key),c),void 0)}(r),a=n[0],o=n[1];return null!=o?dS(e.keyJoin(a.key,o.key),[a,o]):a}function SS(e,r,t,n,a){if(void 0!==r)return function r(n){if(2!==n.kind)for(a=0;a<n.value.length;a+=1){i=n.value[a];if(e.keyMeets(i.key,t))if(void 0!==(u=r(i)))return dS(n.key,cS(n.value,a,u))}else for(var a=0;a<n.value.length;a+=1){var i,u;if(void 0!==(u=o(i=n.value[a])))return fS(n.key,cS(n.value,a,u))}}(r);function o(r){if(0===e.keyCompare(r.key,t))return void 0!==a&&r.value!==a&&n(r.value)?lS(r.key,a):r}}function TS(e){return{entries:{},keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.entries[this.keyToString(e)];return lr(r)?r.value:void 0},setValue:function(e,r){var t=this.keyToString(e),n=this.entries[t];lr(n)?n.value=r:this.entries[t]=Yv(e,r)},contains:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&null!==this.entries[r]},remove:function(e){var r=this.keyToString(e);return void 0!==this.entries[r]&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var t=this.keyToString(e),n=this.entries[t];if(lr(n))return n.value;var a=r();return delete this.entries[t],this.entries[t]=Yv(e,a),a},forEach:function(e){for(var r in this.entries){var t=this.entries[r];null!=t&&e(t.key,t.value)}},filter:function(e){var r=[];this.forEach((function(t,n){return e(t,n)||r.push(t),!0}));for(var t=0,n=r;t<n.length;t++){var a=n[t];this.remove(a)}}}}function CS(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols;return vr(t,i)<pr(t+a,i+c)&&vr(n,u)<pr(n+o,u+s)}function RS(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=t+a,s=i+r.rows,l=n+o,f=u+r.cols;return t===i&&c===s&&n===u&&l===f?0:t<=i&&c>=s&&n<=u&&l>=f?1:t>=i&&c<=s&&n>=u&&l<=f?-1:void 0}function IS(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,s=r.cols;return gr(t-i+.5*(a-c))+gr(n-u+.5*(o-s))}function yS(){return hS.create(hf,CS,RS,IS)}var AS,NS=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var r=this.getCount()-1;r>0;){var t=r-1>>>1,n=this.items[t];if(!(this.cmp(n,e)>0))break;this.items[r]=n,r=t}this.items[r]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),r=this.items.pop(),t=this.getCount()-1;if(t<0||void 0===r)return e;var n=0;for(this.items[0]=r;n<t;){var a=n,o=1+(n<<1),i=2+(n<<1);if(o<=t&&this.cmp(this.items[o],r)<0&&(a=o),i<=t&&this.cmp(this.items[i],a===o?this.items[a]:r)<0&&(a=i),n===a)break;this.items[n]=this.items[a],n=a}return this.items[n]=r,e},e.prototype.getCount=function(){return this.items.length},e.prototype.forEach=function(e){for(var r=0,t=this.items;r<t.length;r++){if(!e(t[r]))return}},e}(),OS=function(){function e(e){this.min=0,this.max=0,this.heap=new NS((function(r,t){var n=r[0],a=r[1],o=t[0],i=t[1],u=e(n,o);return 0!==u?u:a-i}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e}();!function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell"}(AS||(AS={}));var kS,LS,DS,_S,FS={calculatedCellCount:0,changedCellCount:0,continueCount:0,recalcFinished:!1};function MS(e,r){switch(r){case kS.ChangedCell:return it.__assign({},e,{changedCellCount:e.changedCellCount+1,calculatedCellCount:e.calculatedCellCount+1});case kS.UnchangedCell:return it.__assign({},e,{calculatedCellCount:e.calculatedCellCount+1});case kS.ContinueComputation:return it.__assign({},e,{continueCount:e.continueCount+1});case kS.RecalcFinished:return it.__assign({},e,{recalcFinished:!0});default:return I("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",r)}}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.RecalcFinished="RecalcFinished"}(kS||(kS={})),function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.ContinueComputation=2]="ContinueComputation",e[e.ComputeCellValue=3]="ComputeCellValue",e[e.MaybeCollectGarbage=4]="MaybeCollectGarbage"}(LS||(LS={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.ExtendAvailableRange="ExtendAvailableRange",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(DS||(DS={})),function(e){e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.RangeFailure="RangeFailure",e.UnloggedFailure="UnloggedFailure",e.UpdateRequest="UpdateRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics"}(_S||(_S={}));var bS=function(e){return e}((function(e,r,t,n){return{isExact:e,iformat:r,category:t,decimals:n}})),wS={fmla:"",source:m.Cell,compiledFmla:void 0},US={fmla:"",source:m.Range,compiledFmla:void 0};function PS(e,r,t,n){return e.setValue(r,{source:t,fmla:n,compiledFmla:void 0},(function(e){return e.source!==t||e.fmla!==n}))}function GS(e,r){return e.forEachMeets(r,(function(r,t){if(t.fmla.length>0){var n=t.source===m.Cell?wS:US;e=e.setValue(r,n)}return!0})),e}var xS={values:yS(),formats:yS(),formulae:yS()},BS={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,recalcValuesNodeCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0};function VS(e,r){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+r.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+r.serverFormatsNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+r.serverValuesNodeCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+r.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+r.editedFormatsNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+r.editedValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+r.recalcValuesNodeCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+r.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+r.availabilityHistorySize}}var WS,HS=function(){function e(e,r,t){this.sheet=e,this.sheetId=r,this.stateId=t,this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=this.editedContents=xS,this.recalcValues=this.editedContents.values,this.availability=this.extendedAvailability=hE}return e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcValues=this.editedContents.values,this.oldAvailabilities[this.stateId]=this.availability,this.availabilityHistorySize+=1,this.stateId=e,this.availability=this.extendedAvailability},e.prototype.checkAvailability=function(e){var r=UE(nS(e),aS),t=GE(this.availability,r);if(void 0===t||t<0)return Ur.Unavailable;var n=UE(nS(e),oS),a=GE(UE(this.availability,n),hE);return void 0!==a&&a>0?wr.Failure:wr.Success},e.prototype.setAvailable=function(e){this.availability=wE(this.availability,UE(e,aS))},e.prototype.setFailure=function(e){this.availability=wE(this.availability,UE(e,oS))},e.prototype.foreachAvailableCell=function(e){uS(this.availability,e)},e.prototype.tryPromoteAvailability=function(e,r){var t=UE(e,aS),n=this.oldAvailabilities[r];if(void 0===n)return!1;var a=GE(n,t);return void 0!==a&&a>=0&&(this.availability=wE(this.availability,t),!0)},e.prototype.extendAvailability=function(e){var r=UE(e,aS);this.availability=wE(this.availability,r),this.extendedAvailability=wE(this.extendedAvailability,r)},e.prototype.setValues=function(e,r){var t=this;Ar(e,(function(e,n,a){return t.recalcValues=t.recalcValues.setValue(e,function(e){return Array.isArray(e)}(r)?r[n][a]:r),!0}))},e.prototype.tryGetValue=function(e){var r=this.recalcValues.getValue(e);if(void 0!==r)return cf(r)?void 0:r},e.prototype.tryGetServerValue=function(e){var r=this.serverContents.values.getValue(e);if(void 0!==r)return cf(r)?void 0:r},e.prototype.setEditFormat=function(e,r){this.editedContents=it.__assign({},this.editedContents,{formats:this.editedContents.formats.setValue(e,r)})},e.prototype.tryGetFormat=function(e){return this.editedContents.formats.getValue(e)},e.prototype.tryGetServerFormat=function(e){return this.serverContents.formats.getValue(e)},e.prototype.tryGetFormula=function(e){var r=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,t){return 0===t.fmla.length||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,r){e&&(this.serverContents=r),this.editedContents=r,this.recalcValues=this.editedContents.values},e.prototype.setCellContents=function(e,r,t,n,a){var o=e?this.serverContents:this.editedContents,i=o.values,u=o.formats,c=o.formulae;void 0!==t&&iS(r,(function(e){return c=GS(c,e),!0})),uS(r,(function(e){return void 0!==t&&(c=PS(c,e,m.Cell,t)),void 0!==a&&(u=u.setValue(e,a)),i=i.setValue(e,n),!0})),this.setContents(e,{values:i,formats:u,formulae:c}),this.setAvailable(r)},e.prototype.setRangeFormula=function(e,r,t){var n=e?this.serverContents:this.editedContents,a=n.values,o=n.formats,i=n.formulae;e||a.forEachLe(r,(function(e,r){return cf(r)||(a=a.setValue(e,ge)),!0})),i=PS(i=GS(i,r),r,m.Range,t),this.setContents(e,{values:a,formats:o,formulae:i}),this.setAvailable(nS(r))},e.prototype.clearCompiledFormulas=function(){for(var e=0,r=[this.serverContents.formulae,this.editedContents.formulae];e<r.length;e++){r[e].forEach((function(e,r){return r.compiledFmla=void 0,!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(e=this.availability,e===hE||e===dE?0:zE(e.root))};var e},e.prototype.collectGarbage=function(e){var r=hE;for(var t in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(t)){var n=Number(t);if(n>=e){r=wE(r,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return xE(UE(nS(e),aS),r)}this.serverContents={formulae:this.serverContents.formulae.filter(a),formats:this.serverContents.formats.filter(a),values:this.serverContents.values.filter(a)},this.editedContents={formulae:this.editedContents.formulae.filter(a),formats:this.editedContents.formats.filter(a),values:this.editedContents.values.filter(a)},this.recalcValues=this.recalcValues.filter(a)},e}(),KS=1<<20,jS=16384;function JS(e,r){e[r]=(e[r]||0)+1}function qS(e,r,t){return e.push(r.join(".")+": expected "+t),!1}function YS(e,r){return function(t,n,a){return lr(t)&&e(t)||qS(n,a,r)}}function XS(e,r,t,n){for(var a=[],o=r(e,a,[n]),i=0,u=a;i<u.length;i++){JS(t,u[i])}return o}function QS(e){return function(r,t,n){return!!fr(r)||e(r,t,n)}}function zS(e){return function(r,t,n){if(fr(r))return qS(t,n,"non-null object");var a=n.length;try{var o=!0;for(var i in e)n[a]=i,o=o&&e[i](r[i],t,n);return o}finally{n.length=a}}}function ZS(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(r,t,n){return e.reduce((function(e,a){return e&&a(r,t,n)}),!0)}}function $S(e){return function(r,t,n){if(!Array.isArray(r))return qS(t,n,"Array");n.push("<index>");try{return r.reduce((function(r,a){return r&&e(a,t,n)}),!0)}finally{n.pop()}}}function eT(e){return"number"==typeof e&&e>-1/0&&e<1/0}function rT(e){return(0|e)===e||Math.floor(e)===e}function tT(e,r){return void 0===r&&(r="natural < "+e),YS((function(r){return"number"==typeof r&&r>=0&&r<e&&rT(r)}),r)}var nT=YS(eT,"finite number"),aT=YS((function(e){return eT(e)&&rT(e)}),"integer"),oT=tT(1/0,"natural"),iT=YS((function(e){return"string"==typeof e}),"string"),uT=YS((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),cT=YS((function(e){return"boolean"==typeof e}),"boolean"),sT=zS({functionId:oT,functionName:uT}),lT=zS({errorType:oT,errorName:uT}),fT={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},dT=zS({iformat:oT,category:YS((function(e){return"string"==typeof e&&!0===fT[e]}),"NumberFormatCategory"),decimals:oT}),hT=zS({sheetId:nT,sheetName:iT}),pT=tT(KS),vT=tT(jS),gT=zS({row:pT,column:vT}),mT=ZS(gT,zS({lastRow:QS(pT),lastColumn:QS(vT)})),ET={number:!0,string:!0,boolean:!0,Blank:!0,Error:!0,Rich:!1},ST=YS((function(e){var r="object"==typeof e?e.kind:typeof e;return"string"==typeof r&&!0===ET[r]}),"supported CellValue"),TT=zS({formulaBarText:QS(iT),value:ST,iformat:oT}),CT=zS({range:mT,excludeRows:QS($S(pT)),excludeColumns:QS($S(vT)),data:QS(TT),fromStateId:QS(aT)}),RT=zS({isSpilled:cT,formulaBarText:YS((function(e){return"string"==typeof e&&"="===e[0]}),"formula text")}),IT=zS({range:mT,data:QS(RT),fromStateId:QS(aT)});function yT(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var AT,NT=ZS(zS({range:mT,formulaBarText:iT,value:QS(ST),origin:QS(gT)}),YS((function(e){var r=e.formulaBarText,t=e.value;return"string"==typeof r&&yT(r)||lr(t)}),"range edit denoting formula or containing value")),OT=zS({range:mT,formulaBarText:YS((function(e){return"string"==typeof e&&(0===e.length||yT(e))}),"empty string or text denoting formula")}),kT=((WS={number:!0,string:!0,boolean:!0})[P.Error]=!0,WS[P.Array]=!1,WS[P.Rich]=!1,WS),LT=YS((function(e){var r="object"==typeof e?e.kind:typeof e;return("string"==typeof r||"number"==typeof r)&&!0===kT[r]}),"supported WriteOper");!function(e){e.DocumentLoc="DocumentLoc",e.SheetIndex="SheetIndex",e.SheetId="SheetId",e.GridRange="GridRange",e.CellFormula="CellFormula",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.WorksheetFuncId="WorksheetFuncId"}(AT||(AT={}));var DT=bl,_T=function(){function e(e,r,t){var n;void 0===t&&(t={}),this.refStyle=r,this.schedulerConfig=t,this.computeKind=AS.DependentCell,this.sheets=TS((function(e){return(null==e.path?"":e.path.toLocaleUpperCase())+"["+e.name.toLocaleUpperCase()+"]"})),this.queue=new OS((function(e,r){return e.kind-r.kind})),this.iformats=rg(),this.outputMessageLog=[],this.outputMessagesSent=0,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.computeId=0,this.continueId=0,this.stateEvalTime=0,this.worksheetFuncOverrides={},n=this.createObjects(e),this.parser=n[0],this.analyzer=n[1],this.compiler=n[2],this.evaluator=n[3]}return e.prototype.createObjects=function(e){var r=this,t=L,n=function(e,t){var n=r.sheets.getValue(e);return void 0===n?Kr(DT([{kind:AT.DocumentLoc,document:e}])):Hr(n.sheetIndices[t])},a=function(e,t){var n=e.tryGetValue(t);if(void 0===n){var a=e.tryGetFormula(t);if(void 0===a)return Bl(ge);var o=a[0],i=a[1];if(void 0===i.compiledFmla){var u=i.source,c=i.fmla,s=K(e.sheet,o),l=r.parseFormula(s,u,c),f=r.compileFormula(s,u,l);jr(f)?i.compiledFmla=f:(i.compiledFmla=Kr(DT([{kind:AT.CellFormula,reason:f.reason}])),r.setComputeResult({kind:_S.RangeFailure,stateId:r.stateId,range:{document:e.sheet.document,sheetId:e.sheetId,range:o},reason:f.reason}))}return i.compiledFmla.kind===wr.Success?Vl(j(e.sheet,Dr(a[0]))):void 0}return Bl(n)},o=function(e){return function(t){var n=t.sheet,a=t.range,o=r.tryGetSheetGridBySheetIndex(n);if(void 0===o)return Kr(DT([{kind:AT.SheetIndex,sheet:n}]));var i=o.checkAvailability(a);if(i===Ur.Unavailable)return Kr(DT([{kind:AT.GridRange,range:K(n,a)}]));if(i===wr.Failure)return Kr(Yl(t));var u=e(o,a);return void 0===u?Kr(Yl(t)):Hr(u)}},i=o(a),u=o((function(e,r){var t=new Array(r.rows);return Ar(r,(function(n,o,i){var u=a(e,n);return void 0!==u&&((void 0!==t[o]?t[o]:t[o]=new Array(r.cols))[i]=u,!0)}))?t:void 0})),c=kt(e);return[Qu(Dn(c)),qs(dc(c,t,n,(function(e){var t=e.sheet,n=e.range,a=r.tryGetSheetGridBySheetIndex(t);if(void 0===a)return Kr(DT([{kind:AT.SheetIndex,sheet:t}]));if(a.checkAvailability(n)===Ur.Unavailable)return Kr(DT([{kind:AT.GridRange,range:K(t,n)}]));var o=r.tryResolveIformat(a.tryGetFormat(n));return void 0===o.category||void 0===o.decimals?Kr(DT([{kind:AT.NumberFormat,iformat:o.iformat}])):Hr({iformat:o.iformat,category:o.category,decimals:o.decimals})}),(function(e){var t=r.iformats.getValue(e);return void 0===t?Kr(DT([{kind:AT.NumberFormat,iformat:e}])):Hr({iformat:e,category:t.category,decimals:t.decimals})}))),Ff(Gl(c,ol)),Ip(jl(c,ol,t,n,i,u,(function(e){if("number"==typeof e){if(0!=(ar(e).staticPrecs&(x.Time|x.Calc)))return Kr(DT([{kind:AT.WorksheetFuncId,id:e}]));if(void 0!==r.worksheetFuncOverrides[e])return Hr(r.worksheetFuncOverrides[e]);var t=Hv(e);return null!=t?Hr(t):Kr(Jr([String(e)]))}return Kr(Jr([g(e)]))}),(function(e){return Kr(DT([{kind:AT.NameLoc,name:e}]))}),(function(e){var t=e.sheet,n=e.range,a=r.tryGetSheetGridBySheetIndex(t);if(void 0===a)return Kr(DT([{kind:AT.SheetIndex,sheet:t}]));var o=a.tryGetFormula(n),i=void 0!==o?o[1].compiledFmla:void 0;return void 0===i?Hr(void 0):i}),(function(e,t){var n=r.tryGetSheetIdGridRange(e);if(void 0!==n){var a=void 0,o=r.tryGetSheetGridBySheetIndex(e.sheet);if(void 0!==o){var i=o.tryGetFormat(e.range);i!==o.tryGetServerFormat(e.range)&&(a=r.tryResolveIformat(i))}r.setComputeResult({kind:_S.CellWrite,stateId:r.stateId,cell:n,value:t,format:a,computeKind:r.computeKind})}}),(function(e,t){var n=r.tryGetSheetIdGridRange(e);void 0!==n&&r.setComputeResult({kind:_S.RangeWrite,stateId:r.stateId,range:n,values:t})}),(function(e,t){var n=r.tryGetSheetIdGridRange(e);void 0!==n&&r.setComputeResult({kind:_S.RangeFailure,stateId:r.stateId,range:n,reason:t})}),(function(){}),(function(){return!1}),this.schedulerConfig))]},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.tryGetSheetGridBySheetId=function(e,r){var t=this.sheets.getValue(e),n=void 0!==t?t.sheets[r]:void 0;if(void 0===n){var a=DT([{kind:AT.SheetId,document:e,sheetId:r}]);this.outputMessageLog.push({kind:_S.UnloggedFailure,stateId:this.stateId,reason:a})}return n},e.prototype.tryGetSheetGridBySheetIndex=function(e){var r=this.sheets.getValue(e.document);if(void 0!==r){var t=r.sheetIds[e.index];if(void 0!==t)return r.sheets[t]}},e.prototype.tryGetSheetId=function(e){var r=this.sheets.getValue(e.document);if(void 0!==r)return r.sheetIds[e.index]},e.prototype.tryGetSheetIdGridRange=function(e){var r=this.tryGetSheetId(e.sheet);if(void 0!==r)return{document:e.sheet.document,sheetId:r,range:e.range};var t=DT([{kind:AT.SheetIndex,sheet:e.sheet}]);this.outputMessageLog.push({kind:_S.UnloggedFailure,stateId:this.stateId,reason:t})},e.prototype.setComputeResult=function(e){var r=e.kind===_S.CellWrite?e.cell:e.range,t=r.document,n=r.sheetId,a=r.range,o=this.tryGetSheetGridBySheetId(t,n);if(void 0===o)throw new Error("setComputeResult: internal error: could not find grid for sheetId "+n);e.kind===_S.RangeFailure?(o.setFailure(nS(a)),o.setValues(a,ge),this.outputMessageLog.push(e)):e.kind===_S.CellWrite?(o.setValues(a,e.value),o.tryGetServerValue(e.cell.range)!==e.value||void 0!==e.format?(this.outputMessageLog.push({kind:_S.RecalcStatistics,message:kS.ChangedCell,stateId:this.stateId}),this.outputMessageLog.push(e)):this.outputMessageLog.push({kind:_S.RecalcStatistics,message:kS.UnchangedCell,stateId:this.stateId})):(o.setValues(a,e.values),this.outputMessageLog.push(e))},e.prototype.handleSetCellContents=function(e,r){var t=this,n=r.cells,a=r.fmla,o=r.value,i=r.format,u=n.document,c=n.sheetId,s=n.set,l=this.tryGetSheetGridBySheetId(u,c);void 0!==l&&(l.setCellContents(e,s,a,o,i),e||(uS(s,(function(e){if(void 0!==a&&yT(a)){var r={document:u,sheetId:c,range:e};t.inferCellFormat(r),t.computeCellValue(r,AS.EditedCell)}return!0})),l.foreachAvailableCell((function(e){var r=l.tryGetFormula(e);return void 0!==r&&void 0!==r[1].fmla&&yT(r[1].fmla)&&(t.computeCellValue({document:u,sheetId:c,range:e},AS.DependentCell),l.setValues(e,ge)),!0}))))},e.prototype.handleSetRangeFormula=function(e,r){var t=r.range,n=r.fmla,a=t.document,o=t.sheetId,i=t.range,u=this.tryGetSheetGridBySheetId(a,o);void 0!==u&&(u.setRangeFormula(e,i,n),!e&&n.length>0&&this.computeCellValue({document:a,sheetId:o,range:Dr(i)},AS.EditedCell))},e.prototype.withEvalTiming=function(e){var r=this.schedulerConfig.totalTimeMs;if(void 0===r)return e();var t=Sr();try{return e()}finally{this.stateEvalTime+=vr(1,Sr()-t),this.stateEvalTime>=r&&(this.computeId+=1,this.continueId+=1)}},e.prototype.handleComputeCellValue=function(e){var r=this,t=e.cell,n=e.computeKind;this.computeKind=n;var a=this.tryGetSheetGridBySheetId(t.document,t.sheetId);if(void 0!==a&&void 0===a.tryGetValue(t.range)&&void 0!==a.tryGetFormula(t.range)){var o=this.withEvalTiming((function(){return r.evaluator.evalCells([j(a.sheet,t.range)])}));Array.isArray(o)||this.continueComputation(o.resume,n)}},e.prototype.handleContinueComputation=function(e){var r=e.resume,t=e.computeKind;this.computeKind=t,this.outputMessageLog.push({kind:_S.RecalcStatistics,stateId:this.stateId,message:kS.ContinueComputation});var n=this.withEvalTiming(r);Array.isArray(n)||this.continueComputation(n.resume,t)},e.prototype.handlePromoteCellContents=function(e){var r=e.cells,t=e.range,n=e.fromStateId,a=this.tryGetSheetGridBySheetId(r.document,r.sheetId);void 0!==a&&(a.tryPromoteAvailability(r.set,n)||this.outputMessageLog.push({kind:_S.UpdateRequest,range:t}))},e.prototype.setCellContents=function(e,r,t,n,a,o){this.queue.enqueue({kind:e,message:{kind:DS.SetCellContents,cells:t,fmla:n,value:a,format:o},stateId:r})},e.prototype.writeCellContents=function(e,r,t,n,a){void 0===a&&(a=0);var o=bS(!0,a);this.setCellContents(LS.ServerUpdate,e,r,t,n,o)},e.prototype.editCellContents=function(e,r,t,n,a){void 0===n&&(n=ge),void 0===a&&(a=Dr(r.range));var o=it.__assign({},r,{set:nS(r.range)});this.setCellContents(LS.ClientEdit,e,o,t,n,void 0)},e.prototype.setArrayFormula=function(e,r,t,n){this.queue.enqueue({kind:e,message:{kind:DS.SetRangeFormula,range:t,fmla:n},stateId:r})},e.prototype.writeArrayFormula=function(e,r,t,n){void 0===n&&(n=!1),this.setArrayFormula(LS.ServerUpdate,e,r,t)},e.prototype.editArrayFormula=function(e,r,t){this.setArrayFormula(LS.ClientEdit,e,r,t)},e.prototype.promoteCellContents=function(e,r,t,n){this.queue.enqueue({kind:LS.ServerUpdate,message:{kind:DS.PromoteCellContents,cells:t,fromStateId:n,range:r},stateId:e})},e.prototype.computeCellValue=function(e,r){this.queue.enqueue({kind:LS.ComputeCellValue,stateId:this.stateId,computeId:this.computeId,cell:e,computeKind:r})},e.prototype.continueComputation=function(e,r){this.queue.enqueue({kind:LS.ContinueComputation,stateId:this.stateId,continueId:this.continueId,resume:e,computeKind:r})},e.prototype.inferCellFormat=function(e){var r=this.tryGetSheetGridBySheetId(e.document,e.sheetId);if(void 0!==r&&"General"===this.tryResolveIformat(r.tryGetFormat(e.range)).category){var t=r.tryGetFormula(e.range);if(void 0!==t){var n=t[1],a=n.source,o=n.fmla,i=K(r.sheet,t[0]),u=this.parseFormula(i,a,o);if(void 0===t[1].compiledFmla){var c=this.compileFormula(i,a,u);jr(c)&&(t[1].compiledFmla=c)}if(u.kind===wr.Success){var s=u.value,l=this.analyzer.findBestFormat(j(r.sheet,e.range),s);if(jr(l)){var f=l.value,d=f.category,h=f.iformat,p=f.decimals,v=this.iformats.getValue(h),g=void 0!==v&&d===v.category&&p===v.decimals;r.setEditFormat(e.range,{isExact:g,iformat:h,category:d,decimals:p})}}}}},e.prototype.tryResolveIformat=function(e){var r=void 0!==e?e:bS(!0,oc.General);if(r.isExact&&(void 0===r.category||void 0===r.decimals)){var t=this.iformats.getValue(r.iformat);void 0!==t&&(r.category=t.category,r.decimals=t.decimals)}return r},e.prototype.parseFormula=function(e,r,t){var n=this.parser.parseFormula(this.refStyle,e,r,t);if(!jr(n))return n;var a=this.analyzer.checkFormula(e,r,n.value);return Cr(a)?Hr(a):Kr(xl("calc.PartialWorkbook.parseFormula: expected well-formed formula; given "+g(t)))},e.prototype.compileFormula=function(e,r,t){if(t.kind!==wr.Success)return t;var n=this.compiler.compileFormula(e,r,t.value);return n.kind!==wr.Success?n:Hr(Wl(e,r,n.value))},e.prototype.step=function(){var e=this.queue.pop();if(void 0===e)return{queueEmpty:!0,messages:[]};this.trySetStateId(e)&&this.handleMessage(e);var r=this.queue.peek();e.kind===LS.ServerUpdate||e.kind===LS.MaybeCollectGarbage||void 0!==r&&r.kind!==LS.MaybeCollectGarbage||this.outputMessageLog.push({kind:_S.RecalcStatistics,message:kS.RecalcFinished,stateId:this.stateId});var t=this.outputMessageLog.slice(this.outputMessagesSent);return this.outputMessagesSent=this.outputMessageLog.length,{queueEmpty:0===this.queue.getCount(),messages:t}},e.prototype.trySetStateId=function(e){var r=this;return e.kind===LS.MaybeCollectGarbage||!(e.stateId<this.stateId||e.kind===LS.ComputeCellValue&&e.computeId<this.computeId||e.kind===LS.ContinueComputation&&e.continueId<this.continueId)&&(e.stateId>this.stateId&&(this.stateId=e.stateId,this.sheets.forEach((function(e,t){for(var n in t.sheets){if(t.sheets.hasOwnProperty(n))t.sheets[n].advanceState(r.stateId)}return!0})),e.kind===LS.ServerUpdate?(this.computeId+=1,this.continueId+=1):e.kind===LS.ClientEdit&&(this.continueId+=1),this.stateEvalTime=0,this.outputMessageLog=[],this.stateChangesSinceLastGC+=1,this.queue.enqueue({kind:LS.MaybeCollectGarbage})),!0)},e.prototype.handleMessage=function(e){switch(e.kind){case LS.ServerUpdate:case LS.ClientEdit:switch(e.message.kind){case DS.SetCellContents:return this.handleSetCellContents(e.kind===LS.ServerUpdate,e.message);case DS.SetRangeFormula:return this.handleSetRangeFormula(e.kind===LS.ServerUpdate,e.message);case DS.PromoteCellContents:return this.handlePromoteCellContents(e.message);case DS.SetRefStyle:return this.handleSetRefStyle(e.message.refStyle);case DS.SetSheetNames:return this.handleSetSheetNames(e.message.document,e.message.sheetNames);case DS.SetLocaleInfo:return this.handleSetLocaleInfo(e.message.localeInfo);case DS.ExtendAvailableRange:return this.handleExtendAvailableRange(e.message.range);default:return I("calc.calc.partialWorkbook.handleMessage",e.message)}case LS.ComputeCellValue:return this.handleComputeCellValue(e);case LS.ContinueComputation:return this.handleContinueComputation(e);case LS.MaybeCollectGarbage:return this.maybeCollectGarbage();default:return I("calc.calc.partialWorkbook.handleMessage",e)}},e.prototype.setSheetNames=function(e,r,t){this.queue.enqueue({kind:LS.ServerUpdate,stateId:t,message:{kind:DS.SetSheetNames,document:e,sheetNames:r}})},e.prototype.handleSetSheetNames=function(e,r){for(var t={},n={},a={},o=this.sheets.getValue(e),i=0;i<r.length;i+=1){var u=r[i];t[i]=u.sheetId,n[u.sheetName]=i;var c=void 0===o?void 0:o.sheets[u.sheetId];void 0===c?a[u.sheetId]=new HS(F(e,i),u.sheetId,this.stateId):(c.sheet=F(e,i),a[u.sheetId]=c)}this.sheets.setValue(e,{sheetIds:t,sheetIndices:n,sheets:a}),this.computeId+=1,this.continueId+=1},e.prototype.clearCompiledFormulas=function(){this.sheets.forEach((function(e,r){for(var t in r.sheets){if(r.sheets.hasOwnProperty(t))r.sheets[t].clearCompiledFormulas()}return!0})),this.computeId+=1,this.continueId+=1},e.prototype.setRefStyle=function(e,r){this.queue.enqueue({kind:LS.ServerUpdate,stateId:r,message:{kind:DS.SetRefStyle,refStyle:e}})},e.prototype.handleSetRefStyle=function(e){this.refStyle!==e&&(this.refStyle=e,this.clearCompiledFormulas())},e.prototype.setLocaleInfo=function(e,r){this.queue.enqueue({kind:LS.ServerUpdate,stateId:r,message:{kind:DS.SetLocaleInfo,localeInfo:e}})},e.prototype.handleSetLocaleInfo=function(e){var r;r=this.createObjects(e),this.parser=r[0],this.analyzer=r[1],this.compiler=r[2],this.evaluator=r[3],this.clearCompiledFormulas()},e.prototype.setNumberFormats=function(e,r){var t=this;r||(this.iformats=rg()),e.forEach((function(e){t.iformats.setValue(e.iformat,e)}))},e.prototype.setUsedRanges=function(e,r){},e.prototype.extendAvailableRange=function(e,r){this.queue.enqueue({kind:LS.ServerUpdate,stateId:r,message:{kind:DS.ExtendAvailableRange,range:e}})},e.prototype.handleExtendAvailableRange=function(e){var r=this.tryGetSheetGridBySheetId(e.document,e.sheetId);void 0!==r&&r.extendAvailability(nS(e.range))},e.prototype.getStatistics=function(){var e=[];return this.sheets.forEach((function(r,t){for(var n in t.sheets)if(t.sheets.hasOwnProperty(n)){var a=t.sheets[n];void 0!==a&&e.push(a.getStatistics())}return!0})),{queueSize:this.queue.getCount(),totalGridStatistics:e.reduce(VS,BS)}},e.prototype.maybeCollectGarbage=function(){if(!(this.stateChangesSinceLastGC<17)){var e=this.stateId-17;this.sheets.forEach((function(r,t){for(var n in t.sheets)if(t.sheets.hasOwnProperty(n)){var a=t.sheets[n];void 0!==a&&a.collectGarbage(e)}return!0})),this.outputMessageLog.push({kind:_S.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}},e}();function FT(e){return new Promise((function(r){return setTimeout(r,e)}))}function MT(e,r){var t=r&&r.timeThreshold||10,n=r&&r.costThreshold||1,a=r&&r.macrotaskDelay||0,o={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},i=vm(),u=i[0],c=i[1],s=c[0],l=c[1];var f=!0;var d=FT(a),h=Sr();return function r(){if(!f||!function(){try{for(var r=0;r<n;){o.iterations+=1;var t=e();if(void 0===t)return!1;r+=t}return!0}catch(e){return l(e),!1}}())return s();var i=Sr();i-h<t?(Promise.resolve().then(r),o.microtaskContinues+=1):(d.then((function(){d=FT(a),h=Sr(),o.macrotaskTotalDelay+=h-i,r()})),o.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:o}}function bT(e,r){var t=function(e,r){var t=Kt().slice();return e.filter((function(e){return XS(e,sT,r,"localeData.worksheetFunctionNames.<index>")})).forEach((function(e){return t[e.functionId]=e.functionName})),jt(t)}(e.worksheetFunctionNames,r),n=t.getWorksheetFuncId,a=t.getWorksheetFuncName,o=function(e,r){var t=Vt.slice();return e.filter((function(e){return XS(e,lT,r,"localeData.errorTypeNames.<index>")})).forEach((function(e){return t[e.errorType]=e.errorName})),t}(e.errorTypeNames,r);return it.__assign({},e,{parseNumber:wt,formatNumber:Ut,getWorksheetFuncId:n,getWorksheetFuncName:a,isNumeral:Pt,getOrdinal:Gt,getNumeral:xt,isLetter:Bt,stringCompareCI:mr,errorNames:o})}function wT(e,r){return fr(r)?{index:e,length:1}:{index:e,length:gr(r-e)+1}}function UT(e,r){var t=wT(r.row,r.lastRow),n=t.index,a=t.length,o=wT(r.column,r.lastColumn),i=b(n,o.index,a,o.length);return{document:e,sheetId:r.sheetId,range:i}}function PT(e,r,t){return{document:e.document,sheetId:e.sheetId,set:function(e,r,t){var n=WT(e.row,e.rows,BT,r),a=WT(e.col,e.cols,VT,t),o=wE(n,a);return UE(nS(e),(i=o,PE(dE,i)));var i}(e.range,r,t)}}function GT(e){return xT(e)?jg(e.sheetId,e.range.row,e.range.col):jg(e.sheetId,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function xT(e){return Rr(e.range)}function BT(e,r){return void 0===r&&(r=1),b(e,0,r,jS)}function VT(e,r){return void 0===r&&(r=1),b(0,e,KS,r)}function WT(e,r,t,n){var a=hE;if(fr(n))return a;for(var o=0,i=n;o<i.length;o++){var u=i[o];e<=u&&u<e+r&&(a=wE(a,nS(t(u))))}return a}function HT(e){if("object"!=typeof e)return e;switch(e.kind){case"Blank":return ge;case"Error":return Q(e.type);default:return}}var KT,jT=function(){function e(e,r,t,n,a){void 0===n&&(n=10),void 0===a&&(a=1e4),this.onRecalcResults=e,this.onUpdateRequest=r,this.onGC=t,this.timeslice=n,this.stateEvalTimeout=a,this.document=L(void 0,"RecalcServiceBook"),this.localeInfo=Jt(),this.refStyle=se.A1,this.currentStateId=-1,this.recalcStatistics=FS,this.failures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.dataModel=new _T(this.localeInfo,this.refStyle,{yieldIntervalMs:this.timeslice,totalTimeMs:this.stateEvalTimeout})}return e.prototype.setStateId=function(e){var r=e-this.currentStateId;return r<0?r:(r>0&&(this.logFailureStats(),this.logIgnoredInputStats(),this.logIgnoredOutputStats(),this.logRecalcStats()),this.currentStateId=e,r)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;this.clearAsyncResumeRecalc();var r=ct("calc.calc.RecalcService");return this.recalcLoop=MT((function(){var r=e.dataModel.step(),t=r.messages,n=r.queueEmpty;return t.length>0&&e.processRecalcResults(t),n?void 0:1}),{costThreshold:1,timeThreshold:this.timeslice}),this.recalcLoop.promise.then((function(){e.recalcLoop=void 0,r.stop()}))},e.prototype.processRecalcResults=function(e){for(var r=[],t=[],n=[],a=[],o=!1,i=0,u=e;i<u.length;i++){var c=u[i];switch(c.kind){case _S.CellWrite:var s=c.cell,l=c.value,f=c.format,d=c.computeKind,h=s.sheetId,p=s.range,v=this.cellWriteToRangeDelta(h,p.row,p.col,l,f,"messages.<index>.value");lr(v)&&(d===AS.EditedCell?r:t).push(v);break;case _S.RangeWrite:var g=c.range,m=c.values;h=g.sheetId,p=g.range;t.push.apply(t,this.rangeWriteToRangeDeltas(h,p,m,"messages.<index>.values"));break;case _S.RangeFailure:case _S.UnloggedFailure:this.failures.push(c);break;case _S.UpdateRequest:a.push(GT(c.range));break;case _S.GarbageCollected:this.onGC(c.minStateIdKept);break;case _S.RecalcStatistics:o=o||c.message===kS.RecalcFinished,this.recalcStatistics=MS(this.recalcStatistics,c.message);break;default:return I("calc.calc.RecalcServiceImpl.processRecalcResults",c)}}a.length>0&&this.onUpdateRequest(dm(a,[])),(r.length>0||n.length>0)&&this.sendRecalcResults("Edited",r,n),t.length>0&&this.sendRecalcResults("Dependents",t,[]),o&&this.onRecalcResults(fm(this.currentStateId,"Dependents",!0,[],[]))},e.prototype.sendRecalcResults=function(e,r,t){for(var n=0;n<Math.max(r.length,t.length);n+=10)this.onRecalcResults(fm(this.currentStateId,e,!1,r.slice(n,n+10),t.slice(n,n+10)))},e.prototype.logFailureStats=function(){if(0!==this.failures.length)try{for(var e={},r=0,t=this.failures;r<t.length;r++){var n=t[r],a=n.stateId,o=n.reason,i=e[a]=e[a]||{};if(o.kind===Pl.NotImplemented)for(var u=0,c=o.features;u<c.length;u++){var s=c[u];JS(i,Pl.NotImplemented+" "+s)}else if(o.kind===Pl.Unavailable)for(var f=0,d=o.objects;f<d.length;f++){var h=d[f],p=[Pl.Unavailable];if("string"==typeof h.kind&&h.kind in AT){var v=h;switch(p.push(v.kind),v.kind){case AT.SheetIndex:p.push(v.sheet.index);break;case AT.SheetId:p.push(v.sheetId);break;case AT.WorksheetFuncId:p.push(v.id)}}else p.push(JSON.stringify(h));JS(i,p.join(" "))}else JS(i,o.kind);if(o.kind!==Pl.JavaScriptError);else{var g="calc.calc.RecalcService: recalc JavaScript error: "+(null!=o.error.stack?o.error.stack:o.error.message);C.ULS.traceTag(595658721,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,g)}}Object.getOwnPropertyNames(e).map(Number).sort((function(e,r){return e-r})).forEach((function(r){var t="calc.calc.RecalcService: recalc failures; "+("stateId = "+r+", stats = "+JSON.stringify(e[r]));C.ULS.traceTag(595658722,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t)}))}finally{this.failures=[]}},e.prototype.logIgnoredStats=function(e,r,t){if(0!==Object.getOwnPropertyNames(t).length){var n="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+this.currentStateId+", stats = "+JSON.stringify(t));C.ULS.traceTag(e,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,n)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){var e="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentStateId+", stats = "+JSON.stringify(this.recalcStatistics));C.ULS.traceTag(595654593,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,e),this.recalcStatistics=FS},e.prototype.cellWriteToRangeDelta=function(e,r,t,n,a,o){if(XS(n,LT,this.ignoredOutputStats,o)){var i=function(e){if("object"!=typeof e)return e;switch(e.kind){case P.Error:return Vg(e.type);default:return}}(n),u=function(e){if(void 0!==e)return im(e.isExact,e.iformat,!1,e.category,e.decimals)}(a);return lr(void 0)||lr(i)||lr(u)?cm(jg(e,r,t),um(void 0,i,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,r,t,n){for(var a=n+".<index>.<index>",o=r.row,i=r.col,u=r.rows,c=r.cols,s=[],l=0;l<u;l+=1)for(var f=0;f<c;f+=1){var d=this.cellWriteToRangeDelta(e,o+l,i+l,t[l][f],void 0,a);lr(d)&&s.push(d)}return s},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?se.A1:se.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=bT(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentStateId)},e.prototype.setNumberFormats=function(e,r){var t=this;this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(e.filter((function(e){return XS(e,dT,t.ignoredInputStats,"numberFormats.<index>")})),r)},e.prototype.setSheetNames=function(e){var r=this;this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,e.filter((function(e){return XS(e,hT,r.ignoredInputStats,"sheetNames.<index>")})),this.currentStateId)},e.prototype.setUsedRanges=function(e,r){var t=this;this.clearAsyncResumeRecalc(),this.dataModel.setUsedRanges(e.filter((function(e){return XS(e,mT,t.ignoredInputStats,"usedRanges.<index>")})).map((function(e){return UT(t.document,e)})),r)},e.prototype.updateRanges=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,a=r.filter((function(e){return XS(e,CT,t.ignoredInputStats,"rangeUpdates.<index>")}));n<a.length;n++){var o=a[n],i=o.range,u=o.excludeRows,c=o.excludeColumns,s=o.data,l=o.fromStateId,f=UT(this.document,i),d=PT(f,u,c),h=lr(s)?HT(s.value):ge;if(void 0!==h){var p=lr(s)?s.iformat:0;if(lr(s)||fr(l)){var v=fr(s)?"":lr(s.formulaBarText)?s.formulaBarText:void 0;this.dataModel.writeCellContents(e,d,v,h,p)}else this.dataModel.promoteCellContents(e,f,d,l)}}}},e.prototype.updateArrays=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,a=r.filter((function(e){return XS(e,IT,t.ignoredInputStats,"arrayUpdates.<index>")}));n<a.length;n++){var o=a[n],i=o.range,u=o.data,c=o.fromStateId,s=UT(this.document,i);if(lr(u)){var l=u.formulaBarText,f=u.isSpilled;this.dataModel.writeArrayFormula(e,s,l,f)}else lr(c)}}},e.prototype.editRangeFormulas=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,a=r.filter((function(e){return XS(e,NT,t.ignoredInputStats,"rangeFormulaEdits.<index>")}));n<a.length;n++){var o=a[n],i=o.range,u=o.formulaBarText,c=o.value,s=o.origin,l=UT(this.document,i);if(xT(l)){var f=lr(s)?w(s.row,s.column):void 0,d=void 0;if(lr(c)){if(void 0===(d=HT(c)))continue}else d=void 0;this.dataModel.editCellContents(e,l,u,d,f)}else JS(this.ignoredInputStats,"rangeFormulaEdits.<index>.range: expected single cell")}}},e.prototype.editArrayFormulas=function(e,r){var t=this;if(!(this.setStateId(e)<0)){this.clearAsyncResumeRecalc();for(var n=0,a=r.filter((function(e){return XS(e,OT,t.ignoredInputStats,"arrayFormulaEdits.<index>")}));n<a.length;n++){var o=a[n],i=o.range,u=o.formulaBarText,c=UT(this.document,i);this.dataModel.editArrayFormula(e,c,u)}}},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new _T(this.localeInfo,this.refStyle,{yieldIntervalMs:this.timeslice,totalTimeMs:this.stateEvalTimeout}),this.currentStateId=-1},e.prototype.testAdvanceState=function(e){this.setStateId(e)<0||this.clearAsyncResumeRecalc()},e.prototype.testDelay=function(e){return it.__awaiter(this,void 0,void 0,(function(){return it.__generator(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){return setTimeout(r,e)}))];case 1:return r.sent(),[2]}}))}))},e}();function JT(){return{onError:function(e,r){var t=null!=r.error.stack?r.error.stack:r.error.message,n="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:t});C.ULS.traceTag(595658753,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,n)},onInit:function(e){var r=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),t=r.onRecalcResults,n=r.onUpdateRequest,a=r.onGC;e.setExports("service",new jT(t.notify,n.notify,a.notify))},scriptName:"excelOnlineRecalcService.worker"}}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(KT||(KT={}));var qT=function(e){return void 0===e&&(e=KT.Thread),it.__awaiter(this,void 0,void 0,(function(){var r,t,n,a,o,i,u;return it.__generator(this,(function(c){switch(c.label){case 0:return r=!1,t={outside:{onError:function(e,t){var n=null!=t.error.stack?t.error.stack:t.error.message,a="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:n});C.ULS.traceTag(595658719,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,a),t.closing&&(r=!0)},onClosed:function(e){var t="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(r?"because of an error":"normally");C.ULS.traceTag(595658720,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Warning,t)}},inside:JT()},[4,Km(e===KT.Thread?[em.Dedicated]:e===KT.Local?[em.FunctionCall]:[em.Dedicated,em.FunctionCall],t)];case 1:if(null==(n=c.sent()))throw new Error("could not create recalc service worker");return a="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,C.ULS.traceTag(595731987,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,a),o=-1/0,i={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){o=e}},n.setExports("client",i),u=n.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","setUsedRanges","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","clearCache","testAdvanceState","testDelay"]),[2,{setOnRecalcResults:function(e){i.onRecalcResults=e},setOnUpdateRequest:function(e){i.onUpdateRequest=e},setA1ReferenceStyle:function(e){r||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){r||u.setLocale.notify(e)},setNumberFormats:function(e,t){r||u.setNumberFormats.notify(e,t)},setSheetNames:function(e){r||u.setSheetNames.notify(e)},setUsedRanges:function(e,t){r||u.setUsedRanges.notify(e,t)},updateRanges:function(e,t){r||u.updateRanges.notify(e,t)},updateArrays:function(e,t){r||u.updateArrays.notify(e,t)},editRangeFormulas:function(e,t){r||u.editRangeFormulas.notify(e,t)},editArrayFormulas:function(e,t){r||u.editArrayFormulas.notify(e,t)},resumeRecalc:function(){r||u.resumeRecalc.notify()},clearCache:function(){r||u.clearCache.notify()},testAdvanceState:function(e){r||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return r?Promise.resolve():u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=o}}]}}))}))},YT=function(){function e(e){this.kind=0,this.result=e}return e.prototype.failed=function(e){throw C.ULS.traceTag(595910681,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"DataCell.failed: Calc.ts cannot fail at handling just data."),"DataCell.failed: Calc.ts cannot fail at handling just data."},e}(),XT=new YT(ge),QT=function(){function e(e){this.kind=1,this.raw=e,this.ir=void 0}return e.prototype.parsed=function(e){this.ir=e},e.prototype.analysed=function(e){this.ir=e},e.prototype.compiled=function(e){this.ir=e},e.prototype.failed=function(e,r,t){return new zT(this.raw,e,r,t)},e}(),zT=function(){function e(e,r,t,n){this.kind=2,this.phase=r,this.formulaText=e,this.reason=t,this.details=n}return e.prototype.failed=function(e){return C.ULS.traceTag(595910682,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Failed.failed: Calc.ts will not attempt at working with a FailedFormula"),this},e}(),ZT=function(){function e(){this.table=Xv(Zv,$v),this.usedRange=void 0}return e.prototype.getCellContents=function(e){var r=this.table.getValue(e);return void 0===r?XT:r},e.prototype.setCellContents=function(e,r){if(this.table.setValue(e,r),void 0===this.usedRange)this.usedRange={row:e.range.row,column:e.range.col};else{var t=this.usedRange,n=t.row,a=t.column;this.usedRange={row:Math.max(e.range.row,n),column:Math.max(e.range.col,a)}}},e.prototype.forEach=function(e){this.table.forEach(e)},e.prototype.getUsedRange=function(){return this.usedRange},e}(),$T=function(){function e(e,r){this.workbook=e,this.grid=new ZT,this.name=r}return e.prototype.updateGrid=function(e,r){this.grid.setCellContents(e,new QT(r))},e.prototype.upgradeGridWithValue=function(e,r){this.grid.setCellContents(e,new YT(r))},e.prototype.parse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.parse: didn't find a formula to parse.");var t=r;if(void 0!==t.ir)return Kr("Sheet.parse: formula has been parsed already.");var n=this.workbook.parser.parseFormula(this.workbook.isA1RefStyle?se.A1:se.R1C1,e,m.Cell,t.raw);return n.kind===wr.Failure?(this.grid.setCellContents(e,t.failed(0)),Kr("Sheet.parse: parsing of failed.")):n.value.node.kind===he.Bad?(this.grid.setCellContents(e,r.failed(0)),Kr("Sheet.parse: parsing of formula failed (bad formula).")):(t.parsed(n.value),Hr(n.value))},e.prototype.analyse=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.analyse: didn't find a formula to analyse.");var t=r,n=t.ir;if(void 0===n||void 0===n.node)return Kr("Sheet.analyse: didn't find AST in this cell.");var a=this.workbook.analyzer.checkFormula(e,m.Cell,n);return Cr(a)?(t.analysed(a),Hr(a)):(this.grid.setCellContents(e,r.failed(1)),Kr("Sheet.analyse: formula is not well-formed."))},e.prototype.compile=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.compile: didn't find a formula to compile.");var t=r,n=t.ir;if(void 0===n||!0!==n.isWellFormed)return Kr("Sheet.compile: didn't find a well-formed formula in this cell.");var a=this.workbook.compiler.compileFormula(e,m.Cell,n);return a.kind!==wr.Success?(this.grid.setCellContents(e,r.failed(3)),Kr("Sheet.compile: formula can't be compiled.")):(t.compiled(a.value),Hr(a.value))},e.prototype.evaluate=function(e){var r=this.grid.getCellContents(e);if(1!==r.kind)return Kr("Sheet.evaluate: didn't find a formula to evaluate.");if(void 0===r.ir)return Kr("Sheet.evaluate: didn't find a compiled term in this cell.");var t=this.workbook.evaluator.evalCells([e]);if(!(t instanceof Array)){if(t.kind===wr.Paused)return Kr("Sheet.evaluate: evaluator didn't meet deadline");throw Kr("Sheet.evaluate: something went wrong in the data model.")}var n=t[0];if(n.kind!==wr.Success)switch(this.grid.setCellContents(e,r.failed(3,n.reason.kind,n.reason)),n.reason.kind){case"NotImplemented":return Kr("Sheet.evaluate: unimplemented functions :: "+n.reason.features);case"JavaScriptError":return Kr("Sheet.evaluate: javascript error :: "+n.reason.error);case"NameCycle":return Kr("Sheet.evaluate: name cycle :: "+n.reason.names);case"CellCycle":return Kr("Sheet.evaluate: cell cycle :: "+n.reason.cells);default:return Kr("Sheet.evaluate: failed :: "+n.reason)}return cf(n.value)?Hr(0):Hr(n.value)},e}();function eC(e){return function(r,t){return e.documentLocation}}function rC(e){return function(r,t){return Hr(e.getSheetId(t))}}function tC(e,r){var t=e.worksheets.getValue(r.sheet.index);if(void 0!==t){var n=t.grid.getCellContents(r);if(2===n.kind){var a=e.expectedValue(r);return void 0!==a?Bl(a):void 0}return 0===n.kind?Bl(n.result):Vl(r)}}function nC(e){return function(r){var t=tC(e,r);return void 0===t?Kr(Yl(r)):Hr(t)}}function aC(e,r,t){return function(n){var a=n.sheet,o=n.range,i=o.row,u=o.col,c=o.rows,s=o.cols;if(c*s>r*t)return Hr([]);if(void 0!==e.worksheets.getValue(a.index)){for(var l=[],f=i;f<i+c;f+=1){for(var d=[],h=u;h<u+s;h+=1){var p=j(a,w(f,h)),v=tC(e,p);if(void 0===v)return Kr(Yl(n));d.push(v)}l.push(d)}return Hr(l)}return Kr(Yl(n))}}function oC(e){return function(r){if("number"==typeof r){var t=Hv(r);return null!=t?Hr(t):Kr(Jr([e.config.localeInfo.getWorksheetFuncName(r)]))}return Hr(void 0)}}function iC(e){return function(r){var t=r.name.toUpperCase(),n=r.scope;if(void 0===n.index)return Hr(e.globalNames.getValue(t));var a=e.scopedNames.getValue(n.index);return Hr(void 0===a?void 0:a.getValue(t))}}function uC(e){return function(r){var t=e.worksheets.getValue(r.sheet.index);if(void 0===t)return Hr(void 0);var n=t.grid.getCellContents(r);if(0===n.kind||2===n.kind)return Hr(void 0);var a=n.ir;return Hr(Wl(r,m.Cell,a))}}function cC(e){return function(r,t){var n=e.worksheets.getValue(r.sheet.index);void 0!==n&&n.grid.setCellContents(r,new YT(t))}}function sC(e){return function(r,t){for(var n=r.sheet,a=r.range,o=a.row,i=a.col,u=a.rows,c=a.cols,s=0;s<u;s+=1)for(var l=0;l<c;l+=1){var f=j(n,w(s+o,l+i)),d=e.worksheets.getValue(f.sheet.index);void 0!==d&&d.grid.setCellContents(f,new YT(t[s][l]))}}}function lC(e){return function(r,t){for(var n=r.sheet,a=r.range,o=a.row,i=a.col,u=a.rows,c=a.cols,s=0;s<u;s+=1)for(var l=0;l<c;l+=1){var f=j(n,w(s+o,l+i)),d=e.worksheets.getValue(f.sheet.index);if(void 0!==d){var h=d.grid.getCellContents(f);void 0!==h&&d.grid.setCellContents(f,h.failed(3,t.kind,t))}}}}function fC(e){return function(r){var t=e.worksheets.getValue(r.index);if(void 0===t)return Kr(qr([r]));var n=t.grid.getUsedRange();if(void 0===n)return Hr(n);var a=b(0,0,n.row+1,n.column+1);return Hr(K(r,a))}}function dC(e,r,t){var n=e.parser.parseFormula(e.isA1RefStyle?se.A1:se.R1C1,t,m.NameManager,r);if(n.kind===wr.Success){var a=e.analyzer.checkFormula(t,m.NameManager,n.value);return Cr(a)?e.compiler.compileFormula(t,m.NameManager,a):Kr(xl("compileNamedFormula: formula is not well formed"))}return n}var hC=j(F(L(void 0,""),0),w(0,0)),pC=function(){function e(e,r,t,n,a,o,i,u,c,s){var l=this;void 0===u&&(u=!0),this.documentLocation=L(void 0,e),this.isA1RefStyle=r,this.locale=n,this.config=nn.calcConfig(n),nn.initCalc(s,(function(e){return-1!==c.indexOf(e)}));var f=nn.calcConfig(n);this.config=f;var d={config:f},h={config:f},p={config:f,mathpack:o};this.parser=Qu(d),this.analyzer=qs(h),this.compiler=Ff(p);var v,m,E,S=a?(m=1024,E=1024,{config:(v=this).config,mathpack:ol,getDocumentLoc:eC(v),getSheetIndex:rC(v),getCellValue:nC(v),getCellValues:aC(v,m,E),getFirstOrderFunc:oC(v),getNameFormula:iC(v),getCellFormula:uC(v),interruptToken:[Ul.Continue],schedulerInfo:{},setCellValue:cC(v),setCellValues:sC(v),setCellFailure:lC(v),getUsedRange:fC(v),setDynamicPrecs:function(e,r){},loadObjects:function(e){return!1}}):function(e){throw"Not being invoked yet."}();this.evaluator=Ip(S),this.globalNames=TS(ur),this.scopedNames=TS(String),this.worksheets=TS(String),this.sheetId=0,t.forEach((function(e){l.addWorksheet(e)})),this.expectedValue=i,this.preprocess=function(e){return function(r){return e?g(r):"string"==typeof r?r:JSON.stringify(r)}}(u)}return e.prototype.addWorksheet=function(e){this.worksheets.setValue(this.sheetId,new $T(this,e)),this.sheetId+=1},e.prototype.makeHomeCell=function(e){var r=this.parser.parseFormula(this.isA1RefStyle?se.A1:se.R1C1,hC,m.Cell,e);if(r.kind===wr.Failure)return"Workbook can't create home cell "+this.preprocess(e)+". Reason: "+this.preprocess(r.reason)+".";if(r.value.node.kind===he.Bad)return"Workbook can't create home cell "+this.preprocess(e)+". (Bad Node).";var t=r.value.node.ref,n=r.value.node.qualifier,a=this.getSheetId(n.sheet);return-1===a?"Workbook can't find index of sheet "+this.preprocess(n.sheet)+".":j(F(this.documentLocation,a),w(t.row.index,t.col.index))},e.prototype.getSheetId=function(e){var r=-1;return this.worksheets.forEach((function(t,n){return n.name!==e||(r=t,!1)})),r},e.prototype.failedToAddName=function(e,r,t){var n=e?"addGlobalName":"addScopedName";C.ULS.traceTag(595891858,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook."+n+": "+r+" >> "+this.preprocess(t)+".")},e.prototype.addGlobalName=function(e,r,t){var n=this.makeHomeCell(t);if("string"==typeof n)return this.failedToAddName(!0,"failed to parse home cell",t);var a=dC(this,r,n);a.kind===wr.Success?this.globalNames.setValue(e,a.value):this.failedToAddName(!0,"failed to compile named formula",r)},e.prototype.addScopedName=function(e,r,t,n){var a=this.makeHomeCell(n);if("string"==typeof a)return this.failedToAddName(!1,"failed to parse home cell",n);var o=dC(this,t,a);o.kind===wr.Success?this.scopedNames.getOrSetValue(e,(function(){return TS(ur)})).getOrSetValue(r,(function(){return o.value})):this.failedToAddName(!1,"failed to compile named formula",t)},e.prototype.getSheetAndCell=function(e){var r=this.makeHomeCell(e);if("string"==typeof r)return r;var t=r.sheet.document;if(!Nr(this.documentLocation,t))return"Workbook: invalid workbook location";var n=r.sheet.index,a=this.worksheets.getValue(n);return void 0===a?"Workbook: invalid workbook location":{sheet:a,cell:r}},e.prototype.cellUpdateFailed=function(e,r,t){var n={cell:e,formula:r};C.ULS.traceTag(595891859,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook.cellUpdate: "+t+" >> "+this.preprocess(n)+".")},e.prototype.cellUpdate=function(e,r){try{var t=this.getSheetAndCell(e);if("string"==typeof t)return this.cellUpdateFailed(e,r,"could not find cell and sheet");var n=t.sheet,a=t.cell;n.updateGrid(a,r);var o=n.parse(a);if(!jr(o))return this.cellUpdateFailed(e,r,"failed at parsing. "+o.reason);if(!jr(o=n.analyse(a)))return this.cellUpdateFailed(e,r,"failed at analysing. "+o.reason);if(!jr(o=n.compile(a)))return this.cellUpdateFailed(e,r,"failed at compiling. "+o.reason)}catch(e){C.ULS.traceTag(595891860,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Exception in Workbook.cellUpdate: "+e)}},e.prototype.cellEvaluate=function(e){var r=this.worksheets.getValue(e.sheet.index);if(void 0!==r){var t=r.evaluate(e);jr(t)||C.ULS.traceTag(595886097,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook.cellEvaluate: failed at evaluating "+this.preprocess(e)+". "+t.reason)}else C.ULS.traceTag(595886096,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,"Workbook.cellEvaluate: couldn't find worksheet "+this.preprocess(r))},e.prototype.cellUpdateWithValue=function(e,r){var t=this.getSheetAndCell(e);if("string"!=typeof t){var n=t.sheet,a=t.cell;n.upgradeGridWithValue(a,r)}else{var o="Workbook.cellUpdateWithValue: "+t+".";C.ULS.traceTag(595891861,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,o)}},e.prototype.cellRead=function(e){var r=this.getSheetAndCell(e);if("string"==typeof r){var t="Workbook.cellRead: "+r+".";return C.ULS.traceTag(595891862,l.LogCategory.msoulscat_ES_EWAJS,l.TraceLevel.Info,t),t}var n=r.sheet,a=r.cell;return n.grid.getCellContents(a)},e.prototype.forEachCell=function(e){var r=!0;this.worksheets.forEach((function(t,n){return r&&n.grid.forEach((function(t,a){return r=e(n,t,a)})),r}))},e}();t.d(r,"location",(function(){return qt})),t.d(r,"formula",(function(){return zt})),t.d(r,"value",(function(){return Xt})),t.d(r,"signature",(function(){return $t})),t.d(r,"util",(function(){return rn})),t.d(r,"config",(function(){return nn})),t.d(r,"parse",(function(){return n})),t.d(r,"analyze",(function(){return a})),t.d(r,"runtime",(function(){return o})),t.d(r,"calc",(function(){return c})),t.d(r,"funcs",(function(){return u})),t.d(r,"worker",(function(){return i})),t.d(r,"datamodel",(function(){return s}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map